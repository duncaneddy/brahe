<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Brahe - Practical Astrodynamics"><meta name=author content="Duncan Eddy"><link rel=canonical href=https://duncaneddy.github.io/brahe/latest/learn/frames/eme2000_gcrf.html><link rel=prev href=gcrf_itrf.html><link rel=next href=../orbits/index.html><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.20"><title>EME2000 ↔ GCRF Transformations - Brahe</title><link rel=stylesheet href=../../assets/stylesheets/main.e53b48f4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.5dba32.min.css><link rel=stylesheet href=https://unpkg.com/katex@0/dist/katex.min.css><link rel=stylesheet href=../../stylesheets/neoteroi-mkdocs.249355.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-H1DDT6G6K6"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-H1DDT6G6K6",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-H1DDT6G6K6",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=black> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#eme2000-gcrf-transformations class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Brahe class="md-header__button md-logo" aria-label=Brahe data-md-component=logo> <img src=../../assets/icon.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Brahe </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> EME2000 ↔ GCRF Transformations </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=black aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=black aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/duncaneddy/brahe title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../index.html class=md-tabs__link> Brahe </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../index.html class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../examples/index.html class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../library_api/index.html class=md-tabs__link> Python API Reference </a> </li> <li class=md-tabs__item> <a href=https://docs.rs/brahe class=md-tabs__link> Rust API Reference </a> </li> <li class=md-tabs__item> <a href=https://duncaneddy.com class=md-tabs__link> About Me </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Brahe class="md-nav__button md-logo" aria-label=Brahe data-md-component=logo> <img src=../../assets/icon.png alt=logo> </a> Brahe </label> <div class=md-nav__source> <a href=https://github.com/duncaneddy/brahe title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../../index.html class="md-nav__link "> <span class=md-ellipsis> Brahe </span> </a> <label class="md-nav__link " for=__nav_1 id=__nav_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Brahe </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../installation.html class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../development_guidelines.html class=md-nav__link> <span class=md-ellipsis> Development Guidelines </span> </a> </li> <li class=md-nav__item> <a href=../../design.html class=md-nav__link> <span class=md-ellipsis> Design Philosophy &amp; Decisions </span> </a> </li> <li class=md-nav__item> <a href=../../code_of_conduct.html class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> <li class=md-nav__item> <a href=../../contributing.html class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../license.html class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap.html class=md-nav__link> <span class=md-ellipsis> Roadmap </span> </a> </li> <li class=md-nav__item> <a href=../../changelog.html class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../glossary.html class=md-nav__link> <span class=md-ellipsis> Glossary </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../index.html class="md-nav__link "> <span class=md-ellipsis> User Guide </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../constants.html class=md-nav__link> <span class=md-ellipsis> Constants </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_2> <div class="md-nav__link md-nav__container"> <a href=../eop/index.html class="md-nav__link "> <span class=md-ellipsis> Earth Orientation Data </span> </a> <label class="md-nav__link " for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Earth Orientation Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../eop/what_is_eop_data.html class=md-nav__link> <span class=md-ellipsis> What is EOP Data? </span> </a> </li> <li class=md-nav__item> <a href=../eop/managing_eop_data.html class=md-nav__link> <span class=md-ellipsis> Managing EOP Data </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_3> <div class="md-nav__link md-nav__container"> <a href=../time/index.html class="md-nav__link "> <span class=md-ellipsis> Time </span> </a> <label class="md-nav__link " for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Time </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../time/epoch.html class=md-nav__link> <span class=md-ellipsis> Epoch </span> </a> </li> <li class=md-nav__item> <a href=../time/time_range.html class=md-nav__link> <span class=md-ellipsis> Time Range </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_4> <div class="md-nav__link md-nav__container"> <a href=../coordinates/index.html class="md-nav__link "> <span class=md-ellipsis> Coordinate Transformations </span> </a> <label class="md-nav__link " for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Coordinate Transformations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../coordinates/cartesian_transformations.html class=md-nav__link> <span class=md-ellipsis> Cartesian ↔ Orbital Element Transformations </span> </a> </li> <li class=md-nav__item> <a href=../coordinates/geocentric_transformations.html class=md-nav__link> <span class=md-ellipsis> Geocentric Transformations </span> </a> </li> <li class=md-nav__item> <a href=../coordinates/geodetic_transformations.html class=md-nav__link> <span class=md-ellipsis> Geodetic Transformations </span> </a> </li> <li class=md-nav__item> <a href=../coordinates/topocentric_transformations.html class=md-nav__link> <span class=md-ellipsis> Topocentric Coordinate Transformations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5 checked> <div class="md-nav__link md-nav__container"> <a href=index.html class="md-nav__link "> <span class=md-ellipsis> Reference Frame Transformations </span> </a> <label class="md-nav__link " for=__nav_2_5 id=__nav_2_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=true> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Reference Frame Transformations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=eci_ecef.html class=md-nav__link> <span class=md-ellipsis> ECI ↔ ECEF Transformations </span> </a> </li> <li class=md-nav__item> <a href=gcrf_itrf.html class=md-nav__link> <span class=md-ellipsis> GCRF ↔ ITRF Transformations </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> EME2000 ↔ GCRF Transformations </span> <span class="md-nav__icon md-icon"></span> </label> <a href=eme2000_gcrf.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> EME2000 ↔ GCRF Transformations </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#reference-frames class=md-nav__link> <span class=md-ellipsis> Reference Frames </span> </a> <nav class=md-nav aria-label="Reference Frames"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#eme2000-earth-mean-equator-and-equinox-of-j20000 class=md-nav__link> <span class=md-ellipsis> EME2000 (Earth Mean Equator and Equinox of J2000.0) </span> </a> </li> <li class=md-nav__item> <a href=#geocentric-celestial-reference-frame-gcrf class=md-nav__link> <span class=md-ellipsis> Geocentric Celestial Reference Frame (GCRF) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#frame-bias class=md-nav__link> <span class=md-ellipsis> Frame Bias </span> </a> </li> <li class=md-nav__item> <a href=#eme2000-to-gcrf class=md-nav__link> <span class=md-ellipsis> EME2000 to GCRF </span> </a> <nav class=md-nav aria-label="EME2000 to GCRF"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#state-vector class=md-nav__link> <span class=md-ellipsis> State Vector </span> </a> </li> <li class=md-nav__item> <a href=#position-vector class=md-nav__link> <span class=md-ellipsis> Position Vector </span> </a> </li> <li class=md-nav__item> <a href=#rotation-matrix class=md-nav__link> <span class=md-ellipsis> Rotation Matrix </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#gcrf-to-eme2000 class=md-nav__link> <span class=md-ellipsis> GCRF to EME2000 </span> </a> <nav class=md-nav aria-label="GCRF to EME2000"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#state-vector_1 class=md-nav__link> <span class=md-ellipsis> State Vector </span> </a> </li> <li class=md-nav__item> <a href=#position-vector_1 class=md-nav__link> <span class=md-ellipsis> Position Vector </span> </a> </li> <li class=md-nav__item> <a href=#rotation-matrix_1 class=md-nav__link> <span class=md-ellipsis> Rotation Matrix </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#frame-bias-matrix class=md-nav__link> <span class=md-ellipsis> Frame Bias Matrix </span> </a> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_6> <div class="md-nav__link md-nav__container"> <a href=../orbits/index.html class="md-nav__link "> <span class=md-ellipsis> Orbits </span> </a> <label class="md-nav__link " for=__nav_2_6 id=__nav_2_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> Orbits </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../orbits/anomalies.html class=md-nav__link> <span class=md-ellipsis> Anomaly Conversions </span> </a> </li> <li class=md-nav__item> <a href=../orbits/properties.html class=md-nav__link> <span class=md-ellipsis> Orbital Properties </span> </a> </li> <li class=md-nav__item> <a href=../orbits/two_line_elements.html class=md-nav__link> <span class=md-ellipsis> Two-Line Elements (TLE) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_7> <div class="md-nav__link md-nav__container"> <a href=../attitude_representations/index.html class="md-nav__link "> <span class=md-ellipsis> Attitude Representation </span> </a> <label class="md-nav__link " for=__nav_2_7 id=__nav_2_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Attitude Representation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../attitude_representations/quaternions.html class=md-nav__link> <span class=md-ellipsis> Quaternions </span> </a> </li> <li class=md-nav__item> <a href=../attitude_representations/rotation_matrices.html class=md-nav__link> <span class=md-ellipsis> Rotation Matrices </span> </a> </li> <li class=md-nav__item> <a href=../attitude_representations/euler_angles.html class=md-nav__link> <span class=md-ellipsis> Euler Angles </span> </a> </li> <li class=md-nav__item> <a href=../attitude_representations/euler_axis.html class=md-nav__link> <span class=md-ellipsis> Euler Axis (Axis-Angle) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_8> <div class="md-nav__link md-nav__container"> <a href=../trajectories/index.html class="md-nav__link "> <span class=md-ellipsis> Trajectories </span> </a> <label class="md-nav__link " for=__nav_2_8 id=__nav_2_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_8_label aria-expanded=false> <label class=md-nav__title for=__nav_2_8> <span class="md-nav__icon md-icon"></span> Trajectories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../trajectories/dtrajectory.html class=md-nav__link> <span class=md-ellipsis> DTrajectory </span> </a> </li> <li class=md-nav__item> <a href=../trajectories/strajectory6.html class=md-nav__link> <span class=md-ellipsis> STrajectory6 </span> </a> </li> <li class=md-nav__item> <a href=../trajectories/orbit_trajectory.html class=md-nav__link> <span class=md-ellipsis> OrbitTrajectory </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_9> <div class="md-nav__link md-nav__container"> <a href=../orbit_propagation/index.html class="md-nav__link "> <span class=md-ellipsis> Orbit Propagation </span> </a> <label class="md-nav__link " for=__nav_2_9 id=__nav_2_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_9_label aria-expanded=false> <label class=md-nav__title for=__nav_2_9> <span class="md-nav__icon md-icon"></span> Orbit Propagation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../orbit_propagation/keplerian_propagation.html class=md-nav__link> <span class=md-ellipsis> Keplerian Propagation </span> </a> </li> <li class=md-nav__item> <a href=../orbit_propagation/sgp_propagation.html class=md-nav__link> <span class=md-ellipsis> SGP Propagation </span> </a> </li> <li class=md-nav__item> <a href=../orbit_propagation/parallel_propagation.html class=md-nav__link> <span class=md-ellipsis> Parallel Propagation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_10> <div class="md-nav__link md-nav__container"> <a href=../relative_motion/index.html class="md-nav__link "> <span class=md-ellipsis> Relative Motion </span> </a> <label class="md-nav__link " for=__nav_2_10 id=__nav_2_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_10_label aria-expanded=false> <label class=md-nav__title for=__nav_2_10> <span class="md-nav__icon md-icon"></span> Relative Motion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../relative_motion/rtn_transformations.html class=md-nav__link> <span class=md-ellipsis> RTN Transformations </span> </a> </li> <li class=md-nav__item> <a href=../relative_motion/roe_transformations.html class=md-nav__link> <span class=md-ellipsis> Relative Orbital Elements (ROE) Transformations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_11> <div class="md-nav__link md-nav__container"> <a href=../access_computation/index.html class="md-nav__link "> <span class=md-ellipsis> Access Computation </span> </a> <label class="md-nav__link " for=__nav_2_11 id=__nav_2_11_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_11_label aria-expanded=false> <label class=md-nav__title for=__nav_2_11> <span class="md-nav__icon md-icon"></span> Access Computation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../access_computation/locations.html class=md-nav__link> <span class=md-ellipsis> Locations </span> </a> </li> <li class=md-nav__item> <a href=../access_computation/constraints.html class=md-nav__link> <span class=md-ellipsis> Constraints </span> </a> </li> <li class=md-nav__item> <a href=../access_computation/properties.html class=md-nav__link> <span class=md-ellipsis> Properties </span> </a> </li> <li class=md-nav__item> <a href=../access_computation/computation.html class=md-nav__link> <span class=md-ellipsis> Computation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_12> <div class="md-nav__link md-nav__container"> <a href=../datasets/index.html class="md-nav__link "> <span class=md-ellipsis> Datasets </span> </a> <label class="md-nav__link " for=__nav_2_12 id=__nav_2_12_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_12_label aria-expanded=false> <label class=md-nav__title for=__nav_2_12> <span class="md-nav__icon md-icon"></span> Datasets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../datasets/celestrak.html class=md-nav__link> <span class=md-ellipsis> CelesTrak </span> </a> </li> <li class=md-nav__item> <a href=../datasets/groundstations.html class=md-nav__link> <span class=md-ellipsis> Groundstations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_13> <div class="md-nav__link md-nav__container"> <a href=../utilities/index.html class="md-nav__link "> <span class=md-ellipsis> Utilities </span> </a> <label class="md-nav__link " for=__nav_2_13 id=__nav_2_13_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_13_label aria-expanded=false> <label class=md-nav__title for=__nav_2_13> <span class="md-nav__icon md-icon"></span> Utilities </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../utilities/caching.html class=md-nav__link> <span class=md-ellipsis> Caching </span> </a> </li> <li class=md-nav__item> <a href=../utilities/threading.html class=md-nav__link> <span class=md-ellipsis> Multithreading </span> </a> </li> <li class=md-nav__item> <a href=../utilities/string_formatting.html class=md-nav__link> <span class=md-ellipsis> String Formatting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_14> <div class="md-nav__link md-nav__container"> <a href=../plots/index.html class="md-nav__link "> <span class=md-ellipsis> Plots </span> </a> <label class="md-nav__link " for=__nav_2_14 id=__nav_2_14_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_14_label aria-expanded=false> <label class=md-nav__title for=__nav_2_14> <span class="md-nav__icon md-icon"></span> Plots </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../plots/orbital_trajectories.html class=md-nav__link> <span class=md-ellipsis> Orbital Trajectories </span> </a> </li> <li class=md-nav__item> <a href=../plots/3d_trajectory.html class=md-nav__link> <span class=md-ellipsis> 3D Trajectory </span> </a> </li> <li class=md-nav__item> <a href=../plots/ground_tracks.html class=md-nav__link> <span class=md-ellipsis> Ground Tracks </span> </a> </li> <li class=md-nav__item> <a href=../plots/access_geometry.html class=md-nav__link> <span class=md-ellipsis> Access Geometry </span> </a> </li> <li class=md-nav__item> <a href=../plots/gabbard_plot.html class=md-nav__link> <span class=md-ellipsis> Gabbard Plots </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_15> <div class="md-nav__link md-nav__container"> <a href=../cli/index.html class="md-nav__link "> <span class=md-ellipsis> Command Line Interface </span> </a> <label class="md-nav__link " for=__nav_2_15 id=__nav_2_15_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_15_label aria-expanded=false> <label class=md-nav__title for=__nav_2_15> <span class="md-nav__icon md-icon"></span> Command Line Interface </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cli/eop.html class=md-nav__link> <span class=md-ellipsis> EOP </span> </a> </li> <li class=md-nav__item> <a href=../cli/time.html class=md-nav__link> <span class=md-ellipsis> Time </span> </a> </li> <li class=md-nav__item> <a href=../cli/orbits.html class=md-nav__link> <span class=md-ellipsis> Orbits </span> </a> </li> <li class=md-nav__item> <a href=../cli/transform.html class=md-nav__link> <span class=md-ellipsis> Transform </span> </a> </li> <li class=md-nav__item> <a href=../cli/datasets.html class=md-nav__link> <span class=md-ellipsis> Datasets </span> </a> </li> <li class=md-nav__item> <a href=../cli/access.html class=md-nav__link> <span class=md-ellipsis> Access </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../examples/index.html class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/visualizing_gps.html class=md-nav__link> <span class=md-ellipsis> Visualizing GPS Satellite Orbits </span> </a> </li> <li class=md-nav__item> <a href=../../examples/visualizing_starlink.html class=md-nav__link> <span class=md-ellipsis> Downloading &amp; Visualizing TLE Data For Starlink Satellites </span> </a> </li> <li class=md-nav__item> <a href=../../examples/ground_contacts.html class=md-nav__link> <span class=md-ellipsis> Predicting Ground Contacts </span> </a> </li> <li class=md-nav__item> <a href=../../examples/doppler_compensation.html class=md-nav__link> <span class=md-ellipsis> Calculating Doppler Compensation </span> </a> </li> <li class=md-nav__item> <a href=../../examples/max_communications_gap.html class=md-nav__link> <span class=md-ellipsis> Maximum Communications Gap </span> </a> </li> <li class=md-nav__item> <a href=../../examples/imaging_opportunities.html class=md-nav__link> <span class=md-ellipsis> Earth Observation Imaging Opportunities </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../library_api/index.html class="md-nav__link "> <span class=md-ellipsis> Python API Reference </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Python API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_1> <div class="md-nav__link md-nav__container"> <a href=../../library_api/constants/index.html class="md-nav__link "> <span class=md-ellipsis> Constants </span> </a> <label class="md-nav__link " for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Constants </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/constants/units.html class=md-nav__link> <span class=md-ellipsis> Units </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/constants/math.html class=md-nav__link> <span class=md-ellipsis> Mathematical </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/constants/time.html class=md-nav__link> <span class=md-ellipsis> Time </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/constants/physical.html class=md-nav__link> <span class=md-ellipsis> Physical </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_2> <div class="md-nav__link md-nav__container"> <a href=../../library_api/eop/index.html class="md-nav__link "> <span class=md-ellipsis> EOP </span> </a> <label class="md-nav__link " for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> EOP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/eop/caching_provider.html class=md-nav__link> <span class=md-ellipsis> CachingEOPProvider </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/eop/file_provider.html class=md-nav__link> <span class=md-ellipsis> FileEOPProvider </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/eop/static_provider.html class=md-nav__link> <span class=md-ellipsis> StaticEOPProvider </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/eop/functions.html class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_3> <div class="md-nav__link md-nav__container"> <a href=../../library_api/time/index.html class="md-nav__link "> <span class=md-ellipsis> Time </span> </a> <label class="md-nav__link " for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Time </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/time/epoch.html class=md-nav__link> <span class=md-ellipsis> Epoch </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/time/conversions.html class=md-nav__link> <span class=md-ellipsis> Conversions </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/time/time_range.html class=md-nav__link> <span class=md-ellipsis> TimeRange </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_4> <div class="md-nav__link md-nav__container"> <a href=../../library_api/coordinates/index.html class="md-nav__link "> <span class=md-ellipsis> Coordinates </span> </a> <label class="md-nav__link " for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Coordinates </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/coordinates/cartesian.html class=md-nav__link> <span class=md-ellipsis> Cartesian </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/coordinates/geodetic.html class=md-nav__link> <span class=md-ellipsis> Geodetic & Geocentric </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/coordinates/topocentric.html class=md-nav__link> <span class=md-ellipsis> Topocentric </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/coordinates/enums.html class=md-nav__link> <span class=md-ellipsis> Enumerations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_5> <div class="md-nav__link md-nav__container"> <a href=../../library_api/frames/index.html class="md-nav__link "> <span class=md-ellipsis> Frames </span> </a> <label class="md-nav__link " for=__nav_4_5 id=__nav_4_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Frames </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/frames/eci_ecef.html class=md-nav__link> <span class=md-ellipsis> ECI ↔ ECEF </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/frames/gcrf_itrf.html class=md-nav__link> <span class=md-ellipsis> GCRF ↔ ITRF </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/frames/eme2000_gcrf.html class=md-nav__link> <span class=md-ellipsis> EME2000 ↔ GCRF </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_6> <div class="md-nav__link md-nav__container"> <a href=../../library_api/orbits/index.html class="md-nav__link "> <span class=md-ellipsis> Orbits </span> </a> <label class="md-nav__link " for=__nav_4_6 id=__nav_4_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Orbits </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/orbits/keplerian.html class=md-nav__link> <span class=md-ellipsis> Keplerian Elements </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbits/tle.html class=md-nav__link> <span class=md-ellipsis> Two-Line Elements </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbits/altitude_functions.html class=md-nav__link> <span class=md-ellipsis> Altitude Functions </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbits/enums.html class=md-nav__link> <span class=md-ellipsis> Enumerations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_7> <div class="md-nav__link md-nav__container"> <a href=../../library_api/attitude/index.html class="md-nav__link "> <span class=md-ellipsis> Attitude </span> </a> <label class="md-nav__link " for=__nav_4_7 id=__nav_4_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_4_7> <span class="md-nav__icon md-icon"></span> Attitude </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/attitude/quaternion.html class=md-nav__link> <span class=md-ellipsis> Quaternion </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/attitude/rotation_matrix.html class=md-nav__link> <span class=md-ellipsis> Rotation Matrix </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/attitude/euler_angles.html class=md-nav__link> <span class=md-ellipsis> Euler Angles </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/attitude/euler_axis.html class=md-nav__link> <span class=md-ellipsis> Euler Axis </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/attitude/euler_angle_order.html class=md-nav__link> <span class=md-ellipsis> EulerAngleOrder </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_8> <div class="md-nav__link md-nav__container"> <a href=../../library_api/trajectories/index.html class="md-nav__link "> <span class=md-ellipsis> Trajectories </span> </a> <label class="md-nav__link " for=__nav_4_8 id=__nav_4_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_8_label aria-expanded=false> <label class=md-nav__title for=__nav_4_8> <span class="md-nav__icon md-icon"></span> Trajectories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/trajectories/dtrajectory.html class=md-nav__link> <span class=md-ellipsis> DTrajectory </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/trajectories/strajectory6.html class=md-nav__link> <span class=md-ellipsis> STrajectory6 </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/trajectories/orbit_trajectory.html class=md-nav__link> <span class=md-ellipsis> OrbitTrajectory </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_9> <div class="md-nav__link md-nav__container"> <a href=../../library_api/propagators/index.html class="md-nav__link "> <span class=md-ellipsis> Propagators </span> </a> <label class="md-nav__link " for=__nav_4_9 id=__nav_4_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_9_label aria-expanded=false> <label class=md-nav__title for=__nav_4_9> <span class="md-nav__icon md-icon"></span> Propagators </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/propagators/keplerian_propagator.html class=md-nav__link> <span class=md-ellipsis> KeplerianPropagator </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/propagators/sgp_propagator.html class=md-nav__link> <span class=md-ellipsis> SGPPropagator </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/propagators/functions.html class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_10> <div class="md-nav__link md-nav__container"> <a href=../../library_api/relative_motion/index.html class="md-nav__link "> <span class=md-ellipsis> Relative Motion </span> </a> <label class="md-nav__link " for=__nav_4_10 id=__nav_4_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_10_label aria-expanded=false> <label class=md-nav__title for=__nav_4_10> <span class="md-nav__icon md-icon"></span> Relative Motion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/relative_motion/rtn_transformations.html class=md-nav__link> <span class=md-ellipsis> RTN Transformations </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/relative_motion/roe_transformations.html class=md-nav__link> <span class=md-ellipsis> ROE Transformations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_11> <div class="md-nav__link md-nav__container"> <a href=../../library_api/datasets/index.html class="md-nav__link "> <span class=md-ellipsis> Datasets </span> </a> <label class="md-nav__link " for=__nav_4_11 id=__nav_4_11_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_11_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11> <span class="md-nav__icon md-icon"></span> Datasets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/datasets/celestrak.html class=md-nav__link> <span class=md-ellipsis> CelesTrak </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/datasets/groundstations.html class=md-nav__link> <span class=md-ellipsis> Groundstations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_12> <div class="md-nav__link md-nav__container"> <a href=../../library_api/access/index.html class="md-nav__link "> <span class=md-ellipsis> Access </span> </a> <label class="md-nav__link " for=__nav_4_12 id=__nav_4_12_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_12_label aria-expanded=false> <label class=md-nav__title for=__nav_4_12> <span class="md-nav__icon md-icon"></span> Access </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/access/locations.html class=md-nav__link> <span class=md-ellipsis> Locations </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/access/constraints.html class=md-nav__link> <span class=md-ellipsis> Constraints </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/access/constraint_computer.html class=md-nav__link> <span class=md-ellipsis> Constraint Computer </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/access/properties.html class=md-nav__link> <span class=md-ellipsis> Properties </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/access/windows.html class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/access/enums.html class=md-nav__link> <span class=md-ellipsis> Enumerations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_13> <div class="md-nav__link md-nav__container"> <a href=../../library_api/plots/index.html class="md-nav__link "> <span class=md-ellipsis> Plots </span> </a> <label class="md-nav__link " for=__nav_4_13 id=__nav_4_13_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_13_label aria-expanded=false> <label class=md-nav__title for=__nav_4_13> <span class="md-nav__icon md-icon"></span> Plots </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/plots/ground_tracks.html class=md-nav__link> <span class=md-ellipsis> Ground Tracks </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/plots/orbital_trajectories.html class=md-nav__link> <span class=md-ellipsis> Orbital Trajectories </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/plots/3d_trajectory.html class=md-nav__link> <span class=md-ellipsis> 3D Trajectory </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/plots/access_geometry.html class=md-nav__link> <span class=md-ellipsis> Access Geometry </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/plots/gabbard.html class=md-nav__link> <span class=md-ellipsis> Gabbard Diagram </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_14> <div class="md-nav__link md-nav__container"> <a href=../../library_api/utils/index.html class="md-nav__link "> <span class=md-ellipsis> Utilities </span> </a> <label class="md-nav__link " for=__nav_4_14 id=__nav_4_14_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_14_label aria-expanded=false> <label class=md-nav__title for=__nav_4_14> <span class="md-nav__icon md-icon"></span> Utilities </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/utils/caching.html class=md-nav__link> <span class=md-ellipsis> Caching </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/utils/threading.html class=md-nav__link> <span class=md-ellipsis> Multithreading </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/utils/formatting.html class=md-nav__link> <span class=md-ellipsis> String Formatting </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://docs.rs/brahe class=md-nav__link> <span class=md-ellipsis> Rust API Reference </span> </a> </li> <li class=md-nav__item> <a href=https://duncaneddy.com class=md-nav__link> <span class=md-ellipsis> About Me </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#reference-frames class=md-nav__link> <span class=md-ellipsis> Reference Frames </span> </a> <nav class=md-nav aria-label="Reference Frames"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#eme2000-earth-mean-equator-and-equinox-of-j20000 class=md-nav__link> <span class=md-ellipsis> EME2000 (Earth Mean Equator and Equinox of J2000.0) </span> </a> </li> <li class=md-nav__item> <a href=#geocentric-celestial-reference-frame-gcrf class=md-nav__link> <span class=md-ellipsis> Geocentric Celestial Reference Frame (GCRF) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#frame-bias class=md-nav__link> <span class=md-ellipsis> Frame Bias </span> </a> </li> <li class=md-nav__item> <a href=#eme2000-to-gcrf class=md-nav__link> <span class=md-ellipsis> EME2000 to GCRF </span> </a> <nav class=md-nav aria-label="EME2000 to GCRF"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#state-vector class=md-nav__link> <span class=md-ellipsis> State Vector </span> </a> </li> <li class=md-nav__item> <a href=#position-vector class=md-nav__link> <span class=md-ellipsis> Position Vector </span> </a> </li> <li class=md-nav__item> <a href=#rotation-matrix class=md-nav__link> <span class=md-ellipsis> Rotation Matrix </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#gcrf-to-eme2000 class=md-nav__link> <span class=md-ellipsis> GCRF to EME2000 </span> </a> <nav class=md-nav aria-label="GCRF to EME2000"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#state-vector_1 class=md-nav__link> <span class=md-ellipsis> State Vector </span> </a> </li> <li class=md-nav__item> <a href=#position-vector_1 class=md-nav__link> <span class=md-ellipsis> Position Vector </span> </a> </li> <li class=md-nav__item> <a href=#rotation-matrix_1 class=md-nav__link> <span class=md-ellipsis> Rotation Matrix </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#frame-bias-matrix class=md-nav__link> <span class=md-ellipsis> Frame Bias Matrix </span> </a> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=eme2000-gcrf-transformations>EME2000 ↔ GCRF Transformations<a class=headerlink href=#eme2000-gcrf-transformations title="Permanent link">&para;</a></h1> <p>The EME2000 (Earth Mean Equator and Equinox of J2000.0) to GCRF (Geocentric Celestial Reference Frame) transformation accounts for the frame bias between the classical J2000.0 reference frame and the modern ICRS-aligned GCRF.</p> <div class="admonition tip"> <p class=admonition-title>When to Use EME2000</p> <p>EME2000 should primarily be used when:</p> <ul> <li>Working with older systems or datasets that use EME2000 coordinates</li> <li>Interfacing with software that requires EME2000 input/output</li> <li>Comparing results with historical analyses performed in EME2000</li> </ul> <p>For new applications, <strong>use GCRF as your standard inertial frame</strong>. GCRF is the current IAU/IERS standard and provides the most accurate representation of an inertial reference frame.</p> </div> <h2 id=reference-frames>Reference Frames<a class=headerlink href=#reference-frames title="Permanent link">&para;</a></h2> <h3 id=eme2000-earth-mean-equator-and-equinox-of-j20000>EME2000 (Earth Mean Equator and Equinox of J2000.0)<a class=headerlink href=#eme2000-earth-mean-equator-and-equinox-of-j20000 title="Permanent link">&para;</a></h3> <p>EME2000, also known as J2000.0, is the classical inertial reference frame defined by the mean equator and mean equinox of the Earth at the J2000.0 epoch (January 1, 2000, 12:00 TT). This frame was widely used in older astrodynamics systems and is still found in many datasets and applications.</p> <p>Key characteristics:</p> <ul> <li>Inertial frame (non-rotating)</li> <li>Defined using the mean equator and equinox at J2000.0</li> <li>Origin at Earth's center of mass</li> </ul> <h3 id=geocentric-celestial-reference-frame-gcrf>Geocentric Celestial Reference Frame (GCRF)<a class=headerlink href=#geocentric-celestial-reference-frame-gcrf title="Permanent link">&para;</a></h3> <p>The GCRF is the modern standard inertial reference frame, aligned with the International Celestial Reference System (ICRS). It is realized using observations of distant quasars and represents the current best realization of an inertial frame.</p> <p>Key characteristics:</p> <ul> <li>Inertial frame (non-rotating)</li> <li>ICRS-aligned (quasi-inertial with respect to distant objects)</li> <li>Origin at Earth's center of mass</li> <li>Standard frame for modern astrodynamics applications</li> </ul> <h2 id=frame-bias>Frame Bias<a class=headerlink href=#frame-bias title="Permanent link">&para;</a></h2> <p>The transformation between EME2000 and GCRF is a <strong>constant frame bias</strong> that does not vary with time. This bias accounts for the small offset between the J2000.0 mean equator/equinox and the ICRS alignment arising from the improved observational data used to define the ICRS.</p> <p>The bias is very small (on the order of milliarcseconds) but can matter for high-precision applications.</p> <div class="admonition tip"> <p class=admonition-title>Time Independence</p> <p>Unlike GCRF ↔ ITRF transformations, which are time-dependent and require Earth Orientation Parameters, the EME2000 ↔ GCRF transformation is <strong>constant</strong> and does not require an epoch parameter. The transformation is the same at all times.</p> </div> <h2 id=eme2000-to-gcrf>EME2000 to GCRF<a class=headerlink href=#eme2000-to-gcrf title="Permanent link">&para;</a></h2> <p>Transform coordinates from the EME2000 frame to the modern GCRF.</p> <h3 id=state-vector>State Vector<a class=headerlink href=#state-vector title="Permanent link">&para;</a></h3> <p>Transform a complete state vector (position and velocity) from EME2000 to GCRF:</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Python</label><label for=__tabbed_1_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1> 1</a></span>
<span class=normal><a href=#__codelineno-0-2> 2</a></span>
<span class=normal><a href=#__codelineno-0-3> 3</a></span>
<span class=normal><a href=#__codelineno-0-4> 4</a></span>
<span class=normal><a href=#__codelineno-0-5> 5</a></span>
<span class=normal><a href=#__codelineno-0-6> 6</a></span>
<span class=normal><a href=#__codelineno-0-7> 7</a></span>
<span class=normal><a href=#__codelineno-0-8> 8</a></span>
<span class=normal><a href=#__codelineno-0-9> 9</a></span>
<span class=normal><a href=#__codelineno-0-10>10</a></span>
<span class=normal><a href=#__codelineno-0-11>11</a></span>
<span class=normal><a href=#__codelineno-0-12>12</a></span>
<span class=normal><a href=#__codelineno-0-13>13</a></span>
<span class=normal><a href=#__codelineno-0-14>14</a></span>
<span class=normal><a href=#__codelineno-0-15>15</a></span>
<span class=normal><a href=#__codelineno-0-16>16</a></span>
<span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span>
<span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span>
<span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><span class=c1># Define orbital elements in degrees</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><span class=c1># LEO satellite: 500 km altitude, sun-synchronous orbit</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><span class=n>oe</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=p>[</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=n>bh</span><span class=o>.</span><span class=n>R_EARTH</span> <span class=o>+</span> <span class=mf>500e3</span><span class=p>,</span>  <span class=c1># Semi-major axis (m)</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=mf>0.01</span><span class=p>,</span>  <span class=c1># Eccentricity</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=mf>97.8</span><span class=p>,</span>  <span class=c1># Inclination (deg)</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=mf>15.0</span><span class=p>,</span>  <span class=c1># Right ascension of ascending node (deg)</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a>        <span class=mf>30.0</span><span class=p>,</span>  <span class=c1># Argument of periapsis (deg)</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a>        <span class=mf>45.0</span><span class=p>,</span>  <span class=c1># Mean anomaly (deg)</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=p>]</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=p>)</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Orbital elements (degrees):&quot;</span><span class=p>)</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  a    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> m = </span><span class=si>{</span><span class=p>(</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>bh</span><span class=o>.</span><span class=n>R_EARTH</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>1e3</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> km altitude&quot;</span><span class=p>)</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  e    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  i    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Ω    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ω    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  M    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=c1># Orbital elements (degrees):</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=c1>#   a    = 6878136.300 m = 500.0 km altitude</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=c1>#   e    = 0.0100</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=c1>#   i    = 97.8000°</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=c1>#   Ω    = 15.0000°</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=c1>#   ω    = 30.0000°</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=c1>#   M    = 45.0000°</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=c1># Convert to EME2000 Cartesian state</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=c1># Note: state_osculating_to_cartesian produces EME2000 states by default</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=n>state_eme2000</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span> <span class=n>bh</span><span class=o>.</span><span class=n>AngleFormat</span><span class=o>.</span><span class=n>DEGREES</span><span class=p>)</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;EME2000 state vector:&quot;</span><span class=p>)</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=sa>f</span><span class=s2>&quot;  Position: [</span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m&quot;</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=p>)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=sa>f</span><span class=s2>&quot;  Velocity: [</span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>] m/s</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=p>)</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=c1># EME2000 state vector:</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><span class=c1>#   Position: [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=c1>#   Velocity: [-7098.379734, -2173.344867, 1913.333385] m/s</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=c1># Transform to GCRF (constant transformation, no epoch needed)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=n>state_gcrf</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_eme2000_to_gcrf</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;GCRF state vector:&quot;</span><span class=p>)</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Position: [</span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m&quot;</span><span class=p>)</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>    <span class=sa>f</span><span class=s2>&quot;  Velocity: [</span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>] m/s</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=c1># GCRF state vector:</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=c1>#   Position: [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=c1>#   Velocity: [-7098.380042, -2173.344428, 1913.332741] m/s</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=c1># Transform back to EME2000 to verify round-trip</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=n>state_eme2000_back</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_gcrf_to_eme2000</span><span class=p>(</span><span class=n>state_gcrf</span><span class=p>)</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;EME2000 state vector (transformed from GCRF):&quot;</span><span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>    <span class=sa>f</span><span class=s2>&quot;  Position: [</span><span class=si>{</span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m&quot;</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=p>)</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>    <span class=sa>f</span><span class=s2>&quot;  Velocity: [</span><span class=si>{</span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>] m/s</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=p>)</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=c1># EME2000 state vector (transformed from GCRF):</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=c1>#   Position: [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=c1>#   Velocity: [-7098.379734, -2173.344867, 1913.333385] m/s</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=c1># Verify round-trip transformation</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=n>diff_pos</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=o>-</span> <span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>])</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=n>diff_vel</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>6</span><span class=p>]</span> <span class=o>-</span> <span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>6</span><span class=p>])</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Round-trip error:&quot;</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Position: </span><span class=si>{</span><span class=n>diff_pos</span><span class=si>:</span><span class=s2>.6e</span><span class=si>}</span><span class=s2> m&quot;</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Velocity: </span><span class=si>{</span><span class=n>diff_vel</span><span class=si>:</span><span class=s2>.6e</span><span class=si>}</span><span class=s2> m/s&quot;</span><span class=p>)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Note: Transformation is constant (time-independent, no epoch needed)&quot;</span><span class=p>)</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=c1># Round-trip error:</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=c1>#   Position: 3.863884e-08 m</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=c1>#   Velocity: 3.876304e-11 m/s</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-1-1> 1</a></span>
<span class=normal><a href=#__codelineno-1-2> 2</a></span>
<span class=normal><a href=#__codelineno-1-3> 3</a></span>
<span class=normal><a href=#__codelineno-1-4> 4</a></span>
<span class=normal><a href=#__codelineno-1-5> 5</a></span>
<span class=normal><a href=#__codelineno-1-6> 6</a></span>
<span class=normal><a href=#__codelineno-1-7> 7</a></span>
<span class=normal><a href=#__codelineno-1-8> 8</a></span>
<span class=normal><a href=#__codelineno-1-9> 9</a></span>
<span class=normal><a href=#__codelineno-1-10>10</a></span>
<span class=normal><a href=#__codelineno-1-11>11</a></span>
<span class=normal><a href=#__codelineno-1-12>12</a></span>
<span class=normal><a href=#__codelineno-1-13>13</a></span>
<span class=normal><a href=#__codelineno-1-14>14</a></span>
<span class=normal><a href=#__codelineno-1-15>15</a></span>
<span class=normal><a href=#__codelineno-1-16>16</a></span>
<span class=normal><a href=#__codelineno-1-17>17</a></span>
<span class=normal><a href=#__codelineno-1-18>18</a></span>
<span class=normal><a href=#__codelineno-1-19>19</a></span>
<span class=normal><a href=#__codelineno-1-20>20</a></span>
<span class=normal><a href=#__codelineno-1-21>21</a></span>
<span class=normal><a href=#__codelineno-1-22>22</a></span>
<span class=normal><a href=#__codelineno-1-23>23</a></span>
<span class=normal><a href=#__codelineno-1-24>24</a></span>
<span class=normal><a href=#__codelineno-1-25>25</a></span>
<span class=normal><a href=#__codelineno-1-26>26</a></span>
<span class=normal><a href=#__codelineno-1-27>27</a></span>
<span class=normal><a href=#__codelineno-1-28>28</a></span>
<span class=normal><a href=#__codelineno-1-29>29</a></span>
<span class=normal><a href=#__codelineno-1-30>30</a></span>
<span class=normal><a href=#__codelineno-1-31>31</a></span>
<span class=normal><a href=#__codelineno-1-32>32</a></span>
<span class=normal><a href=#__codelineno-1-33>33</a></span>
<span class=normal><a href=#__codelineno-1-34>34</a></span>
<span class=normal><a href=#__codelineno-1-35>35</a></span>
<span class=normal><a href=#__codelineno-1-36>36</a></span>
<span class=normal><a href=#__codelineno-1-37>37</a></span>
<span class=normal><a href=#__codelineno-1-38>38</a></span>
<span class=normal><a href=#__codelineno-1-39>39</a></span>
<span class=normal><a href=#__codelineno-1-40>40</a></span>
<span class=normal><a href=#__codelineno-1-41>41</a></span>
<span class=normal><a href=#__codelineno-1-42>42</a></span>
<span class=normal><a href=#__codelineno-1-43>43</a></span>
<span class=normal><a href=#__codelineno-1-44>44</a></span>
<span class=normal><a href=#__codelineno-1-45>45</a></span>
<span class=normal><a href=#__codelineno-1-46>46</a></span>
<span class=normal><a href=#__codelineno-1-47>47</a></span>
<span class=normal><a href=#__codelineno-1-48>48</a></span>
<span class=normal><a href=#__codelineno-1-49>49</a></span>
<span class=normal><a href=#__codelineno-1-50>50</a></span>
<span class=normal><a href=#__codelineno-1-51>51</a></span>
<span class=normal><a href=#__codelineno-1-52>52</a></span>
<span class=normal><a href=#__codelineno-1-53>53</a></span>
<span class=normal><a href=#__codelineno-1-54>54</a></span>
<span class=normal><a href=#__codelineno-1-55>55</a></span>
<span class=normal><a href=#__codelineno-1-56>56</a></span>
<span class=normal><a href=#__codelineno-1-57>57</a></span>
<span class=normal><a href=#__codelineno-1-58>58</a></span>
<span class=normal><a href=#__codelineno-1-59>59</a></span>
<span class=normal><a href=#__codelineno-1-60>60</a></span>
<span class=normal><a href=#__codelineno-1-61>61</a></span>
<span class=normal><a href=#__codelineno-1-62>62</a></span>
<span class=normal><a href=#__codelineno-1-63>63</a></span>
<span class=normal><a href=#__codelineno-1-64>64</a></span>
<span class=normal><a href=#__codelineno-1-65>65</a></span>
<span class=normal><a href=#__codelineno-1-66>66</a></span>
<span class=normal><a href=#__codelineno-1-67>67</a></span>
<span class=normal><a href=#__codelineno-1-68>68</a></span>
<span class=normal><a href=#__codelineno-1-69>69</a></span>
<span class=normal><a href=#__codelineno-1-70>70</a></span>
<span class=normal><a href=#__codelineno-1-71>71</a></span>
<span class=normal><a href=#__codelineno-1-72>72</a></span>
<span class=normal><a href=#__codelineno-1-73>73</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1></a><span class=k>use</span><span class=w> </span><span class=n>nalgebra</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>na</span><span class=p>;</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2></a>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4></a><span class=w>    </span><span class=c1>// Define orbital elements in degrees</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5></a><span class=w>    </span><span class=c1>// LEO satellite: 500 km altitude, sun-synchronous orbit</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>oe</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>SVector</span><span class=p>::</span><span class=o>&lt;</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=o>&gt;</span><span class=p>::</span><span class=n>new</span><span class=p>(</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7></a><span class=w>        </span><span class=n>bh</span><span class=p>::</span><span class=n>R_EARTH</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>500e3</span><span class=p>,</span><span class=w>  </span><span class=c1>// Semi-major axis (m)</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8></a><span class=w>        </span><span class=mf>0.01</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Eccentricity</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9></a><span class=w>        </span><span class=mf>97.8</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Inclination (deg)</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10></a><span class=w>        </span><span class=mf>15.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Right ascension of ascending node (deg)</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11></a><span class=w>        </span><span class=mf>30.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Argument of periapsis (deg)</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12></a><span class=w>        </span><span class=mf>45.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Mean anomaly (deg)</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14></a>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Orbital elements (degrees):&quot;</span><span class=p>);</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  a    = {:.3} m = {:.1} km altitude&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=p>(</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>R_EARTH</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>1e3</span><span class=p>);</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  e    = {:.4}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  i    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Ω    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>3</span><span class=p>]);</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  ω    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>4</span><span class=p>]);</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  M    = {:.4}°</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>5</span><span class=p>]);</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22></a><span class=w>    </span><span class=c1>// Orbital elements (degrees):</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23></a><span class=w>    </span><span class=c1>//   a    = 6878136.300 m = 500.0 km altitude</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24></a><span class=w>    </span><span class=c1>//   e    = 0.0100</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25></a><span class=w>    </span><span class=c1>//   i    = 97.8000°</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26></a><span class=w>    </span><span class=c1>//   Ω    = 15.0000°</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27></a><span class=w>    </span><span class=c1>//   ω    = 30.0000°</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28></a><span class=w>    </span><span class=c1>//   M    = 45.0000°</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29></a>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30></a><span class=w>    </span><span class=c1>// Convert to EME2000 Cartesian state</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31></a><span class=w>    </span><span class=c1>// Note: state_osculating_to_cartesian produces EME2000 states by default</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>AngleFormat</span><span class=p>::</span><span class=n>Degrees</span><span class=p>);</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33></a>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;EME2000 state vector:&quot;</span><span class=p>);</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Position: [{:.3}, {:.3}, {:.3}] m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Velocity: [{:.6}, {:.6}, {:.6}] m/s</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>5</span><span class=p>]);</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37></a><span class=w>    </span><span class=c1>// EME2000 state vector:</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38></a><span class=w>    </span><span class=c1>//   Position: [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39></a><span class=w>    </span><span class=c1>//   Velocity: [-7098.379734, -2173.344867, 1913.333385] m/s</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40></a>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41></a><span class=w>    </span><span class=c1>// Transform to GCRF (constant transformation, no epoch needed)</span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_gcrf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_eme2000_to_gcrf</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>);</span>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43></a>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;GCRF state vector:&quot;</span><span class=p>);</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Position: [{:.3}, {:.3}, {:.3}] m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Velocity: [{:.6}, {:.6}, {:.6}] m/s</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>5</span><span class=p>]);</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47></a><span class=w>    </span><span class=c1>// GCRF state vector:</span>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48></a><span class=w>    </span><span class=c1>//   Position: [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49></a><span class=w>    </span><span class=c1>//   Velocity: [-7098.380042, -2173.344428, 1913.332741] m/s</span>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50></a>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51></a><span class=w>    </span><span class=c1>// Transform back to EME2000 to verify round-trip</span>
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_gcrf_to_eme2000</span><span class=p>(</span><span class=n>state_gcrf</span><span class=p>);</span>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53></a>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;EME2000 state vector (transformed from GCRF):&quot;</span><span class=p>);</span>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Position: [{:.3}, {:.3}, {:.3}] m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Velocity: [{:.6}, {:.6}, {:.6}] m/s</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>5</span><span class=p>]);</span>
</span><span id=__span-1-57><a id=__codelineno-1-57 name=__codelineno-1-57></a><span class=w>    </span><span class=c1>// EME2000 state vector (transformed from GCRF):</span>
</span><span id=__span-1-58><a id=__codelineno-1-58 name=__codelineno-1-58></a><span class=w>    </span><span class=c1>//   Position: [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-1-59><a id=__codelineno-1-59 name=__codelineno-1-59></a><span class=w>    </span><span class=c1>//   Velocity: [-7098.379734, -2173.344867, 1913.333385] m/s</span>
</span><span id=__span-1-60><a id=__codelineno-1-60 name=__codelineno-1-60></a>
</span><span id=__span-1-61><a id=__codelineno-1-61 name=__codelineno-1-61></a><span class=w>    </span><span class=c1>// Verify round-trip transformation</span>
</span><span id=__span-1-62><a id=__codelineno-1-62 name=__codelineno-1-62></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>diff_pos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span><span class=w> </span><span class=o>-</span>
</span><span id=__span-1-63><a id=__codelineno-1-63 name=__codelineno-1-63></a><span class=w>                    </span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>2</span><span class=p>])).</span><span class=n>norm</span><span class=p>();</span>
</span><span id=__span-1-64><a id=__codelineno-1-64 name=__codelineno-1-64></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>diff_vel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>5</span><span class=p>])</span><span class=w> </span><span class=o>-</span>
</span><span id=__span-1-65><a id=__codelineno-1-65 name=__codelineno-1-65></a><span class=w>                    </span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000_back</span><span class=p>[</span><span class=mi>5</span><span class=p>])).</span><span class=n>norm</span><span class=p>();</span>
</span><span id=__span-1-66><a id=__codelineno-1-66 name=__codelineno-1-66></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Round-trip error:&quot;</span><span class=p>);</span>
</span><span id=__span-1-67><a id=__codelineno-1-67 name=__codelineno-1-67></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Position: {:.6e} m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>diff_pos</span><span class=p>);</span>
</span><span id=__span-1-68><a id=__codelineno-1-68 name=__codelineno-1-68></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Velocity: {:.6e} m/s&quot;</span><span class=p>,</span><span class=w> </span><span class=n>diff_vel</span><span class=p>);</span>
</span><span id=__span-1-69><a id=__codelineno-1-69 name=__codelineno-1-69></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>Note: Transformation is constant (time-independent, no epoch needed)&quot;</span><span class=p>);</span>
</span><span id=__span-1-70><a id=__codelineno-1-70 name=__codelineno-1-70></a><span class=c1>// Round-trip error:</span>
</span><span id=__span-1-71><a id=__codelineno-1-71 name=__codelineno-1-71></a><span class=c1>//   Position: 3.863884e-08 m</span>
</span><span id=__span-1-72><a id=__codelineno-1-72 name=__codelineno-1-72></a><span class=c1>//   Velocity: 3.876304e-11 m/s</span>
</span><span id=__span-1-73><a id=__codelineno-1-73 name=__codelineno-1-73></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <div class="admonition tip"> <p class=admonition-title>Velocity Transformation</p> <p>Because the transformation does not vary with time, velocity vectors are directly rotated without additional correction terms. There is no time-varying rotation rate to account for.</p> </div> <h3 id=position-vector>Position Vector<a class=headerlink href=#position-vector title="Permanent link">&para;</a></h3> <p>Transform a position vector from EME2000 to GCRF:</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>Python</label><label for=__tabbed_2_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-2-1> 1</a></span>
<span class=normal><a href=#__codelineno-2-2> 2</a></span>
<span class=normal><a href=#__codelineno-2-3> 3</a></span>
<span class=normal><a href=#__codelineno-2-4> 4</a></span>
<span class=normal><a href=#__codelineno-2-5> 5</a></span>
<span class=normal><a href=#__codelineno-2-6> 6</a></span>
<span class=normal><a href=#__codelineno-2-7> 7</a></span>
<span class=normal><a href=#__codelineno-2-8> 8</a></span>
<span class=normal><a href=#__codelineno-2-9> 9</a></span>
<span class=normal><a href=#__codelineno-2-10>10</a></span>
<span class=normal><a href=#__codelineno-2-11>11</a></span>
<span class=normal><a href=#__codelineno-2-12>12</a></span>
<span class=normal><a href=#__codelineno-2-13>13</a></span>
<span class=normal><a href=#__codelineno-2-14>14</a></span>
<span class=normal><a href=#__codelineno-2-15>15</a></span>
<span class=normal><a href=#__codelineno-2-16>16</a></span>
<span class=normal><a href=#__codelineno-2-17>17</a></span>
<span class=normal><a href=#__codelineno-2-18>18</a></span>
<span class=normal><a href=#__codelineno-2-19>19</a></span>
<span class=normal><a href=#__codelineno-2-20>20</a></span>
<span class=normal><a href=#__codelineno-2-21>21</a></span>
<span class=normal><a href=#__codelineno-2-22>22</a></span>
<span class=normal><a href=#__codelineno-2-23>23</a></span>
<span class=normal><a href=#__codelineno-2-24>24</a></span>
<span class=normal><a href=#__codelineno-2-25>25</a></span>
<span class=normal><a href=#__codelineno-2-26>26</a></span>
<span class=normal><a href=#__codelineno-2-27>27</a></span>
<span class=normal><a href=#__codelineno-2-28>28</a></span>
<span class=normal><a href=#__codelineno-2-29>29</a></span>
<span class=normal><a href=#__codelineno-2-30>30</a></span>
<span class=normal><a href=#__codelineno-2-31>31</a></span>
<span class=normal><a href=#__codelineno-2-32>32</a></span>
<span class=normal><a href=#__codelineno-2-33>33</a></span>
<span class=normal><a href=#__codelineno-2-34>34</a></span>
<span class=normal><a href=#__codelineno-2-35>35</a></span>
<span class=normal><a href=#__codelineno-2-36>36</a></span>
<span class=normal><a href=#__codelineno-2-37>37</a></span>
<span class=normal><a href=#__codelineno-2-38>38</a></span>
<span class=normal><a href=#__codelineno-2-39>39</a></span>
<span class=normal><a href=#__codelineno-2-40>40</a></span>
<span class=normal><a href=#__codelineno-2-41>41</a></span>
<span class=normal><a href=#__codelineno-2-42>42</a></span>
<span class=normal><a href=#__codelineno-2-43>43</a></span>
<span class=normal><a href=#__codelineno-2-44>44</a></span>
<span class=normal><a href=#__codelineno-2-45>45</a></span>
<span class=normal><a href=#__codelineno-2-46>46</a></span>
<span class=normal><a href=#__codelineno-2-47>47</a></span>
<span class=normal><a href=#__codelineno-2-48>48</a></span>
<span class=normal><a href=#__codelineno-2-49>49</a></span>
<span class=normal><a href=#__codelineno-2-50>50</a></span>
<span class=normal><a href=#__codelineno-2-51>51</a></span>
<span class=normal><a href=#__codelineno-2-52>52</a></span>
<span class=normal><a href=#__codelineno-2-53>53</a></span>
<span class=normal><a href=#__codelineno-2-54>54</a></span>
<span class=normal><a href=#__codelineno-2-55>55</a></span>
<span class=normal><a href=#__codelineno-2-56>56</a></span>
<span class=normal><a href=#__codelineno-2-57>57</a></span>
<span class=normal><a href=#__codelineno-2-58>58</a></span>
<span class=normal><a href=#__codelineno-2-59>59</a></span>
<span class=normal><a href=#__codelineno-2-60>60</a></span>
<span class=normal><a href=#__codelineno-2-61>61</a></span>
<span class=normal><a href=#__codelineno-2-62>62</a></span>
<span class=normal><a href=#__codelineno-2-63>63</a></span>
<span class=normal><a href=#__codelineno-2-64>64</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4></a><span class=c1># Define orbital elements in degrees</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5></a><span class=c1># LEO satellite: 500 km altitude, sun-synchronous orbit</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6></a><span class=n>oe</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7></a>    <span class=p>[</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8></a>        <span class=n>bh</span><span class=o>.</span><span class=n>R_EARTH</span> <span class=o>+</span> <span class=mf>500e3</span><span class=p>,</span>  <span class=c1># Semi-major axis (m)</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9></a>        <span class=mf>0.01</span><span class=p>,</span>  <span class=c1># Eccentricity</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10></a>        <span class=mf>97.8</span><span class=p>,</span>  <span class=c1># Inclination (deg)</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11></a>        <span class=mf>15.0</span><span class=p>,</span>  <span class=c1># Right ascension of ascending node (deg)</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12></a>        <span class=mf>30.0</span><span class=p>,</span>  <span class=c1># Argument of periapsis (deg)</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13></a>        <span class=mf>45.0</span><span class=p>,</span>  <span class=c1># Mean anomaly (deg)</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14></a>    <span class=p>]</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15></a><span class=p>)</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16></a>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Orbital elements (degrees):&quot;</span><span class=p>)</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  a    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> m = </span><span class=si>{</span><span class=p>(</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>bh</span><span class=o>.</span><span class=n>R_EARTH</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>1e3</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> km altitude&quot;</span><span class=p>)</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  e    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  i    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Ω    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ω    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  M    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24></a><span class=c1># Orbital elements (degrees):</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25></a><span class=c1>#   a    = 6878136.300 m = 500.0 km altitude</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26></a><span class=c1>#   e    = 0.0100</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27></a><span class=c1>#   i    = 97.8000°</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28></a><span class=c1>#   Ω    = 15.0000°</span>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29></a><span class=c1>#   ω    = 30.0000°</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30></a><span class=c1>#   M    = 45.0000°</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31></a>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32></a><span class=c1># Convert to EME2000 Cartesian state and extract position</span>
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33></a><span class=n>state_eme2000</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span> <span class=n>bh</span><span class=o>.</span><span class=n>AngleFormat</span><span class=o>.</span><span class=n>DEGREES</span><span class=p>)</span>
</span><span id=__span-2-34><a id=__codelineno-2-34 name=__codelineno-2-34></a><span class=n>pos_eme2000</span> <span class=o>=</span> <span class=n>state_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span>
</span><span id=__span-2-35><a id=__codelineno-2-35 name=__codelineno-2-35></a>
</span><span id=__span-2-36><a id=__codelineno-2-36 name=__codelineno-2-36></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Position in EME2000:&quot;</span><span class=p>)</span>
</span><span id=__span-2-37><a id=__codelineno-2-37 name=__codelineno-2-37></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-2-38><a id=__codelineno-2-38 name=__codelineno-2-38></a><span class=c1># Position in EME2000:</span>
</span><span id=__span-2-39><a id=__codelineno-2-39 name=__codelineno-2-39></a><span class=c1>#   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-2-40><a id=__codelineno-2-40 name=__codelineno-2-40></a>
</span><span id=__span-2-41><a id=__codelineno-2-41 name=__codelineno-2-41></a><span class=c1># Transform to GCRF (constant transformation, no epoch needed)</span>
</span><span id=__span-2-42><a id=__codelineno-2-42 name=__codelineno-2-42></a><span class=n>pos_gcrf</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>position_eme2000_to_gcrf</span><span class=p>(</span><span class=n>pos_eme2000</span><span class=p>)</span>
</span><span id=__span-2-43><a id=__codelineno-2-43 name=__codelineno-2-43></a>
</span><span id=__span-2-44><a id=__codelineno-2-44 name=__codelineno-2-44></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Position in GCRF:&quot;</span><span class=p>)</span>
</span><span id=__span-2-45><a id=__codelineno-2-45 name=__codelineno-2-45></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-2-46><a id=__codelineno-2-46 name=__codelineno-2-46></a><span class=c1># Position in GCRF:</span>
</span><span id=__span-2-47><a id=__codelineno-2-47 name=__codelineno-2-47></a><span class=c1># [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-2-48><a id=__codelineno-2-48 name=__codelineno-2-48></a>
</span><span id=__span-2-49><a id=__codelineno-2-49 name=__codelineno-2-49></a><span class=c1># Verify using rotation matrix</span>
</span><span id=__span-2-50><a id=__codelineno-2-50 name=__codelineno-2-50></a><span class=n>R_eme2000_to_gcrf</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>rotation_eme2000_to_gcrf</span><span class=p>()</span>
</span><span id=__span-2-51><a id=__codelineno-2-51 name=__codelineno-2-51></a><span class=n>pos_gcrf_matrix</span> <span class=o>=</span> <span class=n>R_eme2000_to_gcrf</span> <span class=o>@</span> <span class=n>pos_eme2000</span>
</span><span id=__span-2-52><a id=__codelineno-2-52 name=__codelineno-2-52></a>
</span><span id=__span-2-53><a id=__codelineno-2-53 name=__codelineno-2-53></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Position in GCRF (using rotation matrix):&quot;</span><span class=p>)</span>
</span><span id=__span-2-54><a id=__codelineno-2-54 name=__codelineno-2-54></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-2-55><a id=__codelineno-2-55 name=__codelineno-2-55></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-2-56><a id=__codelineno-2-56 name=__codelineno-2-56></a><span class=p>)</span>
</span><span id=__span-2-57><a id=__codelineno-2-57 name=__codelineno-2-57></a><span class=c1># Position in GCRF (using rotation matrix):</span>
</span><span id=__span-2-58><a id=__codelineno-2-58 name=__codelineno-2-58></a><span class=c1># [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-2-59><a id=__codelineno-2-59 name=__codelineno-2-59></a>
</span><span id=__span-2-60><a id=__codelineno-2-60 name=__codelineno-2-60></a><span class=c1># Verify both methods give same result</span>
</span><span id=__span-2-61><a id=__codelineno-2-61 name=__codelineno-2-61></a><span class=n>diff</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>pos_gcrf</span> <span class=o>-</span> <span class=n>pos_gcrf_matrix</span><span class=p>)</span>
</span><span id=__span-2-62><a id=__codelineno-2-62 name=__codelineno-2-62></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Difference between methods: </span><span class=si>{</span><span class=n>diff</span><span class=si>:</span><span class=s2>.6e</span><span class=si>}</span><span class=s2> m&quot;</span><span class=p>)</span>
</span><span id=__span-2-63><a id=__codelineno-2-63 name=__codelineno-2-63></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Note: Transformation is constant (time-independent, no epoch needed)&quot;</span><span class=p>)</span>
</span><span id=__span-2-64><a id=__codelineno-2-64 name=__codelineno-2-64></a><span class=c1># Difference between methods: 0.000000e+00 m</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-3-1> 1</a></span>
<span class=normal><a href=#__codelineno-3-2> 2</a></span>
<span class=normal><a href=#__codelineno-3-3> 3</a></span>
<span class=normal><a href=#__codelineno-3-4> 4</a></span>
<span class=normal><a href=#__codelineno-3-5> 5</a></span>
<span class=normal><a href=#__codelineno-3-6> 6</a></span>
<span class=normal><a href=#__codelineno-3-7> 7</a></span>
<span class=normal><a href=#__codelineno-3-8> 8</a></span>
<span class=normal><a href=#__codelineno-3-9> 9</a></span>
<span class=normal><a href=#__codelineno-3-10>10</a></span>
<span class=normal><a href=#__codelineno-3-11>11</a></span>
<span class=normal><a href=#__codelineno-3-12>12</a></span>
<span class=normal><a href=#__codelineno-3-13>13</a></span>
<span class=normal><a href=#__codelineno-3-14>14</a></span>
<span class=normal><a href=#__codelineno-3-15>15</a></span>
<span class=normal><a href=#__codelineno-3-16>16</a></span>
<span class=normal><a href=#__codelineno-3-17>17</a></span>
<span class=normal><a href=#__codelineno-3-18>18</a></span>
<span class=normal><a href=#__codelineno-3-19>19</a></span>
<span class=normal><a href=#__codelineno-3-20>20</a></span>
<span class=normal><a href=#__codelineno-3-21>21</a></span>
<span class=normal><a href=#__codelineno-3-22>22</a></span>
<span class=normal><a href=#__codelineno-3-23>23</a></span>
<span class=normal><a href=#__codelineno-3-24>24</a></span>
<span class=normal><a href=#__codelineno-3-25>25</a></span>
<span class=normal><a href=#__codelineno-3-26>26</a></span>
<span class=normal><a href=#__codelineno-3-27>27</a></span>
<span class=normal><a href=#__codelineno-3-28>28</a></span>
<span class=normal><a href=#__codelineno-3-29>29</a></span>
<span class=normal><a href=#__codelineno-3-30>30</a></span>
<span class=normal><a href=#__codelineno-3-31>31</a></span>
<span class=normal><a href=#__codelineno-3-32>32</a></span>
<span class=normal><a href=#__codelineno-3-33>33</a></span>
<span class=normal><a href=#__codelineno-3-34>34</a></span>
<span class=normal><a href=#__codelineno-3-35>35</a></span>
<span class=normal><a href=#__codelineno-3-36>36</a></span>
<span class=normal><a href=#__codelineno-3-37>37</a></span>
<span class=normal><a href=#__codelineno-3-38>38</a></span>
<span class=normal><a href=#__codelineno-3-39>39</a></span>
<span class=normal><a href=#__codelineno-3-40>40</a></span>
<span class=normal><a href=#__codelineno-3-41>41</a></span>
<span class=normal><a href=#__codelineno-3-42>42</a></span>
<span class=normal><a href=#__codelineno-3-43>43</a></span>
<span class=normal><a href=#__codelineno-3-44>44</a></span>
<span class=normal><a href=#__codelineno-3-45>45</a></span>
<span class=normal><a href=#__codelineno-3-46>46</a></span>
<span class=normal><a href=#__codelineno-3-47>47</a></span>
<span class=normal><a href=#__codelineno-3-48>48</a></span>
<span class=normal><a href=#__codelineno-3-49>49</a></span>
<span class=normal><a href=#__codelineno-3-50>50</a></span>
<span class=normal><a href=#__codelineno-3-51>51</a></span>
<span class=normal><a href=#__codelineno-3-52>52</a></span>
<span class=normal><a href=#__codelineno-3-53>53</a></span>
<span class=normal><a href=#__codelineno-3-54>54</a></span>
<span class=normal><a href=#__codelineno-3-55>55</a></span>
<span class=normal><a href=#__codelineno-3-56>56</a></span>
<span class=normal><a href=#__codelineno-3-57>57</a></span>
<span class=normal><a href=#__codelineno-3-58>58</a></span>
<span class=normal><a href=#__codelineno-3-59>59</a></span>
<span class=normal><a href=#__codelineno-3-60>60</a></span>
<span class=normal><a href=#__codelineno-3-61>61</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1></a><span class=k>use</span><span class=w> </span><span class=n>nalgebra</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>na</span><span class=p>;</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2></a>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4></a><span class=w>    </span><span class=c1>// Define orbital elements in degrees</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5></a><span class=w>    </span><span class=c1>// LEO satellite: 500 km altitude, sun-synchronous orbit</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>oe</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>SVector</span><span class=p>::</span><span class=o>&lt;</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=o>&gt;</span><span class=p>::</span><span class=n>new</span><span class=p>(</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7></a><span class=w>        </span><span class=n>bh</span><span class=p>::</span><span class=n>R_EARTH</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>500e3</span><span class=p>,</span><span class=w>  </span><span class=c1>// Semi-major axis (m)</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8></a><span class=w>        </span><span class=mf>0.01</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Eccentricity</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9></a><span class=w>        </span><span class=mf>97.8</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Inclination (deg)</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10></a><span class=w>        </span><span class=mf>15.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Right ascension of ascending node (deg)</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11></a><span class=w>        </span><span class=mf>30.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Argument of periapsis (deg)</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12></a><span class=w>        </span><span class=mf>45.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Mean anomaly (deg)</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14></a>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Orbital elements (degrees):&quot;</span><span class=p>);</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  a    = {:.3} m = {:.1} km altitude&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=p>(</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>R_EARTH</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>1e3</span><span class=p>);</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  e    = {:.4}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  i    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Ω    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>3</span><span class=p>]);</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  ω    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>4</span><span class=p>]);</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  M    = {:.4}°</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>5</span><span class=p>]);</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22></a><span class=w>    </span><span class=c1>// Orbital elements (degrees):</span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23></a><span class=w>    </span><span class=c1>//   a    = 6878136.300 m = 500.0 km altitude</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24></a><span class=w>    </span><span class=c1>//   e    = 0.0100</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25></a><span class=w>    </span><span class=c1>//   i    = 97.8000°</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26></a><span class=w>    </span><span class=c1>//   Ω    = 15.0000°</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27></a><span class=w>    </span><span class=c1>//   ω    = 30.0000°</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28></a><span class=w>    </span><span class=c1>//   M    = 45.0000°</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29></a>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30></a><span class=w>    </span><span class=c1>// Convert to EME2000 Cartesian state and extract position</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>AngleFormat</span><span class=p>::</span><span class=n>Degrees</span><span class=p>);</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33></a>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Position in EME2000:&quot;</span><span class=p>);</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36></a><span class=w>    </span><span class=c1>// Position in EME2000:</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37></a><span class=w>    </span><span class=c1>//   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38></a>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39></a><span class=w>    </span><span class=c1>// Transform to GCRF (constant transformation, no epoch needed)</span>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_gcrf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>position_eme2000_to_gcrf</span><span class=p>(</span><span class=n>pos_eme2000</span><span class=p>);</span>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41></a>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Position in GCRF:&quot;</span><span class=p>);</span>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-3-44><a id=__codelineno-3-44 name=__codelineno-3-44></a><span class=w>    </span><span class=c1>// Position in GCRF:</span>
</span><span id=__span-3-45><a id=__codelineno-3-45 name=__codelineno-3-45></a><span class=w>    </span><span class=c1>// [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-3-46><a id=__codelineno-3-46 name=__codelineno-3-46></a>
</span><span id=__span-3-47><a id=__codelineno-3-47 name=__codelineno-3-47></a><span class=w>    </span><span class=c1>// Verify using rotation matrix</span>
</span><span id=__span-3-48><a id=__codelineno-3-48 name=__codelineno-3-48></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>rotation_eme2000_to_gcrf</span><span class=p>();</span>
</span><span id=__span-3-49><a id=__codelineno-3-49 name=__codelineno-3-49></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_gcrf_matrix</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>;</span>
</span><span id=__span-3-50><a id=__codelineno-3-50 name=__codelineno-3-50></a>
</span><span id=__span-3-51><a id=__codelineno-3-51 name=__codelineno-3-51></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Position in GCRF (using rotation matrix):&quot;</span><span class=p>);</span>
</span><span id=__span-3-52><a id=__codelineno-3-52 name=__codelineno-3-52></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-3-53><a id=__codelineno-3-53 name=__codelineno-3-53></a><span class=w>    </span><span class=c1>// Position in GCRF (using rotation matrix):</span>
</span><span id=__span-3-54><a id=__codelineno-3-54 name=__codelineno-3-54></a><span class=w>    </span><span class=c1>// [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-3-55><a id=__codelineno-3-55 name=__codelineno-3-55></a>
</span><span id=__span-3-56><a id=__codelineno-3-56 name=__codelineno-3-56></a><span class=w>    </span><span class=c1>// Verify both methods give same result</span>
</span><span id=__span-3-57><a id=__codelineno-3-57 name=__codelineno-3-57></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>diff</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>pos_gcrf</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>pos_gcrf_matrix</span><span class=p>).</span><span class=n>norm</span><span class=p>();</span>
</span><span id=__span-3-58><a id=__codelineno-3-58 name=__codelineno-3-58></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Difference between methods: {:.6e} m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>diff</span><span class=p>);</span>
</span><span id=__span-3-59><a id=__codelineno-3-59 name=__codelineno-3-59></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>Note: Transformation is constant (time-independent, no epoch needed)&quot;</span><span class=p>);</span>
</span><span id=__span-3-60><a id=__codelineno-3-60 name=__codelineno-3-60></a><span class=w>    </span><span class=c1>// Difference between methods: 0.000000e+00 m</span>
</span><span id=__span-3-61><a id=__codelineno-3-61 name=__codelineno-3-61></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <h3 id=rotation-matrix>Rotation Matrix<a class=headerlink href=#rotation-matrix title="Permanent link">&para;</a></h3> <p>Get the constant rotation matrix from EME2000 to GCRF:</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>Python</label><label for=__tabbed_3_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-4-1> 1</a></span>
<span class=normal><a href=#__codelineno-4-2> 2</a></span>
<span class=normal><a href=#__codelineno-4-3> 3</a></span>
<span class=normal><a href=#__codelineno-4-4> 4</a></span>
<span class=normal><a href=#__codelineno-4-5> 5</a></span>
<span class=normal><a href=#__codelineno-4-6> 6</a></span>
<span class=normal><a href=#__codelineno-4-7> 7</a></span>
<span class=normal><a href=#__codelineno-4-8> 8</a></span>
<span class=normal><a href=#__codelineno-4-9> 9</a></span>
<span class=normal><a href=#__codelineno-4-10>10</a></span>
<span class=normal><a href=#__codelineno-4-11>11</a></span>
<span class=normal><a href=#__codelineno-4-12>12</a></span>
<span class=normal><a href=#__codelineno-4-13>13</a></span>
<span class=normal><a href=#__codelineno-4-14>14</a></span>
<span class=normal><a href=#__codelineno-4-15>15</a></span>
<span class=normal><a href=#__codelineno-4-16>16</a></span>
<span class=normal><a href=#__codelineno-4-17>17</a></span>
<span class=normal><a href=#__codelineno-4-18>18</a></span>
<span class=normal><a href=#__codelineno-4-19>19</a></span>
<span class=normal><a href=#__codelineno-4-20>20</a></span>
<span class=normal><a href=#__codelineno-4-21>21</a></span>
<span class=normal><a href=#__codelineno-4-22>22</a></span>
<span class=normal><a href=#__codelineno-4-23>23</a></span>
<span class=normal><a href=#__codelineno-4-24>24</a></span>
<span class=normal><a href=#__codelineno-4-25>25</a></span>
<span class=normal><a href=#__codelineno-4-26>26</a></span>
<span class=normal><a href=#__codelineno-4-27>27</a></span>
<span class=normal><a href=#__codelineno-4-28>28</a></span>
<span class=normal><a href=#__codelineno-4-29>29</a></span>
<span class=normal><a href=#__codelineno-4-30>30</a></span>
<span class=normal><a href=#__codelineno-4-31>31</a></span>
<span class=normal><a href=#__codelineno-4-32>32</a></span>
<span class=normal><a href=#__codelineno-4-33>33</a></span>
<span class=normal><a href=#__codelineno-4-34>34</a></span>
<span class=normal><a href=#__codelineno-4-35>35</a></span>
<span class=normal><a href=#__codelineno-4-36>36</a></span>
<span class=normal><a href=#__codelineno-4-37>37</a></span>
<span class=normal><a href=#__codelineno-4-38>38</a></span>
<span class=normal><a href=#__codelineno-4-39>39</a></span>
<span class=normal><a href=#__codelineno-4-40>40</a></span>
<span class=normal><a href=#__codelineno-4-41>41</a></span>
<span class=normal><a href=#__codelineno-4-42>42</a></span>
<span class=normal><a href=#__codelineno-4-43>43</a></span>
<span class=normal><a href=#__codelineno-4-44>44</a></span>
<span class=normal><a href=#__codelineno-4-45>45</a></span>
<span class=normal><a href=#__codelineno-4-46>46</a></span>
<span class=normal><a href=#__codelineno-4-47>47</a></span>
<span class=normal><a href=#__codelineno-4-48>48</a></span>
<span class=normal><a href=#__codelineno-4-49>49</a></span>
<span class=normal><a href=#__codelineno-4-50>50</a></span>
<span class=normal><a href=#__codelineno-4-51>51</a></span>
<span class=normal><a href=#__codelineno-4-52>52</a></span>
<span class=normal><a href=#__codelineno-4-53>53</a></span>
<span class=normal><a href=#__codelineno-4-54>54</a></span>
<span class=normal><a href=#__codelineno-4-55>55</a></span>
<span class=normal><a href=#__codelineno-4-56>56</a></span>
<span class=normal><a href=#__codelineno-4-57>57</a></span>
<span class=normal><a href=#__codelineno-4-58>58</a></span>
<span class=normal><a href=#__codelineno-4-59>59</a></span>
<span class=normal><a href=#__codelineno-4-60>60</a></span>
<span class=normal><a href=#__codelineno-4-61>61</a></span>
<span class=normal><a href=#__codelineno-4-62>62</a></span>
<span class=normal><a href=#__codelineno-4-63>63</a></span>
<span class=normal><a href=#__codelineno-4-64>64</a></span>
<span class=normal><a href=#__codelineno-4-65>65</a></span>
<span class=normal><a href=#__codelineno-4-66>66</a></span>
<span class=normal><a href=#__codelineno-4-67>67</a></span>
<span class=normal><a href=#__codelineno-4-68>68</a></span>
<span class=normal><a href=#__codelineno-4-69>69</a></span>
<span class=normal><a href=#__codelineno-4-70>70</a></span>
<span class=normal><a href=#__codelineno-4-71>71</a></span>
<span class=normal><a href=#__codelineno-4-72>72</a></span>
<span class=normal><a href=#__codelineno-4-73>73</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3></a>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4></a><span class=c1># Get constant rotation matrix from EME2000 to GCRF</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5></a><span class=n>R_eme2000_to_gcrf</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>rotation_eme2000_to_gcrf</span><span class=p>()</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6></a>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;EME2000 to GCRF rotation matrix:&quot;</span><span class=p>)</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>R_eme2000_to_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_eme2000_to_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_eme2000_to_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>]&quot;</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10></a><span class=p>)</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>R_eme2000_to_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_eme2000_to_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_eme2000_to_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>]&quot;</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13></a><span class=p>)</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>R_eme2000_to_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_eme2000_to_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_eme2000_to_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>]</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16></a><span class=p>)</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17></a><span class=c1># EME2000 to GCRF rotation matrix:</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18></a><span class=c1>#   [ 1.0000000000,  0.0000000708, -0.0000000806]</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19></a><span class=c1>#   [-0.0000000708,  1.0000000000, -0.0000000331]</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20></a><span class=c1>#   [ 0.0000000806,  0.0000000331,  1.0000000000]</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21></a>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22></a><span class=c1># Verify matrix is orthonormal (rotation matrix property)</span>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23></a><span class=n>identity</span> <span class=o>=</span> <span class=n>R_eme2000_to_gcrf</span> <span class=o>@</span> <span class=n>R_eme2000_to_gcrf</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Verify orthonormality (R @ R^T should be identity):&quot;</span><span class=p>)</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Max deviation from identity: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>identity</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=mi>3</span><span class=p>)))</span><span class=si>:</span><span class=s2>.2e</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26></a><span class=c1># Verify orthonormality (R @ R^T should be identity):</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27></a><span class=c1>#   Max deviation from identity: 4.68e-15</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28></a>
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29></a><span class=c1># Define orbital elements for testing transformation</span>
</span><span id=__span-4-30><a id=__codelineno-4-30 name=__codelineno-4-30></a><span class=n>oe</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-4-31><a id=__codelineno-4-31 name=__codelineno-4-31></a>    <span class=p>[</span>
</span><span id=__span-4-32><a id=__codelineno-4-32 name=__codelineno-4-32></a>        <span class=n>bh</span><span class=o>.</span><span class=n>R_EARTH</span> <span class=o>+</span> <span class=mf>500e3</span><span class=p>,</span>  <span class=c1># Semi-major axis (m)</span>
</span><span id=__span-4-33><a id=__codelineno-4-33 name=__codelineno-4-33></a>        <span class=mf>0.01</span><span class=p>,</span>  <span class=c1># Eccentricity</span>
</span><span id=__span-4-34><a id=__codelineno-4-34 name=__codelineno-4-34></a>        <span class=mf>97.8</span><span class=p>,</span>  <span class=c1># Inclination (deg)</span>
</span><span id=__span-4-35><a id=__codelineno-4-35 name=__codelineno-4-35></a>        <span class=mf>15.0</span><span class=p>,</span>  <span class=c1># RAAN (deg)</span>
</span><span id=__span-4-36><a id=__codelineno-4-36 name=__codelineno-4-36></a>        <span class=mf>30.0</span><span class=p>,</span>  <span class=c1># Argument of periapsis (deg)</span>
</span><span id=__span-4-37><a id=__codelineno-4-37 name=__codelineno-4-37></a>        <span class=mf>45.0</span><span class=p>,</span>  <span class=c1># Mean anomaly (deg)</span>
</span><span id=__span-4-38><a id=__codelineno-4-38 name=__codelineno-4-38></a>    <span class=p>]</span>
</span><span id=__span-4-39><a id=__codelineno-4-39 name=__codelineno-4-39></a><span class=p>)</span>
</span><span id=__span-4-40><a id=__codelineno-4-40 name=__codelineno-4-40></a>
</span><span id=__span-4-41><a id=__codelineno-4-41 name=__codelineno-4-41></a><span class=c1># Convert to EME2000 Cartesian state and extract position</span>
</span><span id=__span-4-42><a id=__codelineno-4-42 name=__codelineno-4-42></a><span class=n>state_eme2000</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span> <span class=n>bh</span><span class=o>.</span><span class=n>AngleFormat</span><span class=o>.</span><span class=n>DEGREES</span><span class=p>)</span>
</span><span id=__span-4-43><a id=__codelineno-4-43 name=__codelineno-4-43></a><span class=n>pos_eme2000</span> <span class=o>=</span> <span class=n>state_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span>
</span><span id=__span-4-44><a id=__codelineno-4-44 name=__codelineno-4-44></a>
</span><span id=__span-4-45><a id=__codelineno-4-45 name=__codelineno-4-45></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Satellite position in EME2000:&quot;</span><span class=p>)</span>
</span><span id=__span-4-46><a id=__codelineno-4-46 name=__codelineno-4-46></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-4-47><a id=__codelineno-4-47 name=__codelineno-4-47></a><span class=c1># Satellite position in EME2000:</span>
</span><span id=__span-4-48><a id=__codelineno-4-48 name=__codelineno-4-48></a><span class=c1>#   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-4-49><a id=__codelineno-4-49 name=__codelineno-4-49></a>
</span><span id=__span-4-50><a id=__codelineno-4-50 name=__codelineno-4-50></a><span class=c1># Transform using rotation matrix</span>
</span><span id=__span-4-51><a id=__codelineno-4-51 name=__codelineno-4-51></a><span class=n>pos_gcrf_matrix</span> <span class=o>=</span> <span class=n>R_eme2000_to_gcrf</span> <span class=o>@</span> <span class=n>pos_eme2000</span>
</span><span id=__span-4-52><a id=__codelineno-4-52 name=__codelineno-4-52></a>
</span><span id=__span-4-53><a id=__codelineno-4-53 name=__codelineno-4-53></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Satellite position in GCRF (using rotation matrix):&quot;</span><span class=p>)</span>
</span><span id=__span-4-54><a id=__codelineno-4-54 name=__codelineno-4-54></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-4-55><a id=__codelineno-4-55 name=__codelineno-4-55></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m&quot;</span>
</span><span id=__span-4-56><a id=__codelineno-4-56 name=__codelineno-4-56></a><span class=p>)</span>
</span><span id=__span-4-57><a id=__codelineno-4-57 name=__codelineno-4-57></a><span class=c1># Satellite position in GCRF (using rotation matrix):</span>
</span><span id=__span-4-58><a id=__codelineno-4-58 name=__codelineno-4-58></a><span class=c1>#   [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-4-59><a id=__codelineno-4-59 name=__codelineno-4-59></a>
</span><span id=__span-4-60><a id=__codelineno-4-60 name=__codelineno-4-60></a><span class=c1># Verify using position transformation function</span>
</span><span id=__span-4-61><a id=__codelineno-4-61 name=__codelineno-4-61></a><span class=n>pos_gcrf_direct</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>position_eme2000_to_gcrf</span><span class=p>(</span><span class=n>pos_eme2000</span><span class=p>)</span>
</span><span id=__span-4-62><a id=__codelineno-4-62 name=__codelineno-4-62></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Satellite position in GCRF (using position_eme2000_to_gcrf):&quot;</span><span class=p>)</span>
</span><span id=__span-4-63><a id=__codelineno-4-63 name=__codelineno-4-63></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-4-64><a id=__codelineno-4-64 name=__codelineno-4-64></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_gcrf_direct</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf_direct</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf_direct</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m&quot;</span>
</span><span id=__span-4-65><a id=__codelineno-4-65 name=__codelineno-4-65></a><span class=p>)</span>
</span><span id=__span-4-66><a id=__codelineno-4-66 name=__codelineno-4-66></a><span class=c1># Satellite position in GCRF (using position_eme2000_to_gcrf):</span>
</span><span id=__span-4-67><a id=__codelineno-4-67 name=__codelineno-4-67></a><span class=c1>#   [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-4-68><a id=__codelineno-4-68 name=__codelineno-4-68></a>
</span><span id=__span-4-69><a id=__codelineno-4-69 name=__codelineno-4-69></a><span class=c1># Verify both methods agree</span>
</span><span id=__span-4-70><a id=__codelineno-4-70 name=__codelineno-4-70></a><span class=n>diff</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>pos_gcrf_matrix</span> <span class=o>-</span> <span class=n>pos_gcrf_direct</span><span class=p>)</span>
</span><span id=__span-4-71><a id=__codelineno-4-71 name=__codelineno-4-71></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Difference between methods: </span><span class=si>{</span><span class=n>diff</span><span class=si>:</span><span class=s2>.6e</span><span class=si>}</span><span class=s2> m&quot;</span><span class=p>)</span>
</span><span id=__span-4-72><a id=__codelineno-4-72 name=__codelineno-4-72></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Note: Frame bias is constant (same at all epochs)&quot;</span><span class=p>)</span>
</span><span id=__span-4-73><a id=__codelineno-4-73 name=__codelineno-4-73></a><span class=c1># Difference between methods: 0.000000e+00 m</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-5-1> 1</a></span>
<span class=normal><a href=#__codelineno-5-2> 2</a></span>
<span class=normal><a href=#__codelineno-5-3> 3</a></span>
<span class=normal><a href=#__codelineno-5-4> 4</a></span>
<span class=normal><a href=#__codelineno-5-5> 5</a></span>
<span class=normal><a href=#__codelineno-5-6> 6</a></span>
<span class=normal><a href=#__codelineno-5-7> 7</a></span>
<span class=normal><a href=#__codelineno-5-8> 8</a></span>
<span class=normal><a href=#__codelineno-5-9> 9</a></span>
<span class=normal><a href=#__codelineno-5-10>10</a></span>
<span class=normal><a href=#__codelineno-5-11>11</a></span>
<span class=normal><a href=#__codelineno-5-12>12</a></span>
<span class=normal><a href=#__codelineno-5-13>13</a></span>
<span class=normal><a href=#__codelineno-5-14>14</a></span>
<span class=normal><a href=#__codelineno-5-15>15</a></span>
<span class=normal><a href=#__codelineno-5-16>16</a></span>
<span class=normal><a href=#__codelineno-5-17>17</a></span>
<span class=normal><a href=#__codelineno-5-18>18</a></span>
<span class=normal><a href=#__codelineno-5-19>19</a></span>
<span class=normal><a href=#__codelineno-5-20>20</a></span>
<span class=normal><a href=#__codelineno-5-21>21</a></span>
<span class=normal><a href=#__codelineno-5-22>22</a></span>
<span class=normal><a href=#__codelineno-5-23>23</a></span>
<span class=normal><a href=#__codelineno-5-24>24</a></span>
<span class=normal><a href=#__codelineno-5-25>25</a></span>
<span class=normal><a href=#__codelineno-5-26>26</a></span>
<span class=normal><a href=#__codelineno-5-27>27</a></span>
<span class=normal><a href=#__codelineno-5-28>28</a></span>
<span class=normal><a href=#__codelineno-5-29>29</a></span>
<span class=normal><a href=#__codelineno-5-30>30</a></span>
<span class=normal><a href=#__codelineno-5-31>31</a></span>
<span class=normal><a href=#__codelineno-5-32>32</a></span>
<span class=normal><a href=#__codelineno-5-33>33</a></span>
<span class=normal><a href=#__codelineno-5-34>34</a></span>
<span class=normal><a href=#__codelineno-5-35>35</a></span>
<span class=normal><a href=#__codelineno-5-36>36</a></span>
<span class=normal><a href=#__codelineno-5-37>37</a></span>
<span class=normal><a href=#__codelineno-5-38>38</a></span>
<span class=normal><a href=#__codelineno-5-39>39</a></span>
<span class=normal><a href=#__codelineno-5-40>40</a></span>
<span class=normal><a href=#__codelineno-5-41>41</a></span>
<span class=normal><a href=#__codelineno-5-42>42</a></span>
<span class=normal><a href=#__codelineno-5-43>43</a></span>
<span class=normal><a href=#__codelineno-5-44>44</a></span>
<span class=normal><a href=#__codelineno-5-45>45</a></span>
<span class=normal><a href=#__codelineno-5-46>46</a></span>
<span class=normal><a href=#__codelineno-5-47>47</a></span>
<span class=normal><a href=#__codelineno-5-48>48</a></span>
<span class=normal><a href=#__codelineno-5-49>49</a></span>
<span class=normal><a href=#__codelineno-5-50>50</a></span>
<span class=normal><a href=#__codelineno-5-51>51</a></span>
<span class=normal><a href=#__codelineno-5-52>52</a></span>
<span class=normal><a href=#__codelineno-5-53>53</a></span>
<span class=normal><a href=#__codelineno-5-54>54</a></span>
<span class=normal><a href=#__codelineno-5-55>55</a></span>
<span class=normal><a href=#__codelineno-5-56>56</a></span>
<span class=normal><a href=#__codelineno-5-57>57</a></span>
<span class=normal><a href=#__codelineno-5-58>58</a></span>
<span class=normal><a href=#__codelineno-5-59>59</a></span>
<span class=normal><a href=#__codelineno-5-60>60</a></span>
<span class=normal><a href=#__codelineno-5-61>61</a></span>
<span class=normal><a href=#__codelineno-5-62>62</a></span>
<span class=normal><a href=#__codelineno-5-63>63</a></span>
<span class=normal><a href=#__codelineno-5-64>64</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1></a><span class=k>use</span><span class=w> </span><span class=n>nalgebra</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>na</span><span class=p>;</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2></a>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4></a><span class=w>    </span><span class=c1>// Get constant rotation matrix from EME2000 to GCRF</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>rotation_eme2000_to_gcrf</span><span class=p>();</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6></a>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;EME2000 to GCRF rotation matrix:&quot;</span><span class=p>);</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:13.10}, {:13.10}, {:13.10}]&quot;</span><span class=p>,</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>[(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)],</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>[(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)],</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>[(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)]);</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:13.10}, {:13.10}, {:13.10}]&quot;</span><span class=p>,</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>[(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)],</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>[(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)],</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>[(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)]);</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:13.10}, {:13.10}, {:13.10}]</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>[(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)],</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>[(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)],</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>[(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)]);</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11></a><span class=w>    </span><span class=c1>// EME2000 to GCRF rotation matrix:</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12></a><span class=w>    </span><span class=c1>//   [ 0.9999999999, -0.0000000707, -0.0000000308]</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13></a><span class=w>    </span><span class=c1>//   [ 0.0000000707,  0.9999999999, -0.0000000001]</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14></a><span class=w>    </span><span class=c1>//   [ 0.0000000308,  0.0000000000,  1.0000000000]</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15></a>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16></a><span class=w>    </span><span class=c1>// Verify matrix is orthonormal (rotation matrix property)</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>identity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>.</span><span class=n>transpose</span><span class=p>();</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>identity_ref</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>Matrix3</span><span class=p>::</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=p>::</span><span class=n>identity</span><span class=p>();</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>max_dev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>identity</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>identity_ref</span><span class=p>).</span><span class=n>abs</span><span class=p>().</span><span class=n>max</span><span class=p>();</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Verify orthonormality (R @ R^T should be identity):&quot;</span><span class=p>);</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Max deviation from identity: {:.2e}</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>max_dev</span><span class=p>);</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22></a><span class=w>    </span><span class=c1>// Verify orthonormality (R @ R^T should be identity):</span>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23></a><span class=w>    </span><span class=c1>//   Max deviation from identity: 4.68e-15</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24></a>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25></a><span class=w>    </span><span class=c1>// Define orbital elements for testing transformation</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>oe</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>SVector</span><span class=p>::</span><span class=o>&lt;</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=o>&gt;</span><span class=p>::</span><span class=n>new</span><span class=p>(</span>
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27></a><span class=w>        </span><span class=n>bh</span><span class=p>::</span><span class=n>R_EARTH</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>500e3</span><span class=p>,</span><span class=w>  </span><span class=c1>// Semi-major axis (m)</span>
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28></a><span class=w>        </span><span class=mf>0.01</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Eccentricity</span>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29></a><span class=w>        </span><span class=mf>97.8</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Inclination (deg)</span>
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30></a><span class=w>        </span><span class=mf>15.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// RAAN (deg)</span>
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31></a><span class=w>        </span><span class=mf>30.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Argument of periapsis (deg)</span>
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32></a><span class=w>        </span><span class=mf>45.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Mean anomaly (deg)</span>
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34></a>
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35></a><span class=w>    </span><span class=c1>// Convert to EME2000 Cartesian state and extract position</span>
</span><span id=__span-5-36><a id=__codelineno-5-36 name=__codelineno-5-36></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>AngleFormat</span><span class=p>::</span><span class=n>Degrees</span><span class=p>);</span>
</span><span id=__span-5-37><a id=__codelineno-5-37 name=__codelineno-5-37></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-5-38><a id=__codelineno-5-38 name=__codelineno-5-38></a>
</span><span id=__span-5-39><a id=__codelineno-5-39 name=__codelineno-5-39></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Satellite position in EME2000:&quot;</span><span class=p>);</span>
</span><span id=__span-5-40><a id=__codelineno-5-40 name=__codelineno-5-40></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-5-41><a id=__codelineno-5-41 name=__codelineno-5-41></a><span class=w>    </span><span class=c1>// Satellite position in EME2000:</span>
</span><span id=__span-5-42><a id=__codelineno-5-42 name=__codelineno-5-42></a><span class=w>    </span><span class=c1>//   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-5-43><a id=__codelineno-5-43 name=__codelineno-5-43></a>
</span><span id=__span-5-44><a id=__codelineno-5-44 name=__codelineno-5-44></a><span class=w>    </span><span class=c1>// Transform using rotation matrix</span>
</span><span id=__span-5-45><a id=__codelineno-5-45 name=__codelineno-5-45></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_gcrf_matrix</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>;</span>
</span><span id=__span-5-46><a id=__codelineno-5-46 name=__codelineno-5-46></a>
</span><span id=__span-5-47><a id=__codelineno-5-47 name=__codelineno-5-47></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Satellite position in GCRF (using rotation matrix):&quot;</span><span class=p>);</span>
</span><span id=__span-5-48><a id=__codelineno-5-48 name=__codelineno-5-48></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf_matrix</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-5-49><a id=__codelineno-5-49 name=__codelineno-5-49></a><span class=w>    </span><span class=c1>// Satellite position in GCRF (using rotation matrix):</span>
</span><span id=__span-5-50><a id=__codelineno-5-50 name=__codelineno-5-50></a><span class=w>    </span><span class=c1>//   [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-5-51><a id=__codelineno-5-51 name=__codelineno-5-51></a>
</span><span id=__span-5-52><a id=__codelineno-5-52 name=__codelineno-5-52></a><span class=w>    </span><span class=c1>// Verify using position transformation function</span>
</span><span id=__span-5-53><a id=__codelineno-5-53 name=__codelineno-5-53></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_gcrf_direct</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>position_eme2000_to_gcrf</span><span class=p>(</span><span class=n>pos_eme2000</span><span class=p>);</span>
</span><span id=__span-5-54><a id=__codelineno-5-54 name=__codelineno-5-54></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>Satellite position in GCRF (using position_eme2000_to_gcrf):&quot;</span><span class=p>);</span>
</span><span id=__span-5-55><a id=__codelineno-5-55 name=__codelineno-5-55></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_gcrf_direct</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf_direct</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf_direct</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-5-56><a id=__codelineno-5-56 name=__codelineno-5-56></a><span class=w>    </span><span class=c1>// Satellite position in GCRF (using position_eme2000_to_gcrf):</span>
</span><span id=__span-5-57><a id=__codelineno-5-57 name=__codelineno-5-57></a><span class=w>    </span><span class=c1>//   [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-5-58><a id=__codelineno-5-58 name=__codelineno-5-58></a>
</span><span id=__span-5-59><a id=__codelineno-5-59 name=__codelineno-5-59></a><span class=w>    </span><span class=c1>// Verify both methods agree</span>
</span><span id=__span-5-60><a id=__codelineno-5-60 name=__codelineno-5-60></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>diff</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>pos_gcrf_matrix</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>pos_gcrf_direct</span><span class=p>).</span><span class=n>norm</span><span class=p>();</span>
</span><span id=__span-5-61><a id=__codelineno-5-61 name=__codelineno-5-61></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>Difference between methods: {:.6e} m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>diff</span><span class=p>);</span>
</span><span id=__span-5-62><a id=__codelineno-5-62 name=__codelineno-5-62></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>Note: Frame bias is constant (same at all epochs)&quot;</span><span class=p>);</span>
</span><span id=__span-5-63><a id=__codelineno-5-63 name=__codelineno-5-63></a><span class=w>    </span><span class=c1>// Difference between methods: 0.000000e+00 m</span>
</span><span id=__span-5-64><a id=__codelineno-5-64 name=__codelineno-5-64></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <h2 id=gcrf-to-eme2000>GCRF to EME2000<a class=headerlink href=#gcrf-to-eme2000 title="Permanent link">&para;</a></h2> <p>Transform coordinates from the modern GCRF to the older EME2000 frame.</p> <h3 id=state-vector_1>State Vector<a class=headerlink href=#state-vector_1 title="Permanent link">&para;</a></h3> <p>Transform a complete state vector (position and velocity) from GCRF to EME2000:</p> <div class="tabbed-set tabbed-alternate" data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><input id=__tabbed_4_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=__tabbed_4_1>Python</label><label for=__tabbed_4_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-6-1> 1</a></span>
<span class=normal><a href=#__codelineno-6-2> 2</a></span>
<span class=normal><a href=#__codelineno-6-3> 3</a></span>
<span class=normal><a href=#__codelineno-6-4> 4</a></span>
<span class=normal><a href=#__codelineno-6-5> 5</a></span>
<span class=normal><a href=#__codelineno-6-6> 6</a></span>
<span class=normal><a href=#__codelineno-6-7> 7</a></span>
<span class=normal><a href=#__codelineno-6-8> 8</a></span>
<span class=normal><a href=#__codelineno-6-9> 9</a></span>
<span class=normal><a href=#__codelineno-6-10>10</a></span>
<span class=normal><a href=#__codelineno-6-11>11</a></span>
<span class=normal><a href=#__codelineno-6-12>12</a></span>
<span class=normal><a href=#__codelineno-6-13>13</a></span>
<span class=normal><a href=#__codelineno-6-14>14</a></span>
<span class=normal><a href=#__codelineno-6-15>15</a></span>
<span class=normal><a href=#__codelineno-6-16>16</a></span>
<span class=normal><a href=#__codelineno-6-17>17</a></span>
<span class=normal><a href=#__codelineno-6-18>18</a></span>
<span class=normal><a href=#__codelineno-6-19>19</a></span>
<span class=normal><a href=#__codelineno-6-20>20</a></span>
<span class=normal><a href=#__codelineno-6-21>21</a></span>
<span class=normal><a href=#__codelineno-6-22>22</a></span>
<span class=normal><a href=#__codelineno-6-23>23</a></span>
<span class=normal><a href=#__codelineno-6-24>24</a></span>
<span class=normal><a href=#__codelineno-6-25>25</a></span>
<span class=normal><a href=#__codelineno-6-26>26</a></span>
<span class=normal><a href=#__codelineno-6-27>27</a></span>
<span class=normal><a href=#__codelineno-6-28>28</a></span>
<span class=normal><a href=#__codelineno-6-29>29</a></span>
<span class=normal><a href=#__codelineno-6-30>30</a></span>
<span class=normal><a href=#__codelineno-6-31>31</a></span>
<span class=normal><a href=#__codelineno-6-32>32</a></span>
<span class=normal><a href=#__codelineno-6-33>33</a></span>
<span class=normal><a href=#__codelineno-6-34>34</a></span>
<span class=normal><a href=#__codelineno-6-35>35</a></span>
<span class=normal><a href=#__codelineno-6-36>36</a></span>
<span class=normal><a href=#__codelineno-6-37>37</a></span>
<span class=normal><a href=#__codelineno-6-38>38</a></span>
<span class=normal><a href=#__codelineno-6-39>39</a></span>
<span class=normal><a href=#__codelineno-6-40>40</a></span>
<span class=normal><a href=#__codelineno-6-41>41</a></span>
<span class=normal><a href=#__codelineno-6-42>42</a></span>
<span class=normal><a href=#__codelineno-6-43>43</a></span>
<span class=normal><a href=#__codelineno-6-44>44</a></span>
<span class=normal><a href=#__codelineno-6-45>45</a></span>
<span class=normal><a href=#__codelineno-6-46>46</a></span>
<span class=normal><a href=#__codelineno-6-47>47</a></span>
<span class=normal><a href=#__codelineno-6-48>48</a></span>
<span class=normal><a href=#__codelineno-6-49>49</a></span>
<span class=normal><a href=#__codelineno-6-50>50</a></span>
<span class=normal><a href=#__codelineno-6-51>51</a></span>
<span class=normal><a href=#__codelineno-6-52>52</a></span>
<span class=normal><a href=#__codelineno-6-53>53</a></span>
<span class=normal><a href=#__codelineno-6-54>54</a></span>
<span class=normal><a href=#__codelineno-6-55>55</a></span>
<span class=normal><a href=#__codelineno-6-56>56</a></span>
<span class=normal><a href=#__codelineno-6-57>57</a></span>
<span class=normal><a href=#__codelineno-6-58>58</a></span>
<span class=normal><a href=#__codelineno-6-59>59</a></span>
<span class=normal><a href=#__codelineno-6-60>60</a></span>
<span class=normal><a href=#__codelineno-6-61>61</a></span>
<span class=normal><a href=#__codelineno-6-62>62</a></span>
<span class=normal><a href=#__codelineno-6-63>63</a></span>
<span class=normal><a href=#__codelineno-6-64>64</a></span>
<span class=normal><a href=#__codelineno-6-65>65</a></span>
<span class=normal><a href=#__codelineno-6-66>66</a></span>
<span class=normal><a href=#__codelineno-6-67>67</a></span>
<span class=normal><a href=#__codelineno-6-68>68</a></span>
<span class=normal><a href=#__codelineno-6-69>69</a></span>
<span class=normal><a href=#__codelineno-6-70>70</a></span>
<span class=normal><a href=#__codelineno-6-71>71</a></span>
<span class=normal><a href=#__codelineno-6-72>72</a></span>
<span class=normal><a href=#__codelineno-6-73>73</a></span>
<span class=normal><a href=#__codelineno-6-74>74</a></span>
<span class=normal><a href=#__codelineno-6-75>75</a></span>
<span class=normal><a href=#__codelineno-6-76>76</a></span>
<span class=normal><a href=#__codelineno-6-77>77</a></span>
<span class=normal><a href=#__codelineno-6-78>78</a></span>
<span class=normal><a href=#__codelineno-6-79>79</a></span>
<span class=normal><a href=#__codelineno-6-80>80</a></span>
<span class=normal><a href=#__codelineno-6-81>81</a></span>
<span class=normal><a href=#__codelineno-6-82>82</a></span>
<span class=normal><a href=#__codelineno-6-83>83</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3></a>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4></a><span class=c1># Define orbital elements in degrees</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5></a><span class=c1># LEO satellite: 500 km altitude, sun-synchronous orbit</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6></a><span class=n>oe</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7></a>    <span class=p>[</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8></a>        <span class=n>bh</span><span class=o>.</span><span class=n>R_EARTH</span> <span class=o>+</span> <span class=mf>500e3</span><span class=p>,</span>  <span class=c1># Semi-major axis (m)</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9></a>        <span class=mf>0.01</span><span class=p>,</span>  <span class=c1># Eccentricity</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10></a>        <span class=mf>97.8</span><span class=p>,</span>  <span class=c1># Inclination (deg)</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11></a>        <span class=mf>15.0</span><span class=p>,</span>  <span class=c1># Right ascension of ascending node (deg)</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12></a>        <span class=mf>30.0</span><span class=p>,</span>  <span class=c1># Argument of periapsis (deg)</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13></a>        <span class=mf>45.0</span><span class=p>,</span>  <span class=c1># Mean anomaly (deg)</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14></a>    <span class=p>]</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15></a><span class=p>)</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16></a>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Orbital elements (degrees):&quot;</span><span class=p>)</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  a    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> m = </span><span class=si>{</span><span class=p>(</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>bh</span><span class=o>.</span><span class=n>R_EARTH</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>1e3</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> km altitude&quot;</span><span class=p>)</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  e    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  i    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Ω    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ω    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  M    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24></a><span class=c1># Orbital elements (degrees):</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25></a><span class=c1>#   a    = 6878136.300 m = 500.0 km altitude</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26></a><span class=c1>#   e    = 0.0100</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27></a><span class=c1>#   i    = 97.8000°</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28></a><span class=c1>#   Ω    = 15.0000°</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29></a><span class=c1>#   ω    = 30.0000°</span>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30></a><span class=c1>#   M    = 45.0000°</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31></a>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32></a><span class=c1># Convert to EME2000 state, then transform to GCRF</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33></a><span class=c1># (Starting in EME2000 to get GCRF representation)</span>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34></a><span class=n>state_eme2000_orig</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span> <span class=n>bh</span><span class=o>.</span><span class=n>AngleFormat</span><span class=o>.</span><span class=n>DEGREES</span><span class=p>)</span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35></a><span class=n>state_gcrf</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_eme2000_to_gcrf</span><span class=p>(</span><span class=n>state_eme2000_orig</span><span class=p>)</span>
</span><span id=__span-6-36><a id=__codelineno-6-36 name=__codelineno-6-36></a>
</span><span id=__span-6-37><a id=__codelineno-6-37 name=__codelineno-6-37></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;GCRF state vector:&quot;</span><span class=p>)</span>
</span><span id=__span-6-38><a id=__codelineno-6-38 name=__codelineno-6-38></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Position: [</span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m&quot;</span><span class=p>)</span>
</span><span id=__span-6-39><a id=__codelineno-6-39 name=__codelineno-6-39></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-6-40><a id=__codelineno-6-40 name=__codelineno-6-40></a>    <span class=sa>f</span><span class=s2>&quot;  Velocity: [</span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>] m/s</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-6-41><a id=__codelineno-6-41 name=__codelineno-6-41></a><span class=p>)</span>
</span><span id=__span-6-42><a id=__codelineno-6-42 name=__codelineno-6-42></a><span class=c1># GCRF state vector:</span>
</span><span id=__span-6-43><a id=__codelineno-6-43 name=__codelineno-6-43></a><span class=c1>#   Position: [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-6-44><a id=__codelineno-6-44 name=__codelineno-6-44></a><span class=c1>#   Velocity: [-7098.380042, -2173.344428, 1913.332741] m/s</span>
</span><span id=__span-6-45><a id=__codelineno-6-45 name=__codelineno-6-45></a>
</span><span id=__span-6-46><a id=__codelineno-6-46 name=__codelineno-6-46></a><span class=c1># Transform to EME2000 (constant transformation, no epoch needed)</span>
</span><span id=__span-6-47><a id=__codelineno-6-47 name=__codelineno-6-47></a><span class=n>state_eme2000</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_gcrf_to_eme2000</span><span class=p>(</span><span class=n>state_gcrf</span><span class=p>)</span>
</span><span id=__span-6-48><a id=__codelineno-6-48 name=__codelineno-6-48></a>
</span><span id=__span-6-49><a id=__codelineno-6-49 name=__codelineno-6-49></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;EME2000 state vector:&quot;</span><span class=p>)</span>
</span><span id=__span-6-50><a id=__codelineno-6-50 name=__codelineno-6-50></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-6-51><a id=__codelineno-6-51 name=__codelineno-6-51></a>    <span class=sa>f</span><span class=s2>&quot;  Position: [</span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m&quot;</span>
</span><span id=__span-6-52><a id=__codelineno-6-52 name=__codelineno-6-52></a><span class=p>)</span>
</span><span id=__span-6-53><a id=__codelineno-6-53 name=__codelineno-6-53></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-6-54><a id=__codelineno-6-54 name=__codelineno-6-54></a>    <span class=sa>f</span><span class=s2>&quot;  Velocity: [</span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>] m/s</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-6-55><a id=__codelineno-6-55 name=__codelineno-6-55></a><span class=p>)</span>
</span><span id=__span-6-56><a id=__codelineno-6-56 name=__codelineno-6-56></a><span class=c1># EME2000 state vector:</span>
</span><span id=__span-6-57><a id=__codelineno-6-57 name=__codelineno-6-57></a><span class=c1>#   Position: [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-6-58><a id=__codelineno-6-58 name=__codelineno-6-58></a><span class=c1>#   Velocity: [-7098.379734, -2173.344867, 1913.333385] m/s</span>
</span><span id=__span-6-59><a id=__codelineno-6-59 name=__codelineno-6-59></a>
</span><span id=__span-6-60><a id=__codelineno-6-60 name=__codelineno-6-60></a><span class=c1># Transform back to GCRF to verify round-trip</span>
</span><span id=__span-6-61><a id=__codelineno-6-61 name=__codelineno-6-61></a><span class=n>state_gcrf_back</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_eme2000_to_gcrf</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>)</span>
</span><span id=__span-6-62><a id=__codelineno-6-62 name=__codelineno-6-62></a>
</span><span id=__span-6-63><a id=__codelineno-6-63 name=__codelineno-6-63></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;GCRF state vector (transformed from EME2000):&quot;</span><span class=p>)</span>
</span><span id=__span-6-64><a id=__codelineno-6-64 name=__codelineno-6-64></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-6-65><a id=__codelineno-6-65 name=__codelineno-6-65></a>    <span class=sa>f</span><span class=s2>&quot;  Position: [</span><span class=si>{</span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m&quot;</span>
</span><span id=__span-6-66><a id=__codelineno-6-66 name=__codelineno-6-66></a><span class=p>)</span>
</span><span id=__span-6-67><a id=__codelineno-6-67 name=__codelineno-6-67></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-6-68><a id=__codelineno-6-68 name=__codelineno-6-68></a>    <span class=sa>f</span><span class=s2>&quot;  Velocity: [</span><span class=si>{</span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>] m/s</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-6-69><a id=__codelineno-6-69 name=__codelineno-6-69></a><span class=p>)</span>
</span><span id=__span-6-70><a id=__codelineno-6-70 name=__codelineno-6-70></a><span class=c1># GCRF state vector (transformed from EME2000):</span>
</span><span id=__span-6-71><a id=__codelineno-6-71 name=__codelineno-6-71></a><span class=c1>#   Position: [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-6-72><a id=__codelineno-6-72 name=__codelineno-6-72></a><span class=c1>#   Velocity: [-7098.380042, -2173.344428, 1913.332741] m/s</span>
</span><span id=__span-6-73><a id=__codelineno-6-73 name=__codelineno-6-73></a>
</span><span id=__span-6-74><a id=__codelineno-6-74 name=__codelineno-6-74></a><span class=c1># Verify round-trip transformation</span>
</span><span id=__span-6-75><a id=__codelineno-6-75 name=__codelineno-6-75></a><span class=n>diff_pos</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=o>-</span> <span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>])</span>
</span><span id=__span-6-76><a id=__codelineno-6-76 name=__codelineno-6-76></a><span class=n>diff_vel</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>6</span><span class=p>]</span> <span class=o>-</span> <span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>6</span><span class=p>])</span>
</span><span id=__span-6-77><a id=__codelineno-6-77 name=__codelineno-6-77></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Round-trip error:&quot;</span><span class=p>)</span>
</span><span id=__span-6-78><a id=__codelineno-6-78 name=__codelineno-6-78></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Position: </span><span class=si>{</span><span class=n>diff_pos</span><span class=si>:</span><span class=s2>.6e</span><span class=si>}</span><span class=s2> m&quot;</span><span class=p>)</span>
</span><span id=__span-6-79><a id=__codelineno-6-79 name=__codelineno-6-79></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Velocity: </span><span class=si>{</span><span class=n>diff_vel</span><span class=si>:</span><span class=s2>.6e</span><span class=si>}</span><span class=s2> m/s&quot;</span><span class=p>)</span>
</span><span id=__span-6-80><a id=__codelineno-6-80 name=__codelineno-6-80></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Note: Transformation is constant (time-independent, no epoch needed)&quot;</span><span class=p>)</span>
</span><span id=__span-6-81><a id=__codelineno-6-81 name=__codelineno-6-81></a><span class=c1># Round-trip error:</span>
</span><span id=__span-6-82><a id=__codelineno-6-82 name=__codelineno-6-82></a><span class=c1>#   Position: 3.863884e-08 m</span>
</span><span id=__span-6-83><a id=__codelineno-6-83 name=__codelineno-6-83></a><span class=c1>#   Velocity: 3.876304e-11 m/s</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-7-1> 1</a></span>
<span class=normal><a href=#__codelineno-7-2> 2</a></span>
<span class=normal><a href=#__codelineno-7-3> 3</a></span>
<span class=normal><a href=#__codelineno-7-4> 4</a></span>
<span class=normal><a href=#__codelineno-7-5> 5</a></span>
<span class=normal><a href=#__codelineno-7-6> 6</a></span>
<span class=normal><a href=#__codelineno-7-7> 7</a></span>
<span class=normal><a href=#__codelineno-7-8> 8</a></span>
<span class=normal><a href=#__codelineno-7-9> 9</a></span>
<span class=normal><a href=#__codelineno-7-10>10</a></span>
<span class=normal><a href=#__codelineno-7-11>11</a></span>
<span class=normal><a href=#__codelineno-7-12>12</a></span>
<span class=normal><a href=#__codelineno-7-13>13</a></span>
<span class=normal><a href=#__codelineno-7-14>14</a></span>
<span class=normal><a href=#__codelineno-7-15>15</a></span>
<span class=normal><a href=#__codelineno-7-16>16</a></span>
<span class=normal><a href=#__codelineno-7-17>17</a></span>
<span class=normal><a href=#__codelineno-7-18>18</a></span>
<span class=normal><a href=#__codelineno-7-19>19</a></span>
<span class=normal><a href=#__codelineno-7-20>20</a></span>
<span class=normal><a href=#__codelineno-7-21>21</a></span>
<span class=normal><a href=#__codelineno-7-22>22</a></span>
<span class=normal><a href=#__codelineno-7-23>23</a></span>
<span class=normal><a href=#__codelineno-7-24>24</a></span>
<span class=normal><a href=#__codelineno-7-25>25</a></span>
<span class=normal><a href=#__codelineno-7-26>26</a></span>
<span class=normal><a href=#__codelineno-7-27>27</a></span>
<span class=normal><a href=#__codelineno-7-28>28</a></span>
<span class=normal><a href=#__codelineno-7-29>29</a></span>
<span class=normal><a href=#__codelineno-7-30>30</a></span>
<span class=normal><a href=#__codelineno-7-31>31</a></span>
<span class=normal><a href=#__codelineno-7-32>32</a></span>
<span class=normal><a href=#__codelineno-7-33>33</a></span>
<span class=normal><a href=#__codelineno-7-34>34</a></span>
<span class=normal><a href=#__codelineno-7-35>35</a></span>
<span class=normal><a href=#__codelineno-7-36>36</a></span>
<span class=normal><a href=#__codelineno-7-37>37</a></span>
<span class=normal><a href=#__codelineno-7-38>38</a></span>
<span class=normal><a href=#__codelineno-7-39>39</a></span>
<span class=normal><a href=#__codelineno-7-40>40</a></span>
<span class=normal><a href=#__codelineno-7-41>41</a></span>
<span class=normal><a href=#__codelineno-7-42>42</a></span>
<span class=normal><a href=#__codelineno-7-43>43</a></span>
<span class=normal><a href=#__codelineno-7-44>44</a></span>
<span class=normal><a href=#__codelineno-7-45>45</a></span>
<span class=normal><a href=#__codelineno-7-46>46</a></span>
<span class=normal><a href=#__codelineno-7-47>47</a></span>
<span class=normal><a href=#__codelineno-7-48>48</a></span>
<span class=normal><a href=#__codelineno-7-49>49</a></span>
<span class=normal><a href=#__codelineno-7-50>50</a></span>
<span class=normal><a href=#__codelineno-7-51>51</a></span>
<span class=normal><a href=#__codelineno-7-52>52</a></span>
<span class=normal><a href=#__codelineno-7-53>53</a></span>
<span class=normal><a href=#__codelineno-7-54>54</a></span>
<span class=normal><a href=#__codelineno-7-55>55</a></span>
<span class=normal><a href=#__codelineno-7-56>56</a></span>
<span class=normal><a href=#__codelineno-7-57>57</a></span>
<span class=normal><a href=#__codelineno-7-58>58</a></span>
<span class=normal><a href=#__codelineno-7-59>59</a></span>
<span class=normal><a href=#__codelineno-7-60>60</a></span>
<span class=normal><a href=#__codelineno-7-61>61</a></span>
<span class=normal><a href=#__codelineno-7-62>62</a></span>
<span class=normal><a href=#__codelineno-7-63>63</a></span>
<span class=normal><a href=#__codelineno-7-64>64</a></span>
<span class=normal><a href=#__codelineno-7-65>65</a></span>
<span class=normal><a href=#__codelineno-7-66>66</a></span>
<span class=normal><a href=#__codelineno-7-67>67</a></span>
<span class=normal><a href=#__codelineno-7-68>68</a></span>
<span class=normal><a href=#__codelineno-7-69>69</a></span>
<span class=normal><a href=#__codelineno-7-70>70</a></span>
<span class=normal><a href=#__codelineno-7-71>71</a></span>
<span class=normal><a href=#__codelineno-7-72>72</a></span>
<span class=normal><a href=#__codelineno-7-73>73</a></span>
<span class=normal><a href=#__codelineno-7-74>74</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1></a><span class=k>use</span><span class=w> </span><span class=n>nalgebra</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>na</span><span class=p>;</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2></a>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4></a><span class=w>    </span><span class=c1>// Define orbital elements in degrees</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5></a><span class=w>    </span><span class=c1>// LEO satellite: 500 km altitude, sun-synchronous orbit</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>oe</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>SVector</span><span class=p>::</span><span class=o>&lt;</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=o>&gt;</span><span class=p>::</span><span class=n>new</span><span class=p>(</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7></a><span class=w>        </span><span class=n>bh</span><span class=p>::</span><span class=n>R_EARTH</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>500e3</span><span class=p>,</span><span class=w>  </span><span class=c1>// Semi-major axis (m)</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8></a><span class=w>        </span><span class=mf>0.01</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Eccentricity</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9></a><span class=w>        </span><span class=mf>97.8</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Inclination (deg)</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10></a><span class=w>        </span><span class=mf>15.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Right ascension of ascending node (deg)</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11></a><span class=w>        </span><span class=mf>30.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Argument of periapsis (deg)</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12></a><span class=w>        </span><span class=mf>45.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Mean anomaly (deg)</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14></a>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Orbital elements (degrees):&quot;</span><span class=p>);</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  a    = {:.3} m = {:.1} km altitude&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=p>(</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>R_EARTH</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>1e3</span><span class=p>);</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  e    = {:.4}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  i    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Ω    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>3</span><span class=p>]);</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  ω    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>4</span><span class=p>]);</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  M    = {:.4}°</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>5</span><span class=p>]);</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22></a><span class=w>    </span><span class=c1>// Orbital elements (degrees):</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23></a><span class=w>    </span><span class=c1>//   a    = 6878136.300 m = 500.0 km altitude</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24></a><span class=w>    </span><span class=c1>//   e    = 0.0100</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25></a><span class=w>    </span><span class=c1>//   i    = 97.8000°</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26></a><span class=w>    </span><span class=c1>//   Ω    = 15.0000°</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27></a><span class=w>    </span><span class=c1>//   ω    = 30.0000°</span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28></a><span class=w>    </span><span class=c1>//   M    = 45.0000°</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29></a>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30></a><span class=w>    </span><span class=c1>// Convert to EME2000 state, then transform to GCRF</span>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31></a><span class=w>    </span><span class=c1>// (Starting in EME2000 to get GCRF representation)</span>
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_eme2000_orig</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>AngleFormat</span><span class=p>::</span><span class=n>Degrees</span><span class=p>);</span>
</span><span id=__span-7-33><a id=__codelineno-7-33 name=__codelineno-7-33></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_gcrf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_eme2000_to_gcrf</span><span class=p>(</span><span class=n>state_eme2000_orig</span><span class=p>);</span>
</span><span id=__span-7-34><a id=__codelineno-7-34 name=__codelineno-7-34></a>
</span><span id=__span-7-35><a id=__codelineno-7-35 name=__codelineno-7-35></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;GCRF state vector:&quot;</span><span class=p>);</span>
</span><span id=__span-7-36><a id=__codelineno-7-36 name=__codelineno-7-36></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Position: [{:.3}, {:.3}, {:.3}] m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-7-37><a id=__codelineno-7-37 name=__codelineno-7-37></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Velocity: [{:.6}, {:.6}, {:.6}] m/s</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>5</span><span class=p>]);</span>
</span><span id=__span-7-38><a id=__codelineno-7-38 name=__codelineno-7-38></a><span class=w>    </span><span class=c1>// GCRF state vector:    </span>
</span><span id=__span-7-39><a id=__codelineno-7-39 name=__codelineno-7-39></a><span class=w>    </span><span class=c1>//   Position: [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-7-40><a id=__codelineno-7-40 name=__codelineno-7-40></a><span class=w>    </span><span class=c1>//   Velocity: [-7098.379734, -2173.344867, 1913.333385] m/s</span>
</span><span id=__span-7-41><a id=__codelineno-7-41 name=__codelineno-7-41></a>
</span><span id=__span-7-42><a id=__codelineno-7-42 name=__codelineno-7-42></a><span class=w>    </span><span class=c1>// Transform to EME2000 (constant transformation, no epoch needed)</span>
</span><span id=__span-7-43><a id=__codelineno-7-43 name=__codelineno-7-43></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_gcrf_to_eme2000</span><span class=p>(</span><span class=n>state_gcrf</span><span class=p>);</span>
</span><span id=__span-7-44><a id=__codelineno-7-44 name=__codelineno-7-44></a>
</span><span id=__span-7-45><a id=__codelineno-7-45 name=__codelineno-7-45></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;EME2000 state vector:&quot;</span><span class=p>);</span>
</span><span id=__span-7-46><a id=__codelineno-7-46 name=__codelineno-7-46></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Position: [{:.3}, {:.3}, {:.3}] m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-7-47><a id=__codelineno-7-47 name=__codelineno-7-47></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Velocity: [{:.6}, {:.6}, {:.6}] m/s</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span><span class=w> </span><span class=n>state_eme2000</span><span class=p>[</span><span class=mi>5</span><span class=p>]);</span>
</span><span id=__span-7-48><a id=__codelineno-7-48 name=__codelineno-7-48></a><span class=w>    </span><span class=c1>// EME2000 state vector:</span>
</span><span id=__span-7-49><a id=__codelineno-7-49 name=__codelineno-7-49></a><span class=w>    </span><span class=c1>//   Position: [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-7-50><a id=__codelineno-7-50 name=__codelineno-7-50></a><span class=w>    </span><span class=c1>//   Velocity: [-7098.379734, -2173.344867, 1913.333385] m/s</span>
</span><span id=__span-7-51><a id=__codelineno-7-51 name=__codelineno-7-51></a>
</span><span id=__span-7-52><a id=__codelineno-7-52 name=__codelineno-7-52></a><span class=w>    </span><span class=c1>// Transform back to GCRF to verify round-trip</span>
</span><span id=__span-7-53><a id=__codelineno-7-53 name=__codelineno-7-53></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_eme2000_to_gcrf</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>);</span>
</span><span id=__span-7-54><a id=__codelineno-7-54 name=__codelineno-7-54></a>
</span><span id=__span-7-55><a id=__codelineno-7-55 name=__codelineno-7-55></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;GCRF state vector (transformed from EME2000):&quot;</span><span class=p>);</span>
</span><span id=__span-7-56><a id=__codelineno-7-56 name=__codelineno-7-56></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Position: [{:.3}, {:.3}, {:.3}] m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-7-57><a id=__codelineno-7-57 name=__codelineno-7-57></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Velocity: [{:.6}, {:.6}, {:.6}] m/s</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>5</span><span class=p>]);</span>
</span><span id=__span-7-58><a id=__codelineno-7-58 name=__codelineno-7-58></a><span class=w>    </span><span class=c1>// GCRF state vector (transformed from EME2000):</span>
</span><span id=__span-7-59><a id=__codelineno-7-59 name=__codelineno-7-59></a><span class=w>    </span><span class=c1>//   Position: [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-7-60><a id=__codelineno-7-60 name=__codelineno-7-60></a><span class=w>    </span><span class=c1>//   Velocity: [-7098.379734, -2173.344867, 1913.333385] m/s</span>
</span><span id=__span-7-61><a id=__codelineno-7-61 name=__codelineno-7-61></a>
</span><span id=__span-7-62><a id=__codelineno-7-62 name=__codelineno-7-62></a><span class=w>    </span><span class=c1>// Verify round-trip transformation</span>
</span><span id=__span-7-63><a id=__codelineno-7-63 name=__codelineno-7-63></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>diff_pos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span><span class=w> </span><span class=o>-</span>
</span><span id=__span-7-64><a id=__codelineno-7-64 name=__codelineno-7-64></a><span class=w>                    </span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>2</span><span class=p>])).</span><span class=n>norm</span><span class=p>();</span>
</span><span id=__span-7-65><a id=__codelineno-7-65 name=__codelineno-7-65></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>diff_vel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>5</span><span class=p>])</span><span class=w> </span><span class=o>-</span>
</span><span id=__span-7-66><a id=__codelineno-7-66 name=__codelineno-7-66></a><span class=w>                    </span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf_back</span><span class=p>[</span><span class=mi>5</span><span class=p>])).</span><span class=n>norm</span><span class=p>();</span>
</span><span id=__span-7-67><a id=__codelineno-7-67 name=__codelineno-7-67></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Round-trip error:&quot;</span><span class=p>);</span>
</span><span id=__span-7-68><a id=__codelineno-7-68 name=__codelineno-7-68></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Position: {:.6e} m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>diff_pos</span><span class=p>);</span>
</span><span id=__span-7-69><a id=__codelineno-7-69 name=__codelineno-7-69></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Velocity: {:.6e} m/s&quot;</span><span class=p>,</span><span class=w> </span><span class=n>diff_vel</span><span class=p>);</span>
</span><span id=__span-7-70><a id=__codelineno-7-70 name=__codelineno-7-70></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>Note: Transformation is constant (time-independent, no epoch needed)&quot;</span><span class=p>);</span>
</span><span id=__span-7-71><a id=__codelineno-7-71 name=__codelineno-7-71></a><span class=w>    </span><span class=c1>// Round-trip error:</span>
</span><span id=__span-7-72><a id=__codelineno-7-72 name=__codelineno-7-72></a><span class=w>    </span><span class=c1>//   Position: 3.863884e-08 m</span>
</span><span id=__span-7-73><a id=__codelineno-7-73 name=__codelineno-7-73></a><span class=w>    </span><span class=c1>//   Velocity: 3.876304e-11 m/s</span>
</span><span id=__span-7-74><a id=__codelineno-7-74 name=__codelineno-7-74></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <h3 id=position-vector_1>Position Vector<a class=headerlink href=#position-vector_1 title="Permanent link">&para;</a></h3> <p>Transform a position vector from GCRF to EME2000:</p> <div class="tabbed-set tabbed-alternate" data-tabs=5:2><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><input id=__tabbed_5_2 name=__tabbed_5 type=radio><div class=tabbed-labels><label for=__tabbed_5_1>Python</label><label for=__tabbed_5_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-8-1> 1</a></span>
<span class=normal><a href=#__codelineno-8-2> 2</a></span>
<span class=normal><a href=#__codelineno-8-3> 3</a></span>
<span class=normal><a href=#__codelineno-8-4> 4</a></span>
<span class=normal><a href=#__codelineno-8-5> 5</a></span>
<span class=normal><a href=#__codelineno-8-6> 6</a></span>
<span class=normal><a href=#__codelineno-8-7> 7</a></span>
<span class=normal><a href=#__codelineno-8-8> 8</a></span>
<span class=normal><a href=#__codelineno-8-9> 9</a></span>
<span class=normal><a href=#__codelineno-8-10>10</a></span>
<span class=normal><a href=#__codelineno-8-11>11</a></span>
<span class=normal><a href=#__codelineno-8-12>12</a></span>
<span class=normal><a href=#__codelineno-8-13>13</a></span>
<span class=normal><a href=#__codelineno-8-14>14</a></span>
<span class=normal><a href=#__codelineno-8-15>15</a></span>
<span class=normal><a href=#__codelineno-8-16>16</a></span>
<span class=normal><a href=#__codelineno-8-17>17</a></span>
<span class=normal><a href=#__codelineno-8-18>18</a></span>
<span class=normal><a href=#__codelineno-8-19>19</a></span>
<span class=normal><a href=#__codelineno-8-20>20</a></span>
<span class=normal><a href=#__codelineno-8-21>21</a></span>
<span class=normal><a href=#__codelineno-8-22>22</a></span>
<span class=normal><a href=#__codelineno-8-23>23</a></span>
<span class=normal><a href=#__codelineno-8-24>24</a></span>
<span class=normal><a href=#__codelineno-8-25>25</a></span>
<span class=normal><a href=#__codelineno-8-26>26</a></span>
<span class=normal><a href=#__codelineno-8-27>27</a></span>
<span class=normal><a href=#__codelineno-8-28>28</a></span>
<span class=normal><a href=#__codelineno-8-29>29</a></span>
<span class=normal><a href=#__codelineno-8-30>30</a></span>
<span class=normal><a href=#__codelineno-8-31>31</a></span>
<span class=normal><a href=#__codelineno-8-32>32</a></span>
<span class=normal><a href=#__codelineno-8-33>33</a></span>
<span class=normal><a href=#__codelineno-8-34>34</a></span>
<span class=normal><a href=#__codelineno-8-35>35</a></span>
<span class=normal><a href=#__codelineno-8-36>36</a></span>
<span class=normal><a href=#__codelineno-8-37>37</a></span>
<span class=normal><a href=#__codelineno-8-38>38</a></span>
<span class=normal><a href=#__codelineno-8-39>39</a></span>
<span class=normal><a href=#__codelineno-8-40>40</a></span>
<span class=normal><a href=#__codelineno-8-41>41</a></span>
<span class=normal><a href=#__codelineno-8-42>42</a></span>
<span class=normal><a href=#__codelineno-8-43>43</a></span>
<span class=normal><a href=#__codelineno-8-44>44</a></span>
<span class=normal><a href=#__codelineno-8-45>45</a></span>
<span class=normal><a href=#__codelineno-8-46>46</a></span>
<span class=normal><a href=#__codelineno-8-47>47</a></span>
<span class=normal><a href=#__codelineno-8-48>48</a></span>
<span class=normal><a href=#__codelineno-8-49>49</a></span>
<span class=normal><a href=#__codelineno-8-50>50</a></span>
<span class=normal><a href=#__codelineno-8-51>51</a></span>
<span class=normal><a href=#__codelineno-8-52>52</a></span>
<span class=normal><a href=#__codelineno-8-53>53</a></span>
<span class=normal><a href=#__codelineno-8-54>54</a></span>
<span class=normal><a href=#__codelineno-8-55>55</a></span>
<span class=normal><a href=#__codelineno-8-56>56</a></span>
<span class=normal><a href=#__codelineno-8-57>57</a></span>
<span class=normal><a href=#__codelineno-8-58>58</a></span>
<span class=normal><a href=#__codelineno-8-59>59</a></span>
<span class=normal><a href=#__codelineno-8-60>60</a></span>
<span class=normal><a href=#__codelineno-8-61>61</a></span>
<span class=normal><a href=#__codelineno-8-62>62</a></span>
<span class=normal><a href=#__codelineno-8-63>63</a></span>
<span class=normal><a href=#__codelineno-8-64>64</a></span>
<span class=normal><a href=#__codelineno-8-65>65</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4></a><span class=c1># Define orbital elements in degrees</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5></a><span class=c1># LEO satellite: 500 km altitude, sun-synchronous orbit</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6></a><span class=n>oe</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7></a>    <span class=p>[</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8></a>        <span class=n>bh</span><span class=o>.</span><span class=n>R_EARTH</span> <span class=o>+</span> <span class=mf>500e3</span><span class=p>,</span>  <span class=c1># Semi-major axis (m)</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9></a>        <span class=mf>0.01</span><span class=p>,</span>  <span class=c1># Eccentricity</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10></a>        <span class=mf>97.8</span><span class=p>,</span>  <span class=c1># Inclination (deg)</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11></a>        <span class=mf>15.0</span><span class=p>,</span>  <span class=c1># Right ascension of ascending node (deg)</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12></a>        <span class=mf>30.0</span><span class=p>,</span>  <span class=c1># Argument of periapsis (deg)</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13></a>        <span class=mf>45.0</span><span class=p>,</span>  <span class=c1># Mean anomaly (deg)</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14></a>    <span class=p>]</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15></a><span class=p>)</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16></a>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Orbital elements (degrees):&quot;</span><span class=p>)</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  a    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> m = </span><span class=si>{</span><span class=p>(</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>bh</span><span class=o>.</span><span class=n>R_EARTH</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>1e3</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> km altitude&quot;</span><span class=p>)</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  e    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  i    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Ω    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ω    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°&quot;</span><span class=p>)</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  M    = </span><span class=si>{</span><span class=n>oe</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>°</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24></a><span class=c1># Orbital elements (degrees):</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25></a><span class=c1>#   a    = 6878136.300 m = 500.0 km altitude</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26></a><span class=c1>#   e    = 0.0100</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27></a><span class=c1>#   i    = 97.8000°</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28></a><span class=c1>#   Ω    = 15.0000°</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29></a><span class=c1>#   ω    = 30.0000°</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30></a><span class=c1>#   M    = 45.0000°</span>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31></a>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32></a><span class=c1># Convert to EME2000 state, transform to GCRF, and extract position</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33></a><span class=n>state_eme2000</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span> <span class=n>bh</span><span class=o>.</span><span class=n>AngleFormat</span><span class=o>.</span><span class=n>DEGREES</span><span class=p>)</span>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34></a><span class=n>state_gcrf</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_eme2000_to_gcrf</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>)</span>
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35></a><span class=n>pos_gcrf</span> <span class=o>=</span> <span class=n>state_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span>
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36></a>
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Position in GCRF:&quot;</span><span class=p>)</span>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39></a><span class=c1># Position in GCRF:</span>
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40></a><span class=c1>#   [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-8-41><a id=__codelineno-8-41 name=__codelineno-8-41></a>
</span><span id=__span-8-42><a id=__codelineno-8-42 name=__codelineno-8-42></a><span class=c1># Transform to EME2000 (constant transformation, no epoch needed)</span>
</span><span id=__span-8-43><a id=__codelineno-8-43 name=__codelineno-8-43></a><span class=n>pos_eme2000</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>position_gcrf_to_eme2000</span><span class=p>(</span><span class=n>pos_gcrf</span><span class=p>)</span>
</span><span id=__span-8-44><a id=__codelineno-8-44 name=__codelineno-8-44></a>
</span><span id=__span-8-45><a id=__codelineno-8-45 name=__codelineno-8-45></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Position in EME2000:&quot;</span><span class=p>)</span>
</span><span id=__span-8-46><a id=__codelineno-8-46 name=__codelineno-8-46></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-47><a id=__codelineno-8-47 name=__codelineno-8-47></a><span class=c1># Position in EME2000:</span>
</span><span id=__span-8-48><a id=__codelineno-8-48 name=__codelineno-8-48></a><span class=c1>#   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-8-49><a id=__codelineno-8-49 name=__codelineno-8-49></a>
</span><span id=__span-8-50><a id=__codelineno-8-50 name=__codelineno-8-50></a><span class=c1># Verify using rotation matrix</span>
</span><span id=__span-8-51><a id=__codelineno-8-51 name=__codelineno-8-51></a><span class=n>R_gcrf_to_eme2000</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>rotation_gcrf_to_eme2000</span><span class=p>()</span>
</span><span id=__span-8-52><a id=__codelineno-8-52 name=__codelineno-8-52></a><span class=n>pos_eme2000_matrix</span> <span class=o>=</span> <span class=n>R_gcrf_to_eme2000</span> <span class=o>@</span> <span class=n>pos_gcrf</span>
</span><span id=__span-8-53><a id=__codelineno-8-53 name=__codelineno-8-53></a>
</span><span id=__span-8-54><a id=__codelineno-8-54 name=__codelineno-8-54></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Position in EME2000 (using rotation matrix):&quot;</span><span class=p>)</span>
</span><span id=__span-8-55><a id=__codelineno-8-55 name=__codelineno-8-55></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-8-56><a id=__codelineno-8-56 name=__codelineno-8-56></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-8-57><a id=__codelineno-8-57 name=__codelineno-8-57></a><span class=p>)</span>
</span><span id=__span-8-58><a id=__codelineno-8-58 name=__codelineno-8-58></a><span class=c1># Position in EME2000 (using rotation matrix):</span>
</span><span id=__span-8-59><a id=__codelineno-8-59 name=__codelineno-8-59></a><span class=c1>#   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-8-60><a id=__codelineno-8-60 name=__codelineno-8-60></a>
</span><span id=__span-8-61><a id=__codelineno-8-61 name=__codelineno-8-61></a><span class=c1># Verify both methods give same result</span>
</span><span id=__span-8-62><a id=__codelineno-8-62 name=__codelineno-8-62></a><span class=n>diff</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>pos_eme2000</span> <span class=o>-</span> <span class=n>pos_eme2000_matrix</span><span class=p>)</span>
</span><span id=__span-8-63><a id=__codelineno-8-63 name=__codelineno-8-63></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Difference between methods: </span><span class=si>{</span><span class=n>diff</span><span class=si>:</span><span class=s2>.6e</span><span class=si>}</span><span class=s2> m&quot;</span><span class=p>)</span>
</span><span id=__span-8-64><a id=__codelineno-8-64 name=__codelineno-8-64></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Note: Transformation is constant (time-independent, no epoch needed)&quot;</span><span class=p>)</span>
</span><span id=__span-8-65><a id=__codelineno-8-65 name=__codelineno-8-65></a><span class=c1># Difference between methods: 0.000000e+00 m</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-9-1> 1</a></span>
<span class=normal><a href=#__codelineno-9-2> 2</a></span>
<span class=normal><a href=#__codelineno-9-3> 3</a></span>
<span class=normal><a href=#__codelineno-9-4> 4</a></span>
<span class=normal><a href=#__codelineno-9-5> 5</a></span>
<span class=normal><a href=#__codelineno-9-6> 6</a></span>
<span class=normal><a href=#__codelineno-9-7> 7</a></span>
<span class=normal><a href=#__codelineno-9-8> 8</a></span>
<span class=normal><a href=#__codelineno-9-9> 9</a></span>
<span class=normal><a href=#__codelineno-9-10>10</a></span>
<span class=normal><a href=#__codelineno-9-11>11</a></span>
<span class=normal><a href=#__codelineno-9-12>12</a></span>
<span class=normal><a href=#__codelineno-9-13>13</a></span>
<span class=normal><a href=#__codelineno-9-14>14</a></span>
<span class=normal><a href=#__codelineno-9-15>15</a></span>
<span class=normal><a href=#__codelineno-9-16>16</a></span>
<span class=normal><a href=#__codelineno-9-17>17</a></span>
<span class=normal><a href=#__codelineno-9-18>18</a></span>
<span class=normal><a href=#__codelineno-9-19>19</a></span>
<span class=normal><a href=#__codelineno-9-20>20</a></span>
<span class=normal><a href=#__codelineno-9-21>21</a></span>
<span class=normal><a href=#__codelineno-9-22>22</a></span>
<span class=normal><a href=#__codelineno-9-23>23</a></span>
<span class=normal><a href=#__codelineno-9-24>24</a></span>
<span class=normal><a href=#__codelineno-9-25>25</a></span>
<span class=normal><a href=#__codelineno-9-26>26</a></span>
<span class=normal><a href=#__codelineno-9-27>27</a></span>
<span class=normal><a href=#__codelineno-9-28>28</a></span>
<span class=normal><a href=#__codelineno-9-29>29</a></span>
<span class=normal><a href=#__codelineno-9-30>30</a></span>
<span class=normal><a href=#__codelineno-9-31>31</a></span>
<span class=normal><a href=#__codelineno-9-32>32</a></span>
<span class=normal><a href=#__codelineno-9-33>33</a></span>
<span class=normal><a href=#__codelineno-9-34>34</a></span>
<span class=normal><a href=#__codelineno-9-35>35</a></span>
<span class=normal><a href=#__codelineno-9-36>36</a></span>
<span class=normal><a href=#__codelineno-9-37>37</a></span>
<span class=normal><a href=#__codelineno-9-38>38</a></span>
<span class=normal><a href=#__codelineno-9-39>39</a></span>
<span class=normal><a href=#__codelineno-9-40>40</a></span>
<span class=normal><a href=#__codelineno-9-41>41</a></span>
<span class=normal><a href=#__codelineno-9-42>42</a></span>
<span class=normal><a href=#__codelineno-9-43>43</a></span>
<span class=normal><a href=#__codelineno-9-44>44</a></span>
<span class=normal><a href=#__codelineno-9-45>45</a></span>
<span class=normal><a href=#__codelineno-9-46>46</a></span>
<span class=normal><a href=#__codelineno-9-47>47</a></span>
<span class=normal><a href=#__codelineno-9-48>48</a></span>
<span class=normal><a href=#__codelineno-9-49>49</a></span>
<span class=normal><a href=#__codelineno-9-50>50</a></span>
<span class=normal><a href=#__codelineno-9-51>51</a></span>
<span class=normal><a href=#__codelineno-9-52>52</a></span>
<span class=normal><a href=#__codelineno-9-53>53</a></span>
<span class=normal><a href=#__codelineno-9-54>54</a></span>
<span class=normal><a href=#__codelineno-9-55>55</a></span>
<span class=normal><a href=#__codelineno-9-56>56</a></span>
<span class=normal><a href=#__codelineno-9-57>57</a></span>
<span class=normal><a href=#__codelineno-9-58>58</a></span>
<span class=normal><a href=#__codelineno-9-59>59</a></span>
<span class=normal><a href=#__codelineno-9-60>60</a></span>
<span class=normal><a href=#__codelineno-9-61>61</a></span>
<span class=normal><a href=#__codelineno-9-62>62</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1></a><span class=k>use</span><span class=w> </span><span class=n>nalgebra</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>na</span><span class=p>;</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2></a>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4></a><span class=w>    </span><span class=c1>// Define orbital elements in degrees</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5></a><span class=w>    </span><span class=c1>// LEO satellite: 500 km altitude, sun-synchronous orbit</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>oe</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>SVector</span><span class=p>::</span><span class=o>&lt;</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=o>&gt;</span><span class=p>::</span><span class=n>new</span><span class=p>(</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7></a><span class=w>        </span><span class=n>bh</span><span class=p>::</span><span class=n>R_EARTH</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>500e3</span><span class=p>,</span><span class=w>  </span><span class=c1>// Semi-major axis (m)</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8></a><span class=w>        </span><span class=mf>0.01</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Eccentricity</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9></a><span class=w>        </span><span class=mf>97.8</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Inclination (deg)</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10></a><span class=w>        </span><span class=mf>15.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Right ascension of ascending node (deg)</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11></a><span class=w>        </span><span class=mf>30.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Argument of periapsis (deg)</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12></a><span class=w>        </span><span class=mf>45.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Mean anomaly (deg)</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14></a>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Orbital elements (degrees):&quot;</span><span class=p>);</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  a    = {:.3} m = {:.1} km altitude&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=p>(</span><span class=n>oe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>R_EARTH</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>1e3</span><span class=p>);</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  e    = {:.4}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  i    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Ω    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>3</span><span class=p>]);</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  ω    = {:.4}°&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>4</span><span class=p>]);</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  M    = {:.4}°</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>oe</span><span class=p>[</span><span class=mi>5</span><span class=p>]);</span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22></a><span class=w>    </span><span class=c1>// Orbital elements (degrees):</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23></a><span class=w>    </span><span class=c1>//   a    = 6878136.300 m = 500.0 km altitude</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24></a><span class=w>    </span><span class=c1>//   e    = 0.0100</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25></a><span class=w>    </span><span class=c1>//   i    = 97.8000°</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26></a><span class=w>    </span><span class=c1>//   Ω    = 15.0000°</span>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27></a><span class=w>    </span><span class=c1>//   ω    = 30.0000°</span>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28></a><span class=w>    </span><span class=c1>//   M    = 45.0000°</span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29></a>
</span><span id=__span-9-30><a id=__codelineno-9-30 name=__codelineno-9-30></a><span class=w>    </span><span class=c1>// Convert to EME2000 state, transform to GCRF, and extract position</span>
</span><span id=__span-9-31><a id=__codelineno-9-31 name=__codelineno-9-31></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>AngleFormat</span><span class=p>::</span><span class=n>Degrees</span><span class=p>);</span>
</span><span id=__span-9-32><a id=__codelineno-9-32 name=__codelineno-9-32></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_gcrf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_eme2000_to_gcrf</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>);</span>
</span><span id=__span-9-33><a id=__codelineno-9-33 name=__codelineno-9-33></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_gcrf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-9-34><a id=__codelineno-9-34 name=__codelineno-9-34></a>
</span><span id=__span-9-35><a id=__codelineno-9-35 name=__codelineno-9-35></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Position in GCRF:&quot;</span><span class=p>);</span>
</span><span id=__span-9-36><a id=__codelineno-9-36 name=__codelineno-9-36></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-9-37><a id=__codelineno-9-37 name=__codelineno-9-37></a><span class=w>    </span><span class=c1>// Position in GCRF:</span>
</span><span id=__span-9-38><a id=__codelineno-9-38 name=__codelineno-9-38></a><span class=w>    </span><span class=c1>//   [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-9-39><a id=__codelineno-9-39 name=__codelineno-9-39></a>
</span><span id=__span-9-40><a id=__codelineno-9-40 name=__codelineno-9-40></a><span class=w>    </span><span class=c1>// Transform to EME2000 (constant transformation, no epoch needed)</span>
</span><span id=__span-9-41><a id=__codelineno-9-41 name=__codelineno-9-41></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>position_gcrf_to_eme2000</span><span class=p>(</span><span class=n>pos_gcrf</span><span class=p>);</span>
</span><span id=__span-9-42><a id=__codelineno-9-42 name=__codelineno-9-42></a>
</span><span id=__span-9-43><a id=__codelineno-9-43 name=__codelineno-9-43></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Position in EME2000:&quot;</span><span class=p>);</span>
</span><span id=__span-9-44><a id=__codelineno-9-44 name=__codelineno-9-44></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-9-45><a id=__codelineno-9-45 name=__codelineno-9-45></a><span class=w>    </span><span class=c1>// Position in EME2000:</span>
</span><span id=__span-9-46><a id=__codelineno-9-46 name=__codelineno-9-46></a><span class=w>    </span><span class=c1>//   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-9-47><a id=__codelineno-9-47 name=__codelineno-9-47></a>
</span><span id=__span-9-48><a id=__codelineno-9-48 name=__codelineno-9-48></a><span class=w>    </span><span class=c1>// Verify using rotation matrix</span>
</span><span id=__span-9-49><a id=__codelineno-9-49 name=__codelineno-9-49></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>rotation_gcrf_to_eme2000</span><span class=p>();</span>
</span><span id=__span-9-50><a id=__codelineno-9-50 name=__codelineno-9-50></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_eme2000_matrix</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>;</span>
</span><span id=__span-9-51><a id=__codelineno-9-51 name=__codelineno-9-51></a>
</span><span id=__span-9-52><a id=__codelineno-9-52 name=__codelineno-9-52></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Position in EME2000 (using rotation matrix):&quot;</span><span class=p>);</span>
</span><span id=__span-9-53><a id=__codelineno-9-53 name=__codelineno-9-53></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-9-54><a id=__codelineno-9-54 name=__codelineno-9-54></a><span class=w>    </span><span class=c1>// Position in EME2000 (using rotation matrix):</span>
</span><span id=__span-9-55><a id=__codelineno-9-55 name=__codelineno-9-55></a><span class=w>    </span><span class=c1>//   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-9-56><a id=__codelineno-9-56 name=__codelineno-9-56></a>
</span><span id=__span-9-57><a id=__codelineno-9-57 name=__codelineno-9-57></a><span class=w>    </span><span class=c1>// Verify both methods give same result</span>
</span><span id=__span-9-58><a id=__codelineno-9-58 name=__codelineno-9-58></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>diff</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>pos_eme2000</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>pos_eme2000_matrix</span><span class=p>).</span><span class=n>norm</span><span class=p>();</span>
</span><span id=__span-9-59><a id=__codelineno-9-59 name=__codelineno-9-59></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Difference between methods: {:.6e} m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>diff</span><span class=p>);</span>
</span><span id=__span-9-60><a id=__codelineno-9-60 name=__codelineno-9-60></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>Note: Transformation is constant (time-independent, no epoch needed)&quot;</span><span class=p>);</span>
</span><span id=__span-9-61><a id=__codelineno-9-61 name=__codelineno-9-61></a><span class=w>    </span><span class=c1>// Difference between methods: 0.000000e+00 m</span>
</span><span id=__span-9-62><a id=__codelineno-9-62 name=__codelineno-9-62></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <h3 id=rotation-matrix_1>Rotation Matrix<a class=headerlink href=#rotation-matrix_1 title="Permanent link">&para;</a></h3> <p>Get the constant rotation matrix from GCRF to EME2000:</p> <div class="tabbed-set tabbed-alternate" data-tabs=6:2><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><input id=__tabbed_6_2 name=__tabbed_6 type=radio><div class=tabbed-labels><label for=__tabbed_6_1>Python</label><label for=__tabbed_6_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-10-1> 1</a></span>
<span class=normal><a href=#__codelineno-10-2> 2</a></span>
<span class=normal><a href=#__codelineno-10-3> 3</a></span>
<span class=normal><a href=#__codelineno-10-4> 4</a></span>
<span class=normal><a href=#__codelineno-10-5> 5</a></span>
<span class=normal><a href=#__codelineno-10-6> 6</a></span>
<span class=normal><a href=#__codelineno-10-7> 7</a></span>
<span class=normal><a href=#__codelineno-10-8> 8</a></span>
<span class=normal><a href=#__codelineno-10-9> 9</a></span>
<span class=normal><a href=#__codelineno-10-10>10</a></span>
<span class=normal><a href=#__codelineno-10-11>11</a></span>
<span class=normal><a href=#__codelineno-10-12>12</a></span>
<span class=normal><a href=#__codelineno-10-13>13</a></span>
<span class=normal><a href=#__codelineno-10-14>14</a></span>
<span class=normal><a href=#__codelineno-10-15>15</a></span>
<span class=normal><a href=#__codelineno-10-16>16</a></span>
<span class=normal><a href=#__codelineno-10-17>17</a></span>
<span class=normal><a href=#__codelineno-10-18>18</a></span>
<span class=normal><a href=#__codelineno-10-19>19</a></span>
<span class=normal><a href=#__codelineno-10-20>20</a></span>
<span class=normal><a href=#__codelineno-10-21>21</a></span>
<span class=normal><a href=#__codelineno-10-22>22</a></span>
<span class=normal><a href=#__codelineno-10-23>23</a></span>
<span class=normal><a href=#__codelineno-10-24>24</a></span>
<span class=normal><a href=#__codelineno-10-25>25</a></span>
<span class=normal><a href=#__codelineno-10-26>26</a></span>
<span class=normal><a href=#__codelineno-10-27>27</a></span>
<span class=normal><a href=#__codelineno-10-28>28</a></span>
<span class=normal><a href=#__codelineno-10-29>29</a></span>
<span class=normal><a href=#__codelineno-10-30>30</a></span>
<span class=normal><a href=#__codelineno-10-31>31</a></span>
<span class=normal><a href=#__codelineno-10-32>32</a></span>
<span class=normal><a href=#__codelineno-10-33>33</a></span>
<span class=normal><a href=#__codelineno-10-34>34</a></span>
<span class=normal><a href=#__codelineno-10-35>35</a></span>
<span class=normal><a href=#__codelineno-10-36>36</a></span>
<span class=normal><a href=#__codelineno-10-37>37</a></span>
<span class=normal><a href=#__codelineno-10-38>38</a></span>
<span class=normal><a href=#__codelineno-10-39>39</a></span>
<span class=normal><a href=#__codelineno-10-40>40</a></span>
<span class=normal><a href=#__codelineno-10-41>41</a></span>
<span class=normal><a href=#__codelineno-10-42>42</a></span>
<span class=normal><a href=#__codelineno-10-43>43</a></span>
<span class=normal><a href=#__codelineno-10-44>44</a></span>
<span class=normal><a href=#__codelineno-10-45>45</a></span>
<span class=normal><a href=#__codelineno-10-46>46</a></span>
<span class=normal><a href=#__codelineno-10-47>47</a></span>
<span class=normal><a href=#__codelineno-10-48>48</a></span>
<span class=normal><a href=#__codelineno-10-49>49</a></span>
<span class=normal><a href=#__codelineno-10-50>50</a></span>
<span class=normal><a href=#__codelineno-10-51>51</a></span>
<span class=normal><a href=#__codelineno-10-52>52</a></span>
<span class=normal><a href=#__codelineno-10-53>53</a></span>
<span class=normal><a href=#__codelineno-10-54>54</a></span>
<span class=normal><a href=#__codelineno-10-55>55</a></span>
<span class=normal><a href=#__codelineno-10-56>56</a></span>
<span class=normal><a href=#__codelineno-10-57>57</a></span>
<span class=normal><a href=#__codelineno-10-58>58</a></span>
<span class=normal><a href=#__codelineno-10-59>59</a></span>
<span class=normal><a href=#__codelineno-10-60>60</a></span>
<span class=normal><a href=#__codelineno-10-61>61</a></span>
<span class=normal><a href=#__codelineno-10-62>62</a></span>
<span class=normal><a href=#__codelineno-10-63>63</a></span>
<span class=normal><a href=#__codelineno-10-64>64</a></span>
<span class=normal><a href=#__codelineno-10-65>65</a></span>
<span class=normal><a href=#__codelineno-10-66>66</a></span>
<span class=normal><a href=#__codelineno-10-67>67</a></span>
<span class=normal><a href=#__codelineno-10-68>68</a></span>
<span class=normal><a href=#__codelineno-10-69>69</a></span>
<span class=normal><a href=#__codelineno-10-70>70</a></span>
<span class=normal><a href=#__codelineno-10-71>71</a></span>
<span class=normal><a href=#__codelineno-10-72>72</a></span>
<span class=normal><a href=#__codelineno-10-73>73</a></span>
<span class=normal><a href=#__codelineno-10-74>74</a></span>
<span class=normal><a href=#__codelineno-10-75>75</a></span>
<span class=normal><a href=#__codelineno-10-76>76</a></span>
<span class=normal><a href=#__codelineno-10-77>77</a></span>
<span class=normal><a href=#__codelineno-10-78>78</a></span>
<span class=normal><a href=#__codelineno-10-79>79</a></span>
<span class=normal><a href=#__codelineno-10-80>80</a></span>
<span class=normal><a href=#__codelineno-10-81>81</a></span>
<span class=normal><a href=#__codelineno-10-82>82</a></span>
<span class=normal><a href=#__codelineno-10-83>83</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3></a>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4></a><span class=c1># Get constant rotation matrix from GCRF to EME2000</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5></a><span class=n>R_gcrf_to_eme2000</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>rotation_gcrf_to_eme2000</span><span class=p>()</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6></a>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;GCRF to EME2000 rotation matrix:&quot;</span><span class=p>)</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>R_gcrf_to_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_gcrf_to_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_gcrf_to_eme2000</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>]&quot;</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10></a><span class=p>)</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>R_gcrf_to_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_gcrf_to_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_gcrf_to_eme2000</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>]&quot;</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13></a><span class=p>)</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>R_gcrf_to_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_gcrf_to_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R_gcrf_to_eme2000</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>]</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16></a><span class=p>)</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17></a><span class=c1># GCRF to EME2000 rotation matrix:</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18></a><span class=c1>#   [ 1.0000000000, -0.0000000708,  0.0000000806]</span>
</span><span id=__span-10-19><a id=__codelineno-10-19 name=__codelineno-10-19></a><span class=c1>#   [ 0.0000000708,  1.0000000000,  0.0000000331]</span>
</span><span id=__span-10-20><a id=__codelineno-10-20 name=__codelineno-10-20></a><span class=c1>#   [-0.0000000806, -0.0000000331,  1.0000000000]</span>
</span><span id=__span-10-21><a id=__codelineno-10-21 name=__codelineno-10-21></a>
</span><span id=__span-10-22><a id=__codelineno-10-22 name=__codelineno-10-22></a><span class=c1># Verify it&#39;s the transpose of EME2000 to GCRF rotation</span>
</span><span id=__span-10-23><a id=__codelineno-10-23 name=__codelineno-10-23></a><span class=n>R_eme2000_to_gcrf</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>rotation_eme2000_to_gcrf</span><span class=p>()</span>
</span><span id=__span-10-24><a id=__codelineno-10-24 name=__codelineno-10-24></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Verification: R_gcrf_to_eme2000 = R_eme2000_to_gcrf^T&quot;</span><span class=p>)</span>
</span><span id=__span-10-25><a id=__codelineno-10-25 name=__codelineno-10-25></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-10-26><a id=__codelineno-10-26 name=__codelineno-10-26></a>    <span class=sa>f</span><span class=s2>&quot;  Max difference: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>R_gcrf_to_eme2000</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>R_eme2000_to_gcrf</span><span class=o>.</span><span class=n>T</span><span class=p>))</span><span class=si>:</span><span class=s2>.2e</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-10-27><a id=__codelineno-10-27 name=__codelineno-10-27></a><span class=p>)</span>
</span><span id=__span-10-28><a id=__codelineno-10-28 name=__codelineno-10-28></a><span class=c1># Verification: R_gcrf_to_eme2000 = R_eme2000_to_gcrf^T</span>
</span><span id=__span-10-29><a id=__codelineno-10-29 name=__codelineno-10-29></a><span class=c1>#   Max difference: 0.00e+00</span>
</span><span id=__span-10-30><a id=__codelineno-10-30 name=__codelineno-10-30></a>
</span><span id=__span-10-31><a id=__codelineno-10-31 name=__codelineno-10-31></a><span class=c1># Verify matrix is orthonormal (rotation matrix property)</span>
</span><span id=__span-10-32><a id=__codelineno-10-32 name=__codelineno-10-32></a><span class=n>identity</span> <span class=o>=</span> <span class=n>R_gcrf_to_eme2000</span> <span class=o>@</span> <span class=n>R_gcrf_to_eme2000</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-10-33><a id=__codelineno-10-33 name=__codelineno-10-33></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Verify orthonormality (R @ R^T should be identity):&quot;</span><span class=p>)</span>
</span><span id=__span-10-34><a id=__codelineno-10-34 name=__codelineno-10-34></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Max deviation from identity: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>identity</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=mi>3</span><span class=p>)))</span><span class=si>:</span><span class=s2>.2e</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-10-35><a id=__codelineno-10-35 name=__codelineno-10-35></a><span class=c1># Verify orthonormality (R @ R^T should be identity):</span>
</span><span id=__span-10-36><a id=__codelineno-10-36 name=__codelineno-10-36></a><span class=c1>#   Max deviation from identity: 4.68e-15</span>
</span><span id=__span-10-37><a id=__codelineno-10-37 name=__codelineno-10-37></a>
</span><span id=__span-10-38><a id=__codelineno-10-38 name=__codelineno-10-38></a><span class=c1># Define orbital elements for testing transformation</span>
</span><span id=__span-10-39><a id=__codelineno-10-39 name=__codelineno-10-39></a><span class=n>oe</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-10-40><a id=__codelineno-10-40 name=__codelineno-10-40></a>    <span class=p>[</span>
</span><span id=__span-10-41><a id=__codelineno-10-41 name=__codelineno-10-41></a>        <span class=n>bh</span><span class=o>.</span><span class=n>R_EARTH</span> <span class=o>+</span> <span class=mf>500e3</span><span class=p>,</span>  <span class=c1># Semi-major axis (m)</span>
</span><span id=__span-10-42><a id=__codelineno-10-42 name=__codelineno-10-42></a>        <span class=mf>0.01</span><span class=p>,</span>  <span class=c1># Eccentricity</span>
</span><span id=__span-10-43><a id=__codelineno-10-43 name=__codelineno-10-43></a>        <span class=mf>97.8</span><span class=p>,</span>  <span class=c1># Inclination (deg)</span>
</span><span id=__span-10-44><a id=__codelineno-10-44 name=__codelineno-10-44></a>        <span class=mf>15.0</span><span class=p>,</span>  <span class=c1># RAAN (deg)</span>
</span><span id=__span-10-45><a id=__codelineno-10-45 name=__codelineno-10-45></a>        <span class=mf>30.0</span><span class=p>,</span>  <span class=c1># Argument of periapsis (deg)</span>
</span><span id=__span-10-46><a id=__codelineno-10-46 name=__codelineno-10-46></a>        <span class=mf>45.0</span><span class=p>,</span>  <span class=c1># Mean anomaly (deg)</span>
</span><span id=__span-10-47><a id=__codelineno-10-47 name=__codelineno-10-47></a>    <span class=p>]</span>
</span><span id=__span-10-48><a id=__codelineno-10-48 name=__codelineno-10-48></a><span class=p>)</span>
</span><span id=__span-10-49><a id=__codelineno-10-49 name=__codelineno-10-49></a>
</span><span id=__span-10-50><a id=__codelineno-10-50 name=__codelineno-10-50></a><span class=c1># Convert to EME2000, transform to GCRF, and extract position</span>
</span><span id=__span-10-51><a id=__codelineno-10-51 name=__codelineno-10-51></a><span class=n>state_eme2000</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span> <span class=n>bh</span><span class=o>.</span><span class=n>AngleFormat</span><span class=o>.</span><span class=n>DEGREES</span><span class=p>)</span>
</span><span id=__span-10-52><a id=__codelineno-10-52 name=__codelineno-10-52></a><span class=n>state_gcrf</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_eme2000_to_gcrf</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>)</span>
</span><span id=__span-10-53><a id=__codelineno-10-53 name=__codelineno-10-53></a><span class=n>pos_gcrf</span> <span class=o>=</span> <span class=n>state_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span>
</span><span id=__span-10-54><a id=__codelineno-10-54 name=__codelineno-10-54></a>
</span><span id=__span-10-55><a id=__codelineno-10-55 name=__codelineno-10-55></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Satellite position in GCRF:&quot;</span><span class=p>)</span>
</span><span id=__span-10-56><a id=__codelineno-10-56 name=__codelineno-10-56></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-10-57><a id=__codelineno-10-57 name=__codelineno-10-57></a><span class=c1># Satellite position in GCRF:</span>
</span><span id=__span-10-58><a id=__codelineno-10-58 name=__codelineno-10-58></a><span class=c1>#   [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-10-59><a id=__codelineno-10-59 name=__codelineno-10-59></a>
</span><span id=__span-10-60><a id=__codelineno-10-60 name=__codelineno-10-60></a><span class=c1># Transform using rotation matrix</span>
</span><span id=__span-10-61><a id=__codelineno-10-61 name=__codelineno-10-61></a><span class=n>pos_eme2000_matrix</span> <span class=o>=</span> <span class=n>R_gcrf_to_eme2000</span> <span class=o>@</span> <span class=n>pos_gcrf</span>
</span><span id=__span-10-62><a id=__codelineno-10-62 name=__codelineno-10-62></a>
</span><span id=__span-10-63><a id=__codelineno-10-63 name=__codelineno-10-63></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Satellite position in EME2000 (using rotation matrix):&quot;</span><span class=p>)</span>
</span><span id=__span-10-64><a id=__codelineno-10-64 name=__codelineno-10-64></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-10-65><a id=__codelineno-10-65 name=__codelineno-10-65></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m&quot;</span>
</span><span id=__span-10-66><a id=__codelineno-10-66 name=__codelineno-10-66></a><span class=p>)</span>
</span><span id=__span-10-67><a id=__codelineno-10-67 name=__codelineno-10-67></a><span class=c1># Satellite position in EME2000 (using rotation matrix):</span>
</span><span id=__span-10-68><a id=__codelineno-10-68 name=__codelineno-10-68></a><span class=c1>#   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-10-69><a id=__codelineno-10-69 name=__codelineno-10-69></a>
</span><span id=__span-10-70><a id=__codelineno-10-70 name=__codelineno-10-70></a><span class=c1># Verify using position transformation function</span>
</span><span id=__span-10-71><a id=__codelineno-10-71 name=__codelineno-10-71></a><span class=n>pos_eme2000_direct</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>position_gcrf_to_eme2000</span><span class=p>(</span><span class=n>pos_gcrf</span><span class=p>)</span>
</span><span id=__span-10-72><a id=__codelineno-10-72 name=__codelineno-10-72></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Satellite position in EME2000 (using position_gcrf_to_eme2000):&quot;</span><span class=p>)</span>
</span><span id=__span-10-73><a id=__codelineno-10-73 name=__codelineno-10-73></a><span class=nb>print</span><span class=p>(</span>
</span><span id=__span-10-74><a id=__codelineno-10-74 name=__codelineno-10-74></a>    <span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>pos_eme2000_direct</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000_direct</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>pos_eme2000_direct</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>] m&quot;</span>
</span><span id=__span-10-75><a id=__codelineno-10-75 name=__codelineno-10-75></a><span class=p>)</span>
</span><span id=__span-10-76><a id=__codelineno-10-76 name=__codelineno-10-76></a><span class=c1># Satellite position in EME2000 (using position_gcrf_to_eme2000):</span>
</span><span id=__span-10-77><a id=__codelineno-10-77 name=__codelineno-10-77></a><span class=c1>#   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-10-78><a id=__codelineno-10-78 name=__codelineno-10-78></a>
</span><span id=__span-10-79><a id=__codelineno-10-79 name=__codelineno-10-79></a><span class=c1># Verify both methods agree</span>
</span><span id=__span-10-80><a id=__codelineno-10-80 name=__codelineno-10-80></a><span class=n>diff</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>pos_eme2000_matrix</span> <span class=o>-</span> <span class=n>pos_eme2000_direct</span><span class=p>)</span>
</span><span id=__span-10-81><a id=__codelineno-10-81 name=__codelineno-10-81></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Difference between methods: </span><span class=si>{</span><span class=n>diff</span><span class=si>:</span><span class=s2>.6e</span><span class=si>}</span><span class=s2> m&quot;</span><span class=p>)</span>
</span><span id=__span-10-82><a id=__codelineno-10-82 name=__codelineno-10-82></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Note: Frame bias is constant (same at all epochs)&quot;</span><span class=p>)</span>
</span><span id=__span-10-83><a id=__codelineno-10-83 name=__codelineno-10-83></a><span class=c1># Difference between methods: 0.000000e+00 m</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-11-1> 1</a></span>
<span class=normal><a href=#__codelineno-11-2> 2</a></span>
<span class=normal><a href=#__codelineno-11-3> 3</a></span>
<span class=normal><a href=#__codelineno-11-4> 4</a></span>
<span class=normal><a href=#__codelineno-11-5> 5</a></span>
<span class=normal><a href=#__codelineno-11-6> 6</a></span>
<span class=normal><a href=#__codelineno-11-7> 7</a></span>
<span class=normal><a href=#__codelineno-11-8> 8</a></span>
<span class=normal><a href=#__codelineno-11-9> 9</a></span>
<span class=normal><a href=#__codelineno-11-10>10</a></span>
<span class=normal><a href=#__codelineno-11-11>11</a></span>
<span class=normal><a href=#__codelineno-11-12>12</a></span>
<span class=normal><a href=#__codelineno-11-13>13</a></span>
<span class=normal><a href=#__codelineno-11-14>14</a></span>
<span class=normal><a href=#__codelineno-11-15>15</a></span>
<span class=normal><a href=#__codelineno-11-16>16</a></span>
<span class=normal><a href=#__codelineno-11-17>17</a></span>
<span class=normal><a href=#__codelineno-11-18>18</a></span>
<span class=normal><a href=#__codelineno-11-19>19</a></span>
<span class=normal><a href=#__codelineno-11-20>20</a></span>
<span class=normal><a href=#__codelineno-11-21>21</a></span>
<span class=normal><a href=#__codelineno-11-22>22</a></span>
<span class=normal><a href=#__codelineno-11-23>23</a></span>
<span class=normal><a href=#__codelineno-11-24>24</a></span>
<span class=normal><a href=#__codelineno-11-25>25</a></span>
<span class=normal><a href=#__codelineno-11-26>26</a></span>
<span class=normal><a href=#__codelineno-11-27>27</a></span>
<span class=normal><a href=#__codelineno-11-28>28</a></span>
<span class=normal><a href=#__codelineno-11-29>29</a></span>
<span class=normal><a href=#__codelineno-11-30>30</a></span>
<span class=normal><a href=#__codelineno-11-31>31</a></span>
<span class=normal><a href=#__codelineno-11-32>32</a></span>
<span class=normal><a href=#__codelineno-11-33>33</a></span>
<span class=normal><a href=#__codelineno-11-34>34</a></span>
<span class=normal><a href=#__codelineno-11-35>35</a></span>
<span class=normal><a href=#__codelineno-11-36>36</a></span>
<span class=normal><a href=#__codelineno-11-37>37</a></span>
<span class=normal><a href=#__codelineno-11-38>38</a></span>
<span class=normal><a href=#__codelineno-11-39>39</a></span>
<span class=normal><a href=#__codelineno-11-40>40</a></span>
<span class=normal><a href=#__codelineno-11-41>41</a></span>
<span class=normal><a href=#__codelineno-11-42>42</a></span>
<span class=normal><a href=#__codelineno-11-43>43</a></span>
<span class=normal><a href=#__codelineno-11-44>44</a></span>
<span class=normal><a href=#__codelineno-11-45>45</a></span>
<span class=normal><a href=#__codelineno-11-46>46</a></span>
<span class=normal><a href=#__codelineno-11-47>47</a></span>
<span class=normal><a href=#__codelineno-11-48>48</a></span>
<span class=normal><a href=#__codelineno-11-49>49</a></span>
<span class=normal><a href=#__codelineno-11-50>50</a></span>
<span class=normal><a href=#__codelineno-11-51>51</a></span>
<span class=normal><a href=#__codelineno-11-52>52</a></span>
<span class=normal><a href=#__codelineno-11-53>53</a></span>
<span class=normal><a href=#__codelineno-11-54>54</a></span>
<span class=normal><a href=#__codelineno-11-55>55</a></span>
<span class=normal><a href=#__codelineno-11-56>56</a></span>
<span class=normal><a href=#__codelineno-11-57>57</a></span>
<span class=normal><a href=#__codelineno-11-58>58</a></span>
<span class=normal><a href=#__codelineno-11-59>59</a></span>
<span class=normal><a href=#__codelineno-11-60>60</a></span>
<span class=normal><a href=#__codelineno-11-61>61</a></span>
<span class=normal><a href=#__codelineno-11-62>62</a></span>
<span class=normal><a href=#__codelineno-11-63>63</a></span>
<span class=normal><a href=#__codelineno-11-64>64</a></span>
<span class=normal><a href=#__codelineno-11-65>65</a></span>
<span class=normal><a href=#__codelineno-11-66>66</a></span>
<span class=normal><a href=#__codelineno-11-67>67</a></span>
<span class=normal><a href=#__codelineno-11-68>68</a></span>
<span class=normal><a href=#__codelineno-11-69>69</a></span>
<span class=normal><a href=#__codelineno-11-70>70</a></span>
<span class=normal><a href=#__codelineno-11-71>71</a></span>
<span class=normal><a href=#__codelineno-11-72>72</a></span>
<span class=normal><a href=#__codelineno-11-73>73</a></span>
<span class=normal><a href=#__codelineno-11-74>74</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1></a><span class=k>use</span><span class=w> </span><span class=n>nalgebra</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>na</span><span class=p>;</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2></a>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4></a><span class=w>    </span><span class=c1>// Get constant rotation matrix from GCRF to EME2000</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>rotation_gcrf_to_eme2000</span><span class=p>();</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6></a>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;GCRF to EME2000 rotation matrix:&quot;</span><span class=p>);</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:13.10}, {:13.10}, {:13.10}]&quot;</span><span class=p>,</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=p>[(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)],</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=p>[(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)],</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=p>[(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)]);</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:13.10}, {:13.10}, {:13.10}]&quot;</span><span class=p>,</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=p>[(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)],</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=p>[(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)],</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=p>[(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)]);</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:13.10}, {:13.10}, {:13.10}]</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=p>[(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)],</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=p>[(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)],</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=p>[(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)]);</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11></a><span class=w>    </span><span class=c1>// GCRF to EME2000 rotation matrix:</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12></a><span class=w>    </span><span class=c1>//   [ 1.0000000000, -0.0000000708,  0.0000000806]</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13></a><span class=w>    </span><span class=c1>//   [ 0.0000000708,  1.0000000000,  0.0000000331]</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14></a><span class=w>    </span><span class=c1>//   [-0.0000000806, -0.0000000331,  1.0000000000]</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15></a>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16></a><span class=w>    </span><span class=c1>// Verify it&#39;s the transpose of EME2000 to GCRF rotation</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>rotation_eme2000_to_gcrf</span><span class=p>();</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>diff</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>r_gcrf_to_eme2000</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>r_eme2000_to_gcrf</span><span class=p>.</span><span class=n>transpose</span><span class=p>()).</span><span class=n>abs</span><span class=p>();</span>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>max_diff</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>diff</span><span class=p>.</span><span class=n>max</span><span class=p>();</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Verification: R_gcrf_to_eme2000 = R_eme2000_to_gcrf^T&quot;</span><span class=p>);</span>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Max difference: {:.2e}</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>max_diff</span><span class=p>);</span>
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22></a><span class=w>    </span><span class=c1>// Verification: R_gcrf_to_eme2000 = R_eme2000_to_gcrf^T</span>
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23></a><span class=w>    </span><span class=c1>//   Max difference: 0.00e+00</span>
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24></a>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25></a><span class=w>    </span><span class=c1>// Verify matrix is orthonormal (rotation matrix property)</span>
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>identity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=p>.</span><span class=n>transpose</span><span class=p>();</span>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>identity_ref</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>Matrix3</span><span class=p>::</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=p>::</span><span class=n>identity</span><span class=p>();</span>
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>max_dev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>identity</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>identity_ref</span><span class=p>).</span><span class=n>abs</span><span class=p>().</span><span class=n>max</span><span class=p>();</span>
</span><span id=__span-11-29><a id=__codelineno-11-29 name=__codelineno-11-29></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Verify orthonormality (R @ R^T should be identity):&quot;</span><span class=p>);</span>
</span><span id=__span-11-30><a id=__codelineno-11-30 name=__codelineno-11-30></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Max deviation from identity: {:.2e}</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>max_dev</span><span class=p>);</span>
</span><span id=__span-11-31><a id=__codelineno-11-31 name=__codelineno-11-31></a><span class=w>    </span><span class=c1>// Verify orthonormality (R @ R^T should be identity):</span>
</span><span id=__span-11-32><a id=__codelineno-11-32 name=__codelineno-11-32></a><span class=w>    </span><span class=c1>//   Max deviation from identity: 4.68e-15</span>
</span><span id=__span-11-33><a id=__codelineno-11-33 name=__codelineno-11-33></a>
</span><span id=__span-11-34><a id=__codelineno-11-34 name=__codelineno-11-34></a><span class=w>    </span><span class=c1>// Define orbital elements for testing transformation</span>
</span><span id=__span-11-35><a id=__codelineno-11-35 name=__codelineno-11-35></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>oe</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>SVector</span><span class=p>::</span><span class=o>&lt;</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=o>&gt;</span><span class=p>::</span><span class=n>new</span><span class=p>(</span>
</span><span id=__span-11-36><a id=__codelineno-11-36 name=__codelineno-11-36></a><span class=w>        </span><span class=n>bh</span><span class=p>::</span><span class=n>R_EARTH</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>500e3</span><span class=p>,</span><span class=w>  </span><span class=c1>// Semi-major axis (m)</span>
</span><span id=__span-11-37><a id=__codelineno-11-37 name=__codelineno-11-37></a><span class=w>        </span><span class=mf>0.01</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Eccentricity</span>
</span><span id=__span-11-38><a id=__codelineno-11-38 name=__codelineno-11-38></a><span class=w>        </span><span class=mf>97.8</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Inclination (deg)</span>
</span><span id=__span-11-39><a id=__codelineno-11-39 name=__codelineno-11-39></a><span class=w>        </span><span class=mf>15.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// RAAN (deg)</span>
</span><span id=__span-11-40><a id=__codelineno-11-40 name=__codelineno-11-40></a><span class=w>        </span><span class=mf>30.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Argument of periapsis (deg)</span>
</span><span id=__span-11-41><a id=__codelineno-11-41 name=__codelineno-11-41></a><span class=w>        </span><span class=mf>45.0</span><span class=p>,</span><span class=w>                  </span><span class=c1>// Mean anomaly (deg)</span>
</span><span id=__span-11-42><a id=__codelineno-11-42 name=__codelineno-11-42></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-11-43><a id=__codelineno-11-43 name=__codelineno-11-43></a>
</span><span id=__span-11-44><a id=__codelineno-11-44 name=__codelineno-11-44></a><span class=w>    </span><span class=c1>// Convert to EME2000, transform to GCRF, and extract position</span>
</span><span id=__span-11-45><a id=__codelineno-11-45 name=__codelineno-11-45></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_eme2000</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>AngleFormat</span><span class=p>::</span><span class=n>Degrees</span><span class=p>);</span>
</span><span id=__span-11-46><a id=__codelineno-11-46 name=__codelineno-11-46></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state_gcrf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>state_eme2000_to_gcrf</span><span class=p>(</span><span class=n>state_eme2000</span><span class=p>);</span>
</span><span id=__span-11-47><a id=__codelineno-11-47 name=__codelineno-11-47></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_gcrf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>na</span><span class=p>::</span><span class=n>Vector3</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>state_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-11-48><a id=__codelineno-11-48 name=__codelineno-11-48></a>
</span><span id=__span-11-49><a id=__codelineno-11-49 name=__codelineno-11-49></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Satellite position in GCRF:&quot;</span><span class=p>);</span>
</span><span id=__span-11-50><a id=__codelineno-11-50 name=__codelineno-11-50></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-11-51><a id=__codelineno-11-51 name=__codelineno-11-51></a><span class=w>    </span><span class=c1>// Satellite position in GCRF:</span>
</span><span id=__span-11-52><a id=__codelineno-11-52 name=__codelineno-11-52></a><span class=w>    </span><span class=c1>//   [1848963.547, -434937.816, 6560410.665] m</span>
</span><span id=__span-11-53><a id=__codelineno-11-53 name=__codelineno-11-53></a>
</span><span id=__span-11-54><a id=__codelineno-11-54 name=__codelineno-11-54></a><span class=w>    </span><span class=c1>// Transform using rotation matrix</span>
</span><span id=__span-11-55><a id=__codelineno-11-55 name=__codelineno-11-55></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_eme2000_matrix</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r_gcrf_to_eme2000</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>pos_gcrf</span><span class=p>;</span>
</span><span id=__span-11-56><a id=__codelineno-11-56 name=__codelineno-11-56></a>
</span><span id=__span-11-57><a id=__codelineno-11-57 name=__codelineno-11-57></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Satellite position in EME2000 (using rotation matrix):&quot;</span><span class=p>);</span>
</span><span id=__span-11-58><a id=__codelineno-11-58 name=__codelineno-11-58></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000_matrix</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-11-59><a id=__codelineno-11-59 name=__codelineno-11-59></a><span class=w>    </span><span class=c1>// Satellite position in EME2000 (using rotation matrix):</span>
</span><span id=__span-11-60><a id=__codelineno-11-60 name=__codelineno-11-60></a><span class=w>    </span><span class=c1>//   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-11-61><a id=__codelineno-11-61 name=__codelineno-11-61></a>
</span><span id=__span-11-62><a id=__codelineno-11-62 name=__codelineno-11-62></a><span class=w>    </span><span class=c1>// Verify using position transformation function</span>
</span><span id=__span-11-63><a id=__codelineno-11-63 name=__codelineno-11-63></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pos_eme2000_direct</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>position_gcrf_to_eme2000</span><span class=p>(</span><span class=n>pos_gcrf</span><span class=p>);</span>
</span><span id=__span-11-64><a id=__codelineno-11-64 name=__codelineno-11-64></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>Satellite position in EME2000 (using position_gcrf_to_eme2000):&quot;</span><span class=p>);</span>
</span><span id=__span-11-65><a id=__codelineno-11-65 name=__codelineno-11-65></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:.3}, {:.3}, {:.3}] m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>pos_eme2000_direct</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000_direct</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>pos_eme2000_direct</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span><span id=__span-11-66><a id=__codelineno-11-66 name=__codelineno-11-66></a><span class=w>    </span><span class=c1>// Satellite position in EME2000 (using position_gcrf_to_eme2000):</span>
</span><span id=__span-11-67><a id=__codelineno-11-67 name=__codelineno-11-67></a><span class=w>    </span><span class=c1>//   [1848964.106, -434937.468, 6560410.530] m</span>
</span><span id=__span-11-68><a id=__codelineno-11-68 name=__codelineno-11-68></a>
</span><span id=__span-11-69><a id=__codelineno-11-69 name=__codelineno-11-69></a><span class=w>    </span><span class=c1>// Verify both methods agree</span>
</span><span id=__span-11-70><a id=__codelineno-11-70 name=__codelineno-11-70></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>diff</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>pos_eme2000_matrix</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>pos_eme2000_direct</span><span class=p>).</span><span class=n>norm</span><span class=p>();</span>
</span><span id=__span-11-71><a id=__codelineno-11-71 name=__codelineno-11-71></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>Difference between methods: {:.6e} m&quot;</span><span class=p>,</span><span class=w> </span><span class=n>diff</span><span class=p>);</span>
</span><span id=__span-11-72><a id=__codelineno-11-72 name=__codelineno-11-72></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>Note: Frame bias is constant (same at all epochs)&quot;</span><span class=p>);</span>
</span><span id=__span-11-73><a id=__codelineno-11-73 name=__codelineno-11-73></a><span class=w>    </span><span class=c1>// Difference between methods: 0.000000e+00 m</span>
</span><span id=__span-11-74><a id=__codelineno-11-74 name=__codelineno-11-74></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <h2 id=frame-bias-matrix>Frame Bias Matrix<a class=headerlink href=#frame-bias-matrix title="Permanent link">&para;</a></h2> <p>The underlying frame bias transformation can also be accessed directly:</p> <div class="tabbed-set tabbed-alternate" data-tabs=7:2><input checked=checked id=__tabbed_7_1 name=__tabbed_7 type=radio><input id=__tabbed_7_2 name=__tabbed_7 type=radio><div class=tabbed-labels><label for=__tabbed_7_1>Python</label><label for=__tabbed_7_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-12-1> 1</a></span>
<span class=normal><a href=#__codelineno-12-2> 2</a></span>
<span class=normal><a href=#__codelineno-12-3> 3</a></span>
<span class=normal><a href=#__codelineno-12-4> 4</a></span>
<span class=normal><a href=#__codelineno-12-5> 5</a></span>
<span class=normal><a href=#__codelineno-12-6> 6</a></span>
<span class=normal><a href=#__codelineno-12-7> 7</a></span>
<span class=normal><a href=#__codelineno-12-8> 8</a></span>
<span class=normal><a href=#__codelineno-12-9> 9</a></span>
<span class=normal><a href=#__codelineno-12-10>10</a></span>
<span class=normal><a href=#__codelineno-12-11>11</a></span>
<span class=normal><a href=#__codelineno-12-12>12</a></span>
<span class=normal><a href=#__codelineno-12-13>13</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2></a>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3></a><span class=c1># Get the EME2000 frame bias matrix</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4></a><span class=n>B</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>bias_eme2000</span><span class=p>()</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5></a>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;EME2000 frame bias matrix:&quot;</span><span class=p>)</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>B</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>B</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>B</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>]&quot;</span><span class=p>)</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>B</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>B</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>B</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>]&quot;</span><span class=p>)</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  [</span><span class=si>{</span><span class=n>B</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>B</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>B</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s2>13.10f</span><span class=si>}</span><span class=s2>]</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10></a><span class=c1># EME2000 frame bias matrix:</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11></a><span class=c1>#   [ 1.0000000000, -0.0000000708,  0.0000000806]</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12></a><span class=c1>#   [ 0.0000000708,  1.0000000000,  0.0000000331]</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13></a><span class=c1>#   [-0.0000000806, -0.0000000331,  1.0000000000]</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-13-1> 1</a></span>
<span class=normal><a href=#__codelineno-13-2> 2</a></span>
<span class=normal><a href=#__codelineno-13-3> 3</a></span>
<span class=normal><a href=#__codelineno-13-4> 4</a></span>
<span class=normal><a href=#__codelineno-13-5> 5</a></span>
<span class=normal><a href=#__codelineno-13-6> 6</a></span>
<span class=normal><a href=#__codelineno-13-7> 7</a></span>
<span class=normal><a href=#__codelineno-13-8> 8</a></span>
<span class=normal><a href=#__codelineno-13-9> 9</a></span>
<span class=normal><a href=#__codelineno-13-10>10</a></span>
<span class=normal><a href=#__codelineno-13-11>11</a></span>
<span class=normal><a href=#__codelineno-13-12>12</a></span>
<span class=normal><a href=#__codelineno-13-13>13</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2></a><span class=w>    </span><span class=c1>// Get the EME2000 frame bias matrix</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bh</span><span class=p>::</span><span class=n>bias_eme2000</span><span class=p>();</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4></a>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;EME2000 frame bias matrix:&quot;</span><span class=p>);</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:13.10}, {:13.10}, {:13.10}]&quot;</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>[(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)],</span><span class=w> </span><span class=n>b</span><span class=p>[(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)],</span><span class=w> </span><span class=n>b</span><span class=p>[(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)]);</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:13.10}, {:13.10}, {:13.10}]&quot;</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>[(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)],</span><span class=w> </span><span class=n>b</span><span class=p>[(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)],</span><span class=w> </span><span class=n>b</span><span class=p>[(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)]);</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  [{:13.10}, {:13.10}, {:13.10}]</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>[(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)],</span><span class=w> </span><span class=n>b</span><span class=p>[(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)],</span><span class=w> </span><span class=n>b</span><span class=p>[(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)]);</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9></a><span class=w>    </span><span class=c1>// EME2000 frame bias matrix:</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10></a><span class=w>    </span><span class=c1>//   [ 1.0000000000, -0.0000000708,  0.0000000806]</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11></a><span class=w>    </span><span class=c1>//   [ 0.0000000708,  1.0000000000,  0.0000000331]</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12></a><span class=w>    </span><span class=c1>//   [-0.0000000806, -0.0000000331,  1.0000000000]</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <p>The bias matrix is identical to <code>rotation_gcrf_to_eme2000()</code> and represents the constant transformation from GCRF to EME2000.</p> <h2 id=see-also>See Also<a class=headerlink href=#see-also title="Permanent link">&para;</a></h2> <ul> <li><a href=gcrf_itrf.html>GCRF ↔ ITRF Transformations</a> - Time-dependent transformations between inertial and Earth-fixed frames</li> <li><a href=index.html>Reference Frames Overview</a> - Complete overview of all reference frames in Brahe</li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="November 10, 2025 01:43:30 UTC">2025-11-10</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="November 10, 2025 00:27:31 UTC">2025-11-10</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "navigation.indexes", "navigation.tracking", "navigation.top3", "toc.follow", "content.tabs.link", "content.code.copy", "search.highlight", "search.suggest"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../javascripts/katex.d81d3f.min.js></script> <script src=https://unpkg.com/katex@0/dist/katex.min.js></script> <script src=https://unpkg.com/katex@0/dist/contrib/auto-render.min.js></script> <script src=https://cdn.plot.ly/plotly-latest.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../javascripts/tablesort.ae6fa2.min.js></script> </body> </html>