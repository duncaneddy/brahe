<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Brahe - Practical Astrodynamics"><meta name=author content="Duncan Eddy"><link rel=canonical href=https://duncaneddy.github.io/brahe/latest/learn/integrators/index.html><link rel=prev href=../mathematics/jacobian.html><link rel=next href=fixed_step.html><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.20"><title>Numerical Integration - Brahe</title><link rel=stylesheet href=../../assets/stylesheets/main.e53b48f4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.5dba32.min.css><link rel=stylesheet href=https://unpkg.com/katex@0/dist/katex.min.css><link rel=stylesheet href=../../stylesheets/neoteroi-mkdocs.249355.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-H1DDT6G6K6"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-H1DDT6G6K6",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-H1DDT6G6K6",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=black> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#numerical-integration class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Brahe class="md-header__button md-logo" aria-label=Brahe data-md-component=logo> <img src=../../assets/icon.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Brahe </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Numerical Integration </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=black aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=black aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/duncaneddy/brahe title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../index.html class=md-tabs__link> Brahe </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../index.html class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../examples/index.html class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../library_api/index.html class=md-tabs__link> Python API Reference </a> </li> <li class=md-tabs__item> <a href=https://docs.rs/brahe class=md-tabs__link> Rust API Reference </a> </li> <li class=md-tabs__item> <a href=https://duncaneddy.com class=md-tabs__link> About Me </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Brahe class="md-nav__button md-logo" aria-label=Brahe data-md-component=logo> <img src=../../assets/icon.png alt=logo> </a> Brahe </label> <div class=md-nav__source> <a href=https://github.com/duncaneddy/brahe title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../../index.html class="md-nav__link "> <span class=md-ellipsis> Brahe </span> </a> <label class="md-nav__link " for=__nav_1 id=__nav_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Brahe </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../installation.html class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../changelog.html class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1_3> <div class="md-nav__link md-nav__container"> <a href=../../about/index.html class="md-nav__link "> <span class=md-ellipsis> About </span> </a> <label class="md-nav__link " for=__nav_1_3 id=__nav_1_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_1_3> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../about/license.html class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class=md-nav__item> <a href=../../about/roadmap.html class=md-nav__link> <span class=md-ellipsis> Roadmap </span> </a> </li> <li class=md-nav__item> <a href=../../about/design.html class=md-nav__link> <span class=md-ellipsis> Design Philosophy &amp; Decisions </span> </a> </li> <li class=md-nav__item> <a href=../../about/versioning.html class=md-nav__link> <span class=md-ellipsis> Versioning </span> </a> </li> <li class=md-nav__item> <a href=../../about/alternatives.html class=md-nav__link> <span class=md-ellipsis> History and Inspiration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1_4> <div class="md-nav__link md-nav__container"> <a href=../../contributing.html class="md-nav__link "> <span class=md-ellipsis> Contributing To Brahe </span> </a> <label class="md-nav__link " for=__nav_1_4 id=__nav_1_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_1_4> <span class="md-nav__icon md-icon"></span> Contributing To Brahe </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../development_guide.html class=md-nav__link> <span class=md-ellipsis> Development Guide </span> </a> </li> <li class=md-nav__item> <a href=../../code_of_conduct.html class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../index.html class="md-nav__link "> <span class=md-ellipsis> User Guide </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../constants.html class=md-nav__link> <span class=md-ellipsis> Constants </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_2> <div class="md-nav__link md-nav__container"> <a href=../eop/index.html class="md-nav__link "> <span class=md-ellipsis> Earth Orientation Data </span> </a> <label class="md-nav__link " for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Earth Orientation Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../eop/what_is_eop_data.html class=md-nav__link> <span class=md-ellipsis> What is EOP Data? </span> </a> </li> <li class=md-nav__item> <a href=../eop/managing_eop_data.html class=md-nav__link> <span class=md-ellipsis> Managing EOP Data </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_3> <div class="md-nav__link md-nav__container"> <a href=../time/index.html class="md-nav__link "> <span class=md-ellipsis> Time </span> </a> <label class="md-nav__link " for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Time </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../time/epoch.html class=md-nav__link> <span class=md-ellipsis> Epoch </span> </a> </li> <li class=md-nav__item> <a href=../time/time_range.html class=md-nav__link> <span class=md-ellipsis> Time Range </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_4> <div class="md-nav__link md-nav__container"> <a href=../coordinates/index.html class="md-nav__link "> <span class=md-ellipsis> Coordinate Transformations </span> </a> <label class="md-nav__link " for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Coordinate Transformations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../coordinates/cartesian_transformations.html class=md-nav__link> <span class=md-ellipsis> Cartesian ↔ Orbital Element Transformations </span> </a> </li> <li class=md-nav__item> <a href=../coordinates/geocentric_transformations.html class=md-nav__link> <span class=md-ellipsis> Geocentric Transformations </span> </a> </li> <li class=md-nav__item> <a href=../coordinates/geodetic_transformations.html class=md-nav__link> <span class=md-ellipsis> Geodetic Transformations </span> </a> </li> <li class=md-nav__item> <a href=../coordinates/topocentric_transformations.html class=md-nav__link> <span class=md-ellipsis> Topocentric Coordinate Transformations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_5> <div class="md-nav__link md-nav__container"> <a href=../frames/index.html class="md-nav__link "> <span class=md-ellipsis> Reference Frame Transformations </span> </a> <label class="md-nav__link " for=__nav_2_5 id=__nav_2_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Reference Frame Transformations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../frames/eci_ecef.html class=md-nav__link> <span class=md-ellipsis> ECI ↔ ECEF Transformations </span> </a> </li> <li class=md-nav__item> <a href=../frames/gcrf_itrf.html class=md-nav__link> <span class=md-ellipsis> GCRF ↔ ITRF Transformations </span> </a> </li> <li class=md-nav__item> <a href=../frames/eme2000_gcrf.html class=md-nav__link> <span class=md-ellipsis> EME2000 ↔ GCRF Transformations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_6> <div class="md-nav__link md-nav__container"> <a href=../orbits/index.html class="md-nav__link "> <span class=md-ellipsis> Orbits </span> </a> <label class="md-nav__link " for=__nav_2_6 id=__nav_2_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> Orbits </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../orbits/anomalies.html class=md-nav__link> <span class=md-ellipsis> Anomaly Conversions </span> </a> </li> <li class=md-nav__item> <a href=../orbits/properties.html class=md-nav__link> <span class=md-ellipsis> Orbital Properties </span> </a> </li> <li class=md-nav__item> <a href=../orbits/two_line_elements.html class=md-nav__link> <span class=md-ellipsis> Two-Line Elements (TLE) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_7> <div class="md-nav__link md-nav__container"> <a href=../attitude_representations/index.html class="md-nav__link "> <span class=md-ellipsis> Attitude Representation </span> </a> <label class="md-nav__link " for=__nav_2_7 id=__nav_2_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Attitude Representation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../attitude_representations/quaternions.html class=md-nav__link> <span class=md-ellipsis> Quaternions </span> </a> </li> <li class=md-nav__item> <a href=../attitude_representations/rotation_matrices.html class=md-nav__link> <span class=md-ellipsis> Rotation Matrices </span> </a> </li> <li class=md-nav__item> <a href=../attitude_representations/euler_angles.html class=md-nav__link> <span class=md-ellipsis> Euler Angles </span> </a> </li> <li class=md-nav__item> <a href=../attitude_representations/euler_axis.html class=md-nav__link> <span class=md-ellipsis> Euler Axis (Axis-Angle) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_8> <div class="md-nav__link md-nav__container"> <a href=../trajectories/index.html class="md-nav__link "> <span class=md-ellipsis> Trajectories </span> </a> <label class="md-nav__link " for=__nav_2_8 id=__nav_2_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_8_label aria-expanded=false> <label class=md-nav__title for=__nav_2_8> <span class="md-nav__icon md-icon"></span> Trajectories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../trajectories/dtrajectory.html class=md-nav__link> <span class=md-ellipsis> DTrajectory </span> </a> </li> <li class=md-nav__item> <a href=../trajectories/strajectory6.html class=md-nav__link> <span class=md-ellipsis> STrajectory6 </span> </a> </li> <li class=md-nav__item> <a href=../trajectories/orbit_trajectory.html class=md-nav__link> <span class=md-ellipsis> OrbitTrajectory </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_9> <div class="md-nav__link md-nav__container"> <a href=../orbital_dynamics/index.html class="md-nav__link "> <span class=md-ellipsis> Orbital Dynamics </span> </a> <label class="md-nav__link " for=__nav_2_9 id=__nav_2_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_9_label aria-expanded=false> <label class=md-nav__title for=__nav_2_9> <span class="md-nav__icon md-icon"></span> Orbital Dynamics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../orbital_dynamics/gravity.html class=md-nav__link> <span class=md-ellipsis> Gravity Models </span> </a> </li> <li class=md-nav__item> <a href=../orbital_dynamics/third_body.html class=md-nav__link> <span class=md-ellipsis> Third-Body Perturbations </span> </a> </li> <li class=md-nav__item> <a href=../orbital_dynamics/drag.html class=md-nav__link> <span class=md-ellipsis> Atmospheric Drag </span> </a> </li> <li class=md-nav__item> <a href=../orbital_dynamics/solar_radiation_pressure.html class=md-nav__link> <span class=md-ellipsis> Solar Radiation Pressure </span> </a> </li> <li class=md-nav__item> <a href=../orbital_dynamics/relativity.html class=md-nav__link> <span class=md-ellipsis> Relativistic Effects </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_10> <div class="md-nav__link md-nav__container"> <a href=../orbit_propagation/index.html class="md-nav__link "> <span class=md-ellipsis> Orbit Propagation </span> </a> <label class="md-nav__link " for=__nav_2_10 id=__nav_2_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_10_label aria-expanded=false> <label class=md-nav__title for=__nav_2_10> <span class="md-nav__icon md-icon"></span> Orbit Propagation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../orbit_propagation/keplerian_propagation.html class=md-nav__link> <span class=md-ellipsis> Keplerian Propagation </span> </a> </li> <li class=md-nav__item> <a href=../orbit_propagation/sgp_propagation.html class=md-nav__link> <span class=md-ellipsis> SGP Propagation </span> </a> </li> <li class=md-nav__item> <a href=../orbit_propagation/parallel_propagation.html class=md-nav__link> <span class=md-ellipsis> Parallel Propagation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_11> <div class="md-nav__link md-nav__container"> <a href=../relative_motion/index.html class="md-nav__link "> <span class=md-ellipsis> Relative Motion </span> </a> <label class="md-nav__link " for=__nav_2_11 id=__nav_2_11_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_11_label aria-expanded=false> <label class=md-nav__title for=__nav_2_11> <span class="md-nav__icon md-icon"></span> Relative Motion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../relative_motion/rtn_transformations.html class=md-nav__link> <span class=md-ellipsis> RTN Transformations </span> </a> </li> <li class=md-nav__item> <a href=../relative_motion/roe_transformations.html class=md-nav__link> <span class=md-ellipsis> Relative Orbital Elements (ROE) Transformations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_12> <div class="md-nav__link md-nav__container"> <a href=../access_computation/index.html class="md-nav__link "> <span class=md-ellipsis> Access Computation </span> </a> <label class="md-nav__link " for=__nav_2_12 id=__nav_2_12_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_12_label aria-expanded=false> <label class=md-nav__title for=__nav_2_12> <span class="md-nav__icon md-icon"></span> Access Computation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../access_computation/locations.html class=md-nav__link> <span class=md-ellipsis> Locations </span> </a> </li> <li class=md-nav__item> <a href=../access_computation/constraints.html class=md-nav__link> <span class=md-ellipsis> Constraints </span> </a> </li> <li class=md-nav__item> <a href=../access_computation/properties.html class=md-nav__link> <span class=md-ellipsis> Properties </span> </a> </li> <li class=md-nav__item> <a href=../access_computation/computation.html class=md-nav__link> <span class=md-ellipsis> Computation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_13> <div class="md-nav__link md-nav__container"> <a href=../mathematics/index.html class="md-nav__link "> <span class=md-ellipsis> Mathematics </span> </a> <label class="md-nav__link " for=__nav_2_13 id=__nav_2_13_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_13_label aria-expanded=false> <label class=md-nav__title for=__nav_2_13> <span class="md-nav__icon md-icon"></span> Mathematics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../mathematics/jacobian.html class=md-nav__link> <span class=md-ellipsis> Jacobian Computation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_14 checked> <div class="md-nav__link md-nav__container"> <a href=index.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Numerical Integration </span> </a> <label class="md-nav__link md-nav__link--active" for=__nav_2_14 id=__nav_2_14_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_14_label aria-expanded=true> <label class=md-nav__title for=__nav_2_14> <span class="md-nav__icon md-icon"></span> Numerical Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=fixed_step.html class=md-nav__link> <span class=md-ellipsis> Fixed-Step Integrators </span> </a> </li> <li class=md-nav__item> <a href=adaptive_step.html class=md-nav__link> <span class=md-ellipsis> Adaptive-Step Integrators </span> </a> </li> <li class=md-nav__item> <a href=variational_equations.html class=md-nav__link> <span class=md-ellipsis> Variational Equations </span> </a> </li> <li class=md-nav__item> <a href=control_inputs.html class=md-nav__link> <span class=md-ellipsis> Control Inputs </span> </a> </li> <li class=md-nav__item> <a href=sensitivity_matrix.html class=md-nav__link> <span class=md-ellipsis> Sensitivity Matrices </span> </a> </li> <li class=md-nav__item> <a href=configuration.html class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_15> <div class="md-nav__link md-nav__container"> <a href=../space_weather/index.html class="md-nav__link "> <span class=md-ellipsis> Space Weather Data </span> </a> <label class="md-nav__link " for=__nav_2_15 id=__nav_2_15_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_15_label aria-expanded=false> <label class=md-nav__title for=__nav_2_15> <span class="md-nav__icon md-icon"></span> Space Weather Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../space_weather/managing_space_weather_data.html class=md-nav__link> <span class=md-ellipsis> Managing Space Weather Data </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_16> <div class="md-nav__link md-nav__container"> <a href=../datasets/index.html class="md-nav__link "> <span class=md-ellipsis> Datasets </span> </a> <label class="md-nav__link " for=__nav_2_16 id=__nav_2_16_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_16_label aria-expanded=false> <label class=md-nav__title for=__nav_2_16> <span class="md-nav__icon md-icon"></span> Datasets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../datasets/celestrak.html class=md-nav__link> <span class=md-ellipsis> CelesTrak </span> </a> </li> <li class=md-nav__item> <a href=../datasets/naif.html class=md-nav__link> <span class=md-ellipsis> NAIF </span> </a> </li> <li class=md-nav__item> <a href=../datasets/groundstations.html class=md-nav__link> <span class=md-ellipsis> Groundstations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_17> <div class="md-nav__link md-nav__container"> <a href=../utilities/index.html class="md-nav__link "> <span class=md-ellipsis> Utilities </span> </a> <label class="md-nav__link " for=__nav_2_17 id=__nav_2_17_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_17_label aria-expanded=false> <label class=md-nav__title for=__nav_2_17> <span class="md-nav__icon md-icon"></span> Utilities </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../utilities/caching.html class=md-nav__link> <span class=md-ellipsis> Caching </span> </a> </li> <li class=md-nav__item> <a href=../utilities/threading.html class=md-nav__link> <span class=md-ellipsis> Multithreading </span> </a> </li> <li class=md-nav__item> <a href=../utilities/string_formatting.html class=md-nav__link> <span class=md-ellipsis> String Formatting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_18> <div class="md-nav__link md-nav__container"> <a href=../plots/index.html class="md-nav__link "> <span class=md-ellipsis> Plots </span> </a> <label class="md-nav__link " for=__nav_2_18 id=__nav_2_18_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_18_label aria-expanded=false> <label class=md-nav__title for=__nav_2_18> <span class="md-nav__icon md-icon"></span> Plots </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../plots/orbital_trajectories.html class=md-nav__link> <span class=md-ellipsis> Orbital Trajectories </span> </a> </li> <li class=md-nav__item> <a href=../plots/3d_trajectory.html class=md-nav__link> <span class=md-ellipsis> 3D Trajectory </span> </a> </li> <li class=md-nav__item> <a href=../plots/ground_tracks.html class=md-nav__link> <span class=md-ellipsis> Ground Tracks </span> </a> </li> <li class=md-nav__item> <a href=../plots/access_geometry.html class=md-nav__link> <span class=md-ellipsis> Access Geometry </span> </a> </li> <li class=md-nav__item> <a href=../plots/gabbard_plot.html class=md-nav__link> <span class=md-ellipsis> Gabbard Plots </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_19> <div class="md-nav__link md-nav__container"> <a href=../cli/index.html class="md-nav__link "> <span class=md-ellipsis> Command Line Interface </span> </a> <label class="md-nav__link " for=__nav_2_19 id=__nav_2_19_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_19_label aria-expanded=false> <label class=md-nav__title for=__nav_2_19> <span class="md-nav__icon md-icon"></span> Command Line Interface </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cli/eop.html class=md-nav__link> <span class=md-ellipsis> EOP </span> </a> </li> <li class=md-nav__item> <a href=../cli/time.html class=md-nav__link> <span class=md-ellipsis> Time </span> </a> </li> <li class=md-nav__item> <a href=../cli/orbits.html class=md-nav__link> <span class=md-ellipsis> Orbits </span> </a> </li> <li class=md-nav__item> <a href=../cli/transform.html class=md-nav__link> <span class=md-ellipsis> Transform </span> </a> </li> <li class=md-nav__item> <a href=../cli/datasets.html class=md-nav__link> <span class=md-ellipsis> Datasets </span> </a> </li> <li class=md-nav__item> <a href=../cli/access.html class=md-nav__link> <span class=md-ellipsis> Access </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../examples/index.html class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/visualizing_gps.html class=md-nav__link> <span class=md-ellipsis> Visualizing GPS Satellite Orbits </span> </a> </li> <li class=md-nav__item> <a href=../../examples/visualizing_starlink.html class=md-nav__link> <span class=md-ellipsis> Downloading &amp; Visualizing TLE Data For Starlink Satellites </span> </a> </li> <li class=md-nav__item> <a href=../../examples/ground_contacts.html class=md-nav__link> <span class=md-ellipsis> Predicting Ground Contacts </span> </a> </li> <li class=md-nav__item> <a href=../../examples/doppler_compensation.html class=md-nav__link> <span class=md-ellipsis> Calculating Doppler Compensation </span> </a> </li> <li class=md-nav__item> <a href=../../examples/max_communications_gap.html class=md-nav__link> <span class=md-ellipsis> Maximum Communications Gap </span> </a> </li> <li class=md-nav__item> <a href=../../examples/imaging_opportunities.html class=md-nav__link> <span class=md-ellipsis> Earth Observation Imaging Opportunities </span> </a> </li> <li class=md-nav__item> <a href=../../examples/using_different_integrators.html class=md-nav__link> <span class=md-ellipsis> Comparing Integrator Performance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../library_api/index.html class="md-nav__link "> <span class=md-ellipsis> Python API Reference </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Python API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_1> <div class="md-nav__link md-nav__container"> <a href=../../library_api/constants/index.html class="md-nav__link "> <span class=md-ellipsis> Constants </span> </a> <label class="md-nav__link " for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Constants </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/constants/units.html class=md-nav__link> <span class=md-ellipsis> Units </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/constants/math.html class=md-nav__link> <span class=md-ellipsis> Mathematical </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/constants/time.html class=md-nav__link> <span class=md-ellipsis> Time </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/constants/physical.html class=md-nav__link> <span class=md-ellipsis> Physical </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_2> <div class="md-nav__link md-nav__container"> <a href=../../library_api/eop/index.html class="md-nav__link "> <span class=md-ellipsis> EOP </span> </a> <label class="md-nav__link " for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> EOP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/eop/caching_provider.html class=md-nav__link> <span class=md-ellipsis> CachingEOPProvider </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/eop/file_provider.html class=md-nav__link> <span class=md-ellipsis> FileEOPProvider </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/eop/static_provider.html class=md-nav__link> <span class=md-ellipsis> StaticEOPProvider </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/eop/functions.html class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_3> <div class="md-nav__link md-nav__container"> <a href=../../library_api/time/index.html class="md-nav__link "> <span class=md-ellipsis> Time </span> </a> <label class="md-nav__link " for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Time </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/time/epoch.html class=md-nav__link> <span class=md-ellipsis> Epoch </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/time/conversions.html class=md-nav__link> <span class=md-ellipsis> Conversions </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/time/time_range.html class=md-nav__link> <span class=md-ellipsis> TimeRange </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_4> <div class="md-nav__link md-nav__container"> <a href=../../library_api/coordinates/index.html class="md-nav__link "> <span class=md-ellipsis> Coordinates </span> </a> <label class="md-nav__link " for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Coordinates </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/coordinates/cartesian.html class=md-nav__link> <span class=md-ellipsis> Cartesian </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/coordinates/geodetic.html class=md-nav__link> <span class=md-ellipsis> Geodetic & Geocentric </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/coordinates/topocentric.html class=md-nav__link> <span class=md-ellipsis> Topocentric </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/coordinates/enums.html class=md-nav__link> <span class=md-ellipsis> Enumerations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_5> <div class="md-nav__link md-nav__container"> <a href=../../library_api/frames/index.html class="md-nav__link "> <span class=md-ellipsis> Frames </span> </a> <label class="md-nav__link " for=__nav_4_5 id=__nav_4_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Frames </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/frames/eci_ecef.html class=md-nav__link> <span class=md-ellipsis> ECI ↔ ECEF </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/frames/gcrf_itrf.html class=md-nav__link> <span class=md-ellipsis> GCRF ↔ ITRF </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/frames/eme2000_gcrf.html class=md-nav__link> <span class=md-ellipsis> EME2000 ↔ GCRF </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_6> <div class="md-nav__link md-nav__container"> <a href=../../library_api/orbits/index.html class="md-nav__link "> <span class=md-ellipsis> Orbits </span> </a> <label class="md-nav__link " for=__nav_4_6 id=__nav_4_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Orbits </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/orbits/keplerian.html class=md-nav__link> <span class=md-ellipsis> Keplerian Elements </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbits/tle.html class=md-nav__link> <span class=md-ellipsis> Two-Line Elements </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbits/altitude_functions.html class=md-nav__link> <span class=md-ellipsis> Altitude Functions </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbits/enums.html class=md-nav__link> <span class=md-ellipsis> Enumerations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_7> <div class="md-nav__link md-nav__container"> <a href=../../library_api/attitude/index.html class="md-nav__link "> <span class=md-ellipsis> Attitude </span> </a> <label class="md-nav__link " for=__nav_4_7 id=__nav_4_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_4_7> <span class="md-nav__icon md-icon"></span> Attitude </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/attitude/quaternion.html class=md-nav__link> <span class=md-ellipsis> Quaternion </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/attitude/rotation_matrix.html class=md-nav__link> <span class=md-ellipsis> Rotation Matrix </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/attitude/euler_angles.html class=md-nav__link> <span class=md-ellipsis> Euler Angles </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/attitude/euler_axis.html class=md-nav__link> <span class=md-ellipsis> Euler Axis </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/attitude/euler_angle_order.html class=md-nav__link> <span class=md-ellipsis> EulerAngleOrder </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_8> <div class="md-nav__link md-nav__container"> <a href=../../library_api/trajectories/index.html class="md-nav__link "> <span class=md-ellipsis> Trajectories </span> </a> <label class="md-nav__link " for=__nav_4_8 id=__nav_4_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_8_label aria-expanded=false> <label class=md-nav__title for=__nav_4_8> <span class="md-nav__icon md-icon"></span> Trajectories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/trajectories/dtrajectory.html class=md-nav__link> <span class=md-ellipsis> DTrajectory </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/trajectories/strajectory6.html class=md-nav__link> <span class=md-ellipsis> STrajectory6 </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/trajectories/orbit_trajectory.html class=md-nav__link> <span class=md-ellipsis> OrbitTrajectory </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_9> <div class="md-nav__link md-nav__container"> <a href=../../library_api/orbit_dynamics/index.html class="md-nav__link "> <span class=md-ellipsis> Orbital Dynamics </span> </a> <label class="md-nav__link " for=__nav_4_9 id=__nav_4_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_9_label aria-expanded=false> <label class=md-nav__title for=__nav_4_9> <span class="md-nav__icon md-icon"></span> Orbital Dynamics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/orbit_dynamics/gravity.html class=md-nav__link> <span class=md-ellipsis> Gravity Models </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbit_dynamics/third_body.html class=md-nav__link> <span class=md-ellipsis> Third-Body </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbit_dynamics/drag.html class=md-nav__link> <span class=md-ellipsis> Atmospheric Drag </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbit_dynamics/atmospheric_density_models.html class=md-nav__link> <span class=md-ellipsis> Atmospheric Density </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbit_dynamics/solar_radiation_pressure.html class=md-nav__link> <span class=md-ellipsis> Solar Radiation Pressure </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbit_dynamics/relativity.html class=md-nav__link> <span class=md-ellipsis> Relativistic Effects </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/orbit_dynamics/ephemerides.html class=md-nav__link> <span class=md-ellipsis> Ephemerides </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_10> <div class="md-nav__link md-nav__container"> <a href=../../library_api/propagators/index.html class="md-nav__link "> <span class=md-ellipsis> Propagators </span> </a> <label class="md-nav__link " for=__nav_4_10 id=__nav_4_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_10_label aria-expanded=false> <label class=md-nav__title for=__nav_4_10> <span class="md-nav__icon md-icon"></span> Propagators </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/propagators/keplerian_propagator.html class=md-nav__link> <span class=md-ellipsis> KeplerianPropagator </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/propagators/sgp_propagator.html class=md-nav__link> <span class=md-ellipsis> SGPPropagator </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/propagators/functions.html class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_11> <div class="md-nav__link md-nav__container"> <a href=../../library_api/relative_motion/index.html class="md-nav__link "> <span class=md-ellipsis> Relative Motion </span> </a> <label class="md-nav__link " for=__nav_4_11 id=__nav_4_11_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_11_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11> <span class="md-nav__icon md-icon"></span> Relative Motion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/relative_motion/rtn_transformations.html class=md-nav__link> <span class=md-ellipsis> RTN Transformations </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/relative_motion/roe_transformations.html class=md-nav__link> <span class=md-ellipsis> ROE Transformations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_12> <div class="md-nav__link md-nav__container"> <a href=../../library_api/access/index.html class="md-nav__link "> <span class=md-ellipsis> Access </span> </a> <label class="md-nav__link " for=__nav_4_12 id=__nav_4_12_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_12_label aria-expanded=false> <label class=md-nav__title for=__nav_4_12> <span class="md-nav__icon md-icon"></span> Access </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/access/locations.html class=md-nav__link> <span class=md-ellipsis> Locations </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/access/constraints.html class=md-nav__link> <span class=md-ellipsis> Constraints </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/access/constraint_computer.html class=md-nav__link> <span class=md-ellipsis> Constraint Computer </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/access/properties.html class=md-nav__link> <span class=md-ellipsis> Properties </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/access/windows.html class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/access/enums.html class=md-nav__link> <span class=md-ellipsis> Enumerations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_13> <div class="md-nav__link md-nav__container"> <a href=../../library_api/mathematics/index.html class="md-nav__link "> <span class=md-ellipsis> Mathematics </span> </a> <label class="md-nav__link " for=__nav_4_13 id=__nav_4_13_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_13_label aria-expanded=false> <label class=md-nav__title for=__nav_4_13> <span class="md-nav__icon md-icon"></span> Mathematics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/mathematics/jacobian.html class=md-nav__link> <span class=md-ellipsis> Jacobian </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/mathematics/sensitivity.html class=md-nav__link> <span class=md-ellipsis> Sensitivity Matrices </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_14> <div class="md-nav__link md-nav__container"> <a href=../../library_api/integrators/index.html class="md-nav__link "> <span class=md-ellipsis> Integrators </span> </a> <label class="md-nav__link " for=__nav_4_14 id=__nav_4_14_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_14_label aria-expanded=false> <label class=md-nav__title for=__nav_4_14> <span class="md-nav__icon md-icon"></span> Integrators </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/integrators/config.html class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/integrators/rk4.html class=md-nav__link> <span class=md-ellipsis> RK4 Integrator </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/integrators/rkf45.html class=md-nav__link> <span class=md-ellipsis> RKF45 Integrator </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/integrators/dp54.html class=md-nav__link> <span class=md-ellipsis> DP54 Integrator </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/integrators/rkn1210.html class=md-nav__link> <span class=md-ellipsis> RKN1210 Integrator </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_15> <div class="md-nav__link md-nav__container"> <a href=../../library_api/space_weather/index.html class="md-nav__link "> <span class=md-ellipsis> Space Weather </span> </a> <label class="md-nav__link " for=__nav_4_15 id=__nav_4_15_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_15_label aria-expanded=false> <label class=md-nav__title for=__nav_4_15> <span class="md-nav__icon md-icon"></span> Space Weather </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/space_weather/functions.html class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/space_weather/caching_provider.html class=md-nav__link> <span class=md-ellipsis> CachingSpaceWeatherProvider </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/space_weather/file_provider.html class=md-nav__link> <span class=md-ellipsis> FileSpaceWeatherProvider </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/space_weather/static_provider.html class=md-nav__link> <span class=md-ellipsis> StaticSpaceWeatherProvider </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_16> <div class="md-nav__link md-nav__container"> <a href=../../library_api/earth_models/index.html class="md-nav__link "> <span class=md-ellipsis> Earth Models </span> </a> <label class="md-nav__link " for=__nav_4_16 id=__nav_4_16_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_16_label aria-expanded=false> <label class=md-nav__title for=__nav_4_16> <span class="md-nav__icon md-icon"></span> Earth Models </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/earth_models/harris_priester.html class=md-nav__link> <span class=md-ellipsis> Harris-Priester </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/earth_models/nrlmsise00.html class=md-nav__link> <span class=md-ellipsis> NRLMSISE-00 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_17> <div class="md-nav__link md-nav__container"> <a href=../../library_api/datasets/index.html class="md-nav__link "> <span class=md-ellipsis> Datasets </span> </a> <label class="md-nav__link " for=__nav_4_17 id=__nav_4_17_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_17_label aria-expanded=false> <label class=md-nav__title for=__nav_4_17> <span class="md-nav__icon md-icon"></span> Datasets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/datasets/celestrak.html class=md-nav__link> <span class=md-ellipsis> CelesTrak </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/datasets/groundstations.html class=md-nav__link> <span class=md-ellipsis> Groundstations </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/datasets/naif.html class=md-nav__link> <span class=md-ellipsis> NAIF </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_18> <div class="md-nav__link md-nav__container"> <a href=../../library_api/utils/index.html class="md-nav__link "> <span class=md-ellipsis> Utilities </span> </a> <label class="md-nav__link " for=__nav_4_18 id=__nav_4_18_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_18_label aria-expanded=false> <label class=md-nav__title for=__nav_4_18> <span class="md-nav__icon md-icon"></span> Utilities </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/utils/caching.html class=md-nav__link> <span class=md-ellipsis> Caching </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/utils/threading.html class=md-nav__link> <span class=md-ellipsis> Multithreading </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/utils/formatting.html class=md-nav__link> <span class=md-ellipsis> String Formatting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_19> <div class="md-nav__link md-nav__container"> <a href=../../library_api/plots/index.html class="md-nav__link "> <span class=md-ellipsis> Plots </span> </a> <label class="md-nav__link " for=__nav_4_19 id=__nav_4_19_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_19_label aria-expanded=false> <label class=md-nav__title for=__nav_4_19> <span class="md-nav__icon md-icon"></span> Plots </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../library_api/plots/ground_tracks.html class=md-nav__link> <span class=md-ellipsis> Ground Tracks </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/plots/orbital_trajectories.html class=md-nav__link> <span class=md-ellipsis> Orbital Trajectories </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/plots/3d_trajectory.html class=md-nav__link> <span class=md-ellipsis> 3D Trajectory </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/plots/access_geometry.html class=md-nav__link> <span class=md-ellipsis> Access Geometry </span> </a> </li> <li class=md-nav__item> <a href=../../library_api/plots/gabbard.html class=md-nav__link> <span class=md-ellipsis> Gabbard Diagram </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://docs.rs/brahe class=md-nav__link> <span class=md-ellipsis> Rust API Reference </span> </a> </li> <li class=md-nav__item> <a href=https://duncaneddy.com class=md-nav__link> <span class=md-ellipsis> About Me </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#what-is-numerical-integration class=md-nav__link> <span class=md-ellipsis> What is Numerical Integration? </span> </a> </li> <li class=md-nav__item> <a href=#available-integrators class=md-nav__link> <span class=md-ellipsis> Available Integrators </span> </a> </li> <li class=md-nav__item> <a href=#common-interfaces class=md-nav__link> <span class=md-ellipsis> Common Interfaces </span> </a> <nav class=md-nav aria-label="Common Interfaces"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#core-types class=md-nav__link> <span class=md-ellipsis> Core Types </span> </a> </li> <li class=md-nav__item> <a href=#dynamics-function-signature class=md-nav__link> <span class=md-ellipsis> Dynamics Function Signature </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#control-input-function-signature class=md-nav__link> <span class=md-ellipsis> Control Input Function Signature </span> </a> <nav class=md-nav aria-label="Control Input Function Signature"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#integration-methods class=md-nav__link> <span class=md-ellipsis> Integration Methods </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#comparing-integrator-accuracy class=md-nav__link> <span class=md-ellipsis> Comparing Integrator Accuracy </span> </a> </li> <li class=md-nav__item> <a href=#basic-usage-patterns class=md-nav__link> <span class=md-ellipsis> Basic Usage Patterns </span> </a> <nav class=md-nav aria-label="Basic Usage Patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fixed-step-integration class=md-nav__link> <span class=md-ellipsis> Fixed-Step Integration </span> </a> </li> <li class=md-nav__item> <a href=#adaptive-integration class=md-nav__link> <span class=md-ellipsis> Adaptive Integration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#state-transition-matrix-propagation class=md-nav__link> <span class=md-ellipsis> State Transition Matrix Propagation </span> </a> </li> <li class=md-nav__item> <a href=#module-contents class=md-nav__link> <span class=md-ellipsis> Module Contents </span> </a> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=numerical-integration>Numerical Integration<a class=headerlink href=#numerical-integration title="Permanent link">&para;</a></h1> <p>Numerical integration is fundamental to spacecraft trajectory propagation, orbit determination, and mission planning. Brahe provides multiple integration methods optimized for different accuracy and performance requirements.</p> <div class="admonition warning"> <p class=admonition-title>Experimental API</p> <p>The integrators module is currently experimental. While the core functionality should be stable, the API may change in future <strong>MINOR</strong> releases as we refine the design and add features.</p> </div> <h2 id=what-is-numerical-integration>What is Numerical Integration?<a class=headerlink href=#what-is-numerical-integration title="Permanent link">&para;</a></h2> <p>Numerical integration solves ordinary differential equations (ODEs) of the form:</p> <div class=arithmatex>\[\dot{\mathbf{x}} = \mathbf{f}(t, \mathbf{x})\]</div> <p><span class=arithmatex>\(\mathbf{x}\)</span> is the state vector, typically position and velocity <span class=arithmatex>\(\mathbf{x} = \begin{bmatrix} \mathbf{p} \\ \mathbf{v} \end{bmatrix}\)</span>, and <span class=arithmatex>\(\mathbf{f}\)</span> defines the dynamics (gravity, perturbations, thrust, etc.). The integrator advances the state forward in time from an initial condition <span class=arithmatex>\(\mathbf{x}_0\)</span> at time <span class=arithmatex>\(t_0\)</span> to <span class=arithmatex>\(\mathbf{x}(t)\)</span> at some future time <span class=arithmatex>\(t\)</span>.</p> <p>In an ideal world, we would have closed-form analytical solutions for these equations. However, real-world dynamics are often too complex for exact solutions, necessitating numerical methods that approximate the solution. It is often much easier to write down the equations for the dynamics (force models) than to derive analytical solutions for them. Numerical integrators provide a way to compute these approximations efficiently and accurately.</p> <h2 id=available-integrators>Available Integrators<a class=headerlink href=#available-integrators title="Permanent link">&para;</a></h2> <p>Brahe provides four integration methods with different accuracy and performance characteristics:</p> <div class=center-table> <table> <thead> <tr> <th>Integrator</th> <th>Order</th> <th>Type</th> <th>Stages</th> </tr> </thead> <tbody> <tr> <td><strong>RK4</strong></td> <td>4</td> <td>Fixed</td> <td>4</td> </tr> <tr> <td><strong>RKF45</strong></td> <td>4(5)</td> <td>Adaptive</td> <td>6</td> </tr> <tr> <td><strong>DP54</strong></td> <td>5(4)</td> <td>Adaptive</td> <td>7 (6 effective)</td> </tr> <tr> <td><strong>RKN1210</strong></td> <td>12(10)</td> <td>Adaptive</td> <td>17</td> </tr> </tbody> </table> </div> <h2 id=common-interfaces>Common Interfaces<a class=headerlink href=#common-interfaces title="Permanent link">&para;</a></h2> <p>All integrators implement a consistent interface, making it easy to switch between methods.</p> <h3 id=core-types>Core Types<a class=headerlink href=#core-types title="Permanent link">&para;</a></h3> <p><strong><code>IntegratorConfig</code></strong>: Configuration controlling integration behavior</p> <ul> <li><code>abs_tol</code>, <code>rel_tol</code>: Error tolerances (adaptive mode)</li> <li><code>min_step</code>, <code>max_step</code>: Step size bounds</li> <li><code>step_safety_factor</code>: Conservative factor for step size adjustment (default 0.9)</li> </ul> <p><strong><code>AdaptiveStepResult</code></strong>: Result from adaptive integration step</p> <ul> <li><code>state</code>: New state vector after integration</li> <li><code>dt_used</code>: Actual time step taken (may differ from requested)</li> <li><code>error_estimate</code>: Estimated error in the step</li> <li><code>dt_next</code>: Recommended step size for next integration</li> </ul> <h3 id=dynamics-function-signature>Dynamics Function Signature<a class=headerlink href=#dynamics-function-signature title="Permanent link">&para;</a></h3> <h2 id=control-input-function-signature>Control Input Function Signature<a class=headerlink href=#control-input-function-signature title="Permanent link">&para;</a></h2> <p>The control input function must follow specific signatures depending on the language:</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Python</label><label for=__tabbed_1_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1> 1</a></span>
<span class=normal><a href=#__codelineno-0-2> 2</a></span>
<span class=normal><a href=#__codelineno-0-3> 3</a></span>
<span class=normal><a href=#__codelineno-0-4> 4</a></span>
<span class=normal><a href=#__codelineno-0-5> 5</a></span>
<span class=normal><a href=#__codelineno-0-6> 6</a></span>
<span class=normal><a href=#__codelineno-0-7> 7</a></span>
<span class=normal><a href=#__codelineno-0-8> 8</a></span>
<span class=normal><a href=#__codelineno-0-9> 9</a></span>
<span class=normal><a href=#__codelineno-0-10>10</a></span>
<span class=normal><a href=#__codelineno-0-11>11</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span><span class=w> </span><span class=nf>dynamics_fn</span><span class=p>(</span><span class=n>t</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>state</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><span class=sd>    Args:</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><span class=sd>        t: Current time</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><span class=sd>        state: Current state vector</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><span class=sd>        params: Fixed auxiliary parameters</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><span class=sd>    Returns:</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><span class=sd>        d_state: Derivative of state vector</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <p>Must be a closure or function with the signature, that either uses dynamic or static sized vectors:</p> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-1-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1></a><span class=nb>Fn</span><span class=p>(</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=n>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=p>,</span><span class=w> </span><span class=n>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span>
</span></code></pre></div></td></tr></table></div> <p>or</p> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-2-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1></a><span class=nb>Fn</span><span class=p>(</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=n>SVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=n>S</span><span class=o>&gt;</span><span class=p>,</span><span class=w> </span><span class=n>SVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=n>P</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>SVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=n>S</span><span class=o>&gt;</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <h3 id=integration-methods>Integration Methods<a class=headerlink href=#integration-methods title="Permanent link">&para;</a></h3> <p>All integrators provide these methods:</p> <p><strong><code>step(t, state, dt)</code></strong>: Advance state by one time step</p> <ul> <li>For fixed-step integrators: Returns new state</li> <li>For adaptive integrators: Returns <code>AdaptiveStepResult</code></li> </ul> <p><strong><code>step_with_varmat(t, state, phi, dt)</code></strong>: Advance state and state transition matrix</p> <ul> <li>Propagates both state and variational equations</li> <li>Requires a Jacobian provider</li> <li>Essential for orbit determination and uncertainty propagation</li> </ul> <h2 id=comparing-integrator-accuracy>Comparing Integrator Accuracy<a class=headerlink href=#comparing-integrator-accuracy title="Permanent link">&para;</a></h2> <p>The plot below shows position error vs. time for different integrators propagating a highly elliptical orbit (HEO) compared to analytical Keplerian propagation. All adaptive integrators use the same tolerances (abs_tol=1e-10, rel_tol=1e-9). In the figure, we can see that after one orbit, RKN1210 achieves sub-millimeter accuracy, while DP54 and RKF45 reach meter-level accuracy. The fixed-step RK4 with a 60s step has the most error, reaching about 1000m after one orbit.</p> <div class=plotly-embed> <iframe class=only-light src=../../figures/integrator_accuracy_comparison_light.html loading=lazy></iframe> <iframe class=only-dark src=../../figures/integrator_accuracy_comparison_dark.html loading=lazy></iframe> </div> <details> <summary>Plot Source</summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>integrator_accuracy_comparison.py</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-3-1>  1</a></span>
<span class=normal><a href=#__codelineno-3-2>  2</a></span>
<span class=normal><a href=#__codelineno-3-3>  3</a></span>
<span class=normal><a href=#__codelineno-3-4>  4</a></span>
<span class=normal><a href=#__codelineno-3-5>  5</a></span>
<span class=normal><a href=#__codelineno-3-6>  6</a></span>
<span class=normal><a href=#__codelineno-3-7>  7</a></span>
<span class=normal><a href=#__codelineno-3-8>  8</a></span>
<span class=normal><a href=#__codelineno-3-9>  9</a></span>
<span class=normal><a href=#__codelineno-3-10> 10</a></span>
<span class=normal><a href=#__codelineno-3-11> 11</a></span>
<span class=normal><a href=#__codelineno-3-12> 12</a></span>
<span class=normal><a href=#__codelineno-3-13> 13</a></span>
<span class=normal><a href=#__codelineno-3-14> 14</a></span>
<span class=normal><a href=#__codelineno-3-15> 15</a></span>
<span class=normal><a href=#__codelineno-3-16> 16</a></span>
<span class=normal><a href=#__codelineno-3-17> 17</a></span>
<span class=normal><a href=#__codelineno-3-18> 18</a></span>
<span class=normal><a href=#__codelineno-3-19> 19</a></span>
<span class=normal><a href=#__codelineno-3-20> 20</a></span>
<span class=normal><a href=#__codelineno-3-21> 21</a></span>
<span class=normal><a href=#__codelineno-3-22> 22</a></span>
<span class=normal><a href=#__codelineno-3-23> 23</a></span>
<span class=normal><a href=#__codelineno-3-24> 24</a></span>
<span class=normal><a href=#__codelineno-3-25> 25</a></span>
<span class=normal><a href=#__codelineno-3-26> 26</a></span>
<span class=normal><a href=#__codelineno-3-27> 27</a></span>
<span class=normal><a href=#__codelineno-3-28> 28</a></span>
<span class=normal><a href=#__codelineno-3-29> 29</a></span>
<span class=normal><a href=#__codelineno-3-30> 30</a></span>
<span class=normal><a href=#__codelineno-3-31> 31</a></span>
<span class=normal><a href=#__codelineno-3-32> 32</a></span>
<span class=normal><a href=#__codelineno-3-33> 33</a></span>
<span class=normal><a href=#__codelineno-3-34> 34</a></span>
<span class=normal><a href=#__codelineno-3-35> 35</a></span>
<span class=normal><a href=#__codelineno-3-36> 36</a></span>
<span class=normal><a href=#__codelineno-3-37> 37</a></span>
<span class=normal><a href=#__codelineno-3-38> 38</a></span>
<span class=normal><a href=#__codelineno-3-39> 39</a></span>
<span class=normal><a href=#__codelineno-3-40> 40</a></span>
<span class=normal><a href=#__codelineno-3-41> 41</a></span>
<span class=normal><a href=#__codelineno-3-42> 42</a></span>
<span class=normal><a href=#__codelineno-3-43> 43</a></span>
<span class=normal><a href=#__codelineno-3-44> 44</a></span>
<span class=normal><a href=#__codelineno-3-45> 45</a></span>
<span class=normal><a href=#__codelineno-3-46> 46</a></span>
<span class=normal><a href=#__codelineno-3-47> 47</a></span>
<span class=normal><a href=#__codelineno-3-48> 48</a></span>
<span class=normal><a href=#__codelineno-3-49> 49</a></span>
<span class=normal><a href=#__codelineno-3-50> 50</a></span>
<span class=normal><a href=#__codelineno-3-51> 51</a></span>
<span class=normal><a href=#__codelineno-3-52> 52</a></span>
<span class=normal><a href=#__codelineno-3-53> 53</a></span>
<span class=normal><a href=#__codelineno-3-54> 54</a></span>
<span class=normal><a href=#__codelineno-3-55> 55</a></span>
<span class=normal><a href=#__codelineno-3-56> 56</a></span>
<span class=normal><a href=#__codelineno-3-57> 57</a></span>
<span class=normal><a href=#__codelineno-3-58> 58</a></span>
<span class=normal><a href=#__codelineno-3-59> 59</a></span>
<span class=normal><a href=#__codelineno-3-60> 60</a></span>
<span class=normal><a href=#__codelineno-3-61> 61</a></span>
<span class=normal><a href=#__codelineno-3-62> 62</a></span>
<span class=normal><a href=#__codelineno-3-63> 63</a></span>
<span class=normal><a href=#__codelineno-3-64> 64</a></span>
<span class=normal><a href=#__codelineno-3-65> 65</a></span>
<span class=normal><a href=#__codelineno-3-66> 66</a></span>
<span class=normal><a href=#__codelineno-3-67> 67</a></span>
<span class=normal><a href=#__codelineno-3-68> 68</a></span>
<span class=normal><a href=#__codelineno-3-69> 69</a></span>
<span class=normal><a href=#__codelineno-3-70> 70</a></span>
<span class=normal><a href=#__codelineno-3-71> 71</a></span>
<span class=normal><a href=#__codelineno-3-72> 72</a></span>
<span class=normal><a href=#__codelineno-3-73> 73</a></span>
<span class=normal><a href=#__codelineno-3-74> 74</a></span>
<span class=normal><a href=#__codelineno-3-75> 75</a></span>
<span class=normal><a href=#__codelineno-3-76> 76</a></span>
<span class=normal><a href=#__codelineno-3-77> 77</a></span>
<span class=normal><a href=#__codelineno-3-78> 78</a></span>
<span class=normal><a href=#__codelineno-3-79> 79</a></span>
<span class=normal><a href=#__codelineno-3-80> 80</a></span>
<span class=normal><a href=#__codelineno-3-81> 81</a></span>
<span class=normal><a href=#__codelineno-3-82> 82</a></span>
<span class=normal><a href=#__codelineno-3-83> 83</a></span>
<span class=normal><a href=#__codelineno-3-84> 84</a></span>
<span class=normal><a href=#__codelineno-3-85> 85</a></span>
<span class=normal><a href=#__codelineno-3-86> 86</a></span>
<span class=normal><a href=#__codelineno-3-87> 87</a></span>
<span class=normal><a href=#__codelineno-3-88> 88</a></span>
<span class=normal><a href=#__codelineno-3-89> 89</a></span>
<span class=normal><a href=#__codelineno-3-90> 90</a></span>
<span class=normal><a href=#__codelineno-3-91> 91</a></span>
<span class=normal><a href=#__codelineno-3-92> 92</a></span>
<span class=normal><a href=#__codelineno-3-93> 93</a></span>
<span class=normal><a href=#__codelineno-3-94> 94</a></span>
<span class=normal><a href=#__codelineno-3-95> 95</a></span>
<span class=normal><a href=#__codelineno-3-96> 96</a></span>
<span class=normal><a href=#__codelineno-3-97> 97</a></span>
<span class=normal><a href=#__codelineno-3-98> 98</a></span>
<span class=normal><a href=#__codelineno-3-99> 99</a></span>
<span class=normal><a href=#__codelineno-3-100>100</a></span>
<span class=normal><a href=#__codelineno-3-101>101</a></span>
<span class=normal><a href=#__codelineno-3-102>102</a></span>
<span class=normal><a href=#__codelineno-3-103>103</a></span>
<span class=normal><a href=#__codelineno-3-104>104</a></span>
<span class=normal><a href=#__codelineno-3-105>105</a></span>
<span class=normal><a href=#__codelineno-3-106>106</a></span>
<span class=normal><a href=#__codelineno-3-107>107</a></span>
<span class=normal><a href=#__codelineno-3-108>108</a></span>
<span class=normal><a href=#__codelineno-3-109>109</a></span>
<span class=normal><a href=#__codelineno-3-110>110</a></span>
<span class=normal><a href=#__codelineno-3-111>111</a></span>
<span class=normal><a href=#__codelineno-3-112>112</a></span>
<span class=normal><a href=#__codelineno-3-113>113</a></span>
<span class=normal><a href=#__codelineno-3-114>114</a></span>
<span class=normal><a href=#__codelineno-3-115>115</a></span>
<span class=normal><a href=#__codelineno-3-116>116</a></span>
<span class=normal><a href=#__codelineno-3-117>117</a></span>
<span class=normal><a href=#__codelineno-3-118>118</a></span>
<span class=normal><a href=#__codelineno-3-119>119</a></span>
<span class=normal><a href=#__codelineno-3-120>120</a></span>
<span class=normal><a href=#__codelineno-3-121>121</a></span>
<span class=normal><a href=#__codelineno-3-122>122</a></span>
<span class=normal><a href=#__codelineno-3-123>123</a></span>
<span class=normal><a href=#__codelineno-3-124>124</a></span>
<span class=normal><a href=#__codelineno-3-125>125</a></span>
<span class=normal><a href=#__codelineno-3-126>126</a></span>
<span class=normal><a href=#__codelineno-3-127>127</a></span>
<span class=normal><a href=#__codelineno-3-128>128</a></span>
<span class=normal><a href=#__codelineno-3-129>129</a></span>
<span class=normal><a href=#__codelineno-3-130>130</a></span>
<span class=normal><a href=#__codelineno-3-131>131</a></span>
<span class=normal><a href=#__codelineno-3-132>132</a></span>
<span class=normal><a href=#__codelineno-3-133>133</a></span>
<span class=normal><a href=#__codelineno-3-134>134</a></span>
<span class=normal><a href=#__codelineno-3-135>135</a></span>
<span class=normal><a href=#__codelineno-3-136>136</a></span>
<span class=normal><a href=#__codelineno-3-137>137</a></span>
<span class=normal><a href=#__codelineno-3-138>138</a></span>
<span class=normal><a href=#__codelineno-3-139>139</a></span>
<span class=normal><a href=#__codelineno-3-140>140</a></span>
<span class=normal><a href=#__codelineno-3-141>141</a></span>
<span class=normal><a href=#__codelineno-3-142>142</a></span>
<span class=normal><a href=#__codelineno-3-143>143</a></span>
<span class=normal><a href=#__codelineno-3-144>144</a></span>
<span class=normal><a href=#__codelineno-3-145>145</a></span>
<span class=normal><a href=#__codelineno-3-146>146</a></span>
<span class=normal><a href=#__codelineno-3-147>147</a></span>
<span class=normal><a href=#__codelineno-3-148>148</a></span>
<span class=normal><a href=#__codelineno-3-149>149</a></span>
<span class=normal><a href=#__codelineno-3-150>150</a></span>
<span class=normal><a href=#__codelineno-3-151>151</a></span>
<span class=normal><a href=#__codelineno-3-152>152</a></span>
<span class=normal><a href=#__codelineno-3-153>153</a></span>
<span class=normal><a href=#__codelineno-3-154>154</a></span>
<span class=normal><a href=#__codelineno-3-155>155</a></span>
<span class=normal><a href=#__codelineno-3-156>156</a></span>
<span class=normal><a href=#__codelineno-3-157>157</a></span>
<span class=normal><a href=#__codelineno-3-158>158</a></span>
<span class=normal><a href=#__codelineno-3-159>159</a></span>
<span class=normal><a href=#__codelineno-3-160>160</a></span>
<span class=normal><a href=#__codelineno-3-161>161</a></span>
<span class=normal><a href=#__codelineno-3-162>162</a></span>
<span class=normal><a href=#__codelineno-3-163>163</a></span>
<span class=normal><a href=#__codelineno-3-164>164</a></span>
<span class=normal><a href=#__codelineno-3-165>165</a></span>
<span class=normal><a href=#__codelineno-3-166>166</a></span>
<span class=normal><a href=#__codelineno-3-167>167</a></span>
<span class=normal><a href=#__codelineno-3-168>168</a></span>
<span class=normal><a href=#__codelineno-3-169>169</a></span>
<span class=normal><a href=#__codelineno-3-170>170</a></span>
<span class=normal><a href=#__codelineno-3-171>171</a></span>
<span class=normal><a href=#__codelineno-3-172>172</a></span>
<span class=normal><a href=#__codelineno-3-173>173</a></span>
<span class=normal><a href=#__codelineno-3-174>174</a></span>
<span class=normal><a href=#__codelineno-3-175>175</a></span>
<span class=normal><a href=#__codelineno-3-176>176</a></span>
<span class=normal><a href=#__codelineno-3-177>177</a></span>
<span class=normal><a href=#__codelineno-3-178>178</a></span>
<span class=normal><a href=#__codelineno-3-179>179</a></span>
<span class=normal><a href=#__codelineno-3-180>180</a></span>
<span class=normal><a href=#__codelineno-3-181>181</a></span>
<span class=normal><a href=#__codelineno-3-182>182</a></span>
<span class=normal><a href=#__codelineno-3-183>183</a></span>
<span class=normal><a href=#__codelineno-3-184>184</a></span>
<span class=normal><a href=#__codelineno-3-185>185</a></span>
<span class=normal><a href=#__codelineno-3-186>186</a></span>
<span class=normal><a href=#__codelineno-3-187>187</a></span>
<span class=normal><a href=#__codelineno-3-188>188</a></span>
<span class=normal><a href=#__codelineno-3-189>189</a></span>
<span class=normal><a href=#__codelineno-3-190>190</a></span>
<span class=normal><a href=#__codelineno-3-191>191</a></span>
<span class=normal><a href=#__codelineno-3-192>192</a></span>
<span class=normal><a href=#__codelineno-3-193>193</a></span>
<span class=normal><a href=#__codelineno-3-194>194</a></span>
<span class=normal><a href=#__codelineno-3-195>195</a></span>
<span class=normal><a href=#__codelineno-3-196>196</a></span>
<span class=normal><a href=#__codelineno-3-197>197</a></span>
<span class=normal><a href=#__codelineno-3-198>198</a></span>
<span class=normal><a href=#__codelineno-3-199>199</a></span>
<span class=normal><a href=#__codelineno-3-200>200</a></span>
<span class=normal><a href=#__codelineno-3-201>201</a></span>
<span class=normal><a href=#__codelineno-3-202>202</a></span>
<span class=normal><a href=#__codelineno-3-203>203</a></span>
<span class=normal><a href=#__codelineno-3-204>204</a></span>
<span class=normal><a href=#__codelineno-3-205>205</a></span>
<span class=normal><a href=#__codelineno-3-206>206</a></span>
<span class=normal><a href=#__codelineno-3-207>207</a></span>
<span class=normal><a href=#__codelineno-3-208>208</a></span>
<span class=normal><a href=#__codelineno-3-209>209</a></span>
<span class=normal><a href=#__codelineno-3-210>210</a></span>
<span class=normal><a href=#__codelineno-3-211>211</a></span>
<span class=normal><a href=#__codelineno-3-212>212</a></span>
<span class=normal><a href=#__codelineno-3-213>213</a></span>
<span class=normal><a href=#__codelineno-3-214>214</a></span>
<span class=normal><a href=#__codelineno-3-215>215</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2></a><span class=kn>import</span><span class=w> </span><span class=nn>pathlib</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3></a><span class=kn>import</span><span class=w> </span><span class=nn>sys</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4></a><span class=kn>import</span><span class=w> </span><span class=nn>plotly.graph_objects</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>go</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7></a>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8></a><span class=c1># Add plots directory to path for importing brahe_theme</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9></a><span class=n>sys</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>(</span><span class=vm>__file__</span><span class=p>)</span><span class=o>.</span><span class=n>parent</span><span class=p>))</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10></a><span class=kn>from</span><span class=w> </span><span class=nn>brahe_theme</span><span class=w> </span><span class=kn>import</span> <span class=n>save_themed_html</span><span class=p>,</span> <span class=n>get_color_sequence</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11></a>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12></a><span class=c1># Configuration</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13></a><span class=n>SCRIPT_NAME</span> <span class=o>=</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>(</span><span class=vm>__file__</span><span class=p>)</span><span class=o>.</span><span class=n>stem</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14></a><span class=n>OUTDIR</span> <span class=o>=</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;BRAHE_FIGURE_OUTPUT_DIR&quot;</span><span class=p>,</span> <span class=s2>&quot;./docs/figures/&quot;</span><span class=p>))</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15></a>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16></a><span class=c1># Ensure output directory exists</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17></a><span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>OUTDIR</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18></a>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19></a><span class=c1># Initialize Brahe</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20></a><span class=n>bh</span><span class=o>.</span><span class=n>initialize_eop</span><span class=p>()</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21></a>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22></a><span class=c1># Define Molniya-type HEO orbit</span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23></a><span class=c1># Semi-major axis for 12-hour period</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24></a><span class=n>a</span> <span class=o>=</span> <span class=mf>26554e3</span>  <span class=c1># meters</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25></a><span class=n>e</span> <span class=o>=</span> <span class=mf>0.74</span>  <span class=c1># eccentricity</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26></a><span class=n>i</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=mf>63.4</span><span class=p>)</span>  <span class=c1># inclination (critical inclination)</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27></a><span class=n>omega</span> <span class=o>=</span> <span class=mf>0.0</span>  <span class=c1># argument of perigee</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28></a><span class=n>Omega</span> <span class=o>=</span> <span class=mf>0.0</span>  <span class=c1># RAAN</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29></a><span class=n>M0</span> <span class=o>=</span> <span class=mf>0.0</span>  <span class=c1># mean anomaly</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30></a>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31></a><span class=c1># Convert to Cartesian state</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32></a><span class=n>oe</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>a</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>Omega</span><span class=p>,</span> <span class=n>omega</span><span class=p>,</span> <span class=n>M0</span><span class=p>])</span>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33></a><span class=n>initial_state</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe</span><span class=p>,</span> <span class=n>bh</span><span class=o>.</span><span class=n>AngleFormat</span><span class=o>.</span><span class=n>RADIANS</span><span class=p>)</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34></a>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35></a><span class=c1># Orbital period</span>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36></a><span class=n>period</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>a</span><span class=o>**</span><span class=mi>3</span> <span class=o>/</span> <span class=n>bh</span><span class=o>.</span><span class=n>GM_EARTH</span><span class=p>)</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37></a>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38></a>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39></a><span class=c1># Define two-body dynamics</span>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40></a><span class=k>def</span><span class=w> </span><span class=nf>two_body_dynamics</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>state</span><span class=p>):</span>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Simple two-body dynamics for integration.&quot;&quot;&quot;</span>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42></a>    <span class=n>mu</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>GM_EARTH</span>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43></a>    <span class=n>r</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span>
</span><span id=__span-3-44><a id=__codelineno-3-44 name=__codelineno-3-44></a>    <span class=n>v</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>6</span><span class=p>]</span>
</span><span id=__span-3-45><a id=__codelineno-3-45 name=__codelineno-3-45></a>    <span class=n>r_norm</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span><span id=__span-3-46><a id=__codelineno-3-46 name=__codelineno-3-46></a>    <span class=n>a</span> <span class=o>=</span> <span class=o>-</span><span class=n>mu</span> <span class=o>/</span> <span class=n>r_norm</span><span class=o>**</span><span class=mi>3</span> <span class=o>*</span> <span class=n>r</span>
</span><span id=__span-3-47><a id=__codelineno-3-47 name=__codelineno-3-47></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>v</span><span class=p>,</span> <span class=n>a</span><span class=p>])</span>
</span><span id=__span-3-48><a id=__codelineno-3-48 name=__codelineno-3-48></a>
</span><span id=__span-3-49><a id=__codelineno-3-49 name=__codelineno-3-49></a>
</span><span id=__span-3-50><a id=__codelineno-3-50 name=__codelineno-3-50></a><span class=c1># Analytical solution using Keplerian propagation</span>
</span><span id=__span-3-51><a id=__codelineno-3-51 name=__codelineno-3-51></a><span class=k>def</span><span class=w> </span><span class=nf>analytical_solution</span><span class=p>(</span><span class=n>t</span><span class=p>):</span>
</span><span id=__span-3-52><a id=__codelineno-3-52 name=__codelineno-3-52></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Compute analytical Keplerian state at time t.&quot;&quot;&quot;</span>
</span><span id=__span-3-53><a id=__codelineno-3-53 name=__codelineno-3-53></a>    <span class=c1># Mean motion</span>
</span><span id=__span-3-54><a id=__codelineno-3-54 name=__codelineno-3-54></a>    <span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>bh</span><span class=o>.</span><span class=n>GM_EARTH</span> <span class=o>/</span> <span class=n>a</span><span class=o>**</span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-3-55><a id=__codelineno-3-55 name=__codelineno-3-55></a>    <span class=c1># Mean anomaly at time t</span>
</span><span id=__span-3-56><a id=__codelineno-3-56 name=__codelineno-3-56></a>    <span class=n>M</span> <span class=o>=</span> <span class=n>M0</span> <span class=o>+</span> <span class=n>n</span> <span class=o>*</span> <span class=n>t</span>
</span><span id=__span-3-57><a id=__codelineno-3-57 name=__codelineno-3-57></a>    <span class=c1># Convert back to Cartesian</span>
</span><span id=__span-3-58><a id=__codelineno-3-58 name=__codelineno-3-58></a>    <span class=n>oe_t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>a</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>Omega</span><span class=p>,</span> <span class=n>omega</span><span class=p>,</span> <span class=n>M</span><span class=p>])</span>
</span><span id=__span-3-59><a id=__codelineno-3-59 name=__codelineno-3-59></a>    <span class=k>return</span> <span class=n>bh</span><span class=o>.</span><span class=n>state_osculating_to_cartesian</span><span class=p>(</span><span class=n>oe_t</span><span class=p>,</span> <span class=n>bh</span><span class=o>.</span><span class=n>AngleFormat</span><span class=o>.</span><span class=n>RADIANS</span><span class=p>)</span>
</span><span id=__span-3-60><a id=__codelineno-3-60 name=__codelineno-3-60></a>
</span><span id=__span-3-61><a id=__codelineno-3-61 name=__codelineno-3-61></a>
</span><span id=__span-3-62><a id=__codelineno-3-62 name=__codelineno-3-62></a><span class=c1># Integration parameters</span>
</span><span id=__span-3-63><a id=__codelineno-3-63 name=__codelineno-3-63></a><span class=n>t_start</span> <span class=o>=</span> <span class=mf>0.0</span>
</span><span id=__span-3-64><a id=__codelineno-3-64 name=__codelineno-3-64></a><span class=n>t_end</span> <span class=o>=</span> <span class=n>period</span>  <span class=c1># One orbital period</span>
</span><span id=__span-3-65><a id=__codelineno-3-65 name=__codelineno-3-65></a><span class=n>output_interval</span> <span class=o>=</span> <span class=mf>60.0</span>  <span class=c1># Output every 60 seconds</span>
</span><span id=__span-3-66><a id=__codelineno-3-66 name=__codelineno-3-66></a>
</span><span id=__span-3-67><a id=__codelineno-3-67 name=__codelineno-3-67></a><span class=c1># Common configuration for adaptive integrators</span>
</span><span id=__span-3-68><a id=__codelineno-3-68 name=__codelineno-3-68></a><span class=n>abs_tol</span> <span class=o>=</span> <span class=mf>1e-10</span>
</span><span id=__span-3-69><a id=__codelineno-3-69 name=__codelineno-3-69></a><span class=n>rel_tol</span> <span class=o>=</span> <span class=mf>1e-9</span>
</span><span id=__span-3-70><a id=__codelineno-3-70 name=__codelineno-3-70></a>
</span><span id=__span-3-71><a id=__codelineno-3-71 name=__codelineno-3-71></a><span class=c1># Create integrators</span>
</span><span id=__span-3-72><a id=__codelineno-3-72 name=__codelineno-3-72></a><span class=n>config_rk4</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>IntegratorConfig</span><span class=o>.</span><span class=n>fixed_step</span><span class=p>(</span><span class=n>step_size</span><span class=o>=</span><span class=mf>60.0</span><span class=p>)</span>
</span><span id=__span-3-73><a id=__codelineno-3-73 name=__codelineno-3-73></a><span class=n>config_adaptive</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>IntegratorConfig</span><span class=o>.</span><span class=n>adaptive</span><span class=p>(</span><span class=n>abs_tol</span><span class=o>=</span><span class=n>abs_tol</span><span class=p>,</span> <span class=n>rel_tol</span><span class=o>=</span><span class=n>rel_tol</span><span class=p>)</span>
</span><span id=__span-3-74><a id=__codelineno-3-74 name=__codelineno-3-74></a>
</span><span id=__span-3-75><a id=__codelineno-3-75 name=__codelineno-3-75></a><span class=n>integrator_rk4</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>RK4Integrator</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=n>two_body_dynamics</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config_rk4</span><span class=p>)</span>
</span><span id=__span-3-76><a id=__codelineno-3-76 name=__codelineno-3-76></a><span class=n>integrator_rkf45</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>RKF45Integrator</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=n>two_body_dynamics</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config_adaptive</span><span class=p>)</span>
</span><span id=__span-3-77><a id=__codelineno-3-77 name=__codelineno-3-77></a><span class=n>integrator_dp54</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>DP54Integrator</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=n>two_body_dynamics</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config_adaptive</span><span class=p>)</span>
</span><span id=__span-3-78><a id=__codelineno-3-78 name=__codelineno-3-78></a><span class=n>integrator_rkn1210</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>RKN1210Integrator</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=n>two_body_dynamics</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config_adaptive</span><span class=p>)</span>
</span><span id=__span-3-79><a id=__codelineno-3-79 name=__codelineno-3-79></a>
</span><span id=__span-3-80><a id=__codelineno-3-80 name=__codelineno-3-80></a>
</span><span id=__span-3-81><a id=__codelineno-3-81 name=__codelineno-3-81></a><span class=c1># Propagate with each integrator</span>
</span><span id=__span-3-82><a id=__codelineno-3-82 name=__codelineno-3-82></a><span class=k>def</span><span class=w> </span><span class=nf>propagate</span><span class=p>(</span><span class=n>integrator</span><span class=p>,</span> <span class=n>is_adaptive</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-3-83><a id=__codelineno-3-83 name=__codelineno-3-83></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Propagate orbit and record states at output intervals.&quot;&quot;&quot;</span>
</span><span id=__span-3-84><a id=__codelineno-3-84 name=__codelineno-3-84></a>    <span class=n>times</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-3-85><a id=__codelineno-3-85 name=__codelineno-3-85></a>    <span class=n>states</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-3-86><a id=__codelineno-3-86 name=__codelineno-3-86></a>    <span class=n>errors</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-3-87><a id=__codelineno-3-87 name=__codelineno-3-87></a>
</span><span id=__span-3-88><a id=__codelineno-3-88 name=__codelineno-3-88></a>    <span class=n>t</span> <span class=o>=</span> <span class=n>t_start</span>
</span><span id=__span-3-89><a id=__codelineno-3-89 name=__codelineno-3-89></a>    <span class=n>state</span> <span class=o>=</span> <span class=n>initial_state</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-3-90><a id=__codelineno-3-90 name=__codelineno-3-90></a>    <span class=n>dt</span> <span class=o>=</span> <span class=mf>60.0</span>  <span class=c1># Initial step guess</span>
</span><span id=__span-3-91><a id=__codelineno-3-91 name=__codelineno-3-91></a>    <span class=n>next_output</span> <span class=o>=</span> <span class=mf>0.0</span>
</span><span id=__span-3-92><a id=__codelineno-3-92 name=__codelineno-3-92></a>
</span><span id=__span-3-93><a id=__codelineno-3-93 name=__codelineno-3-93></a>    <span class=k>while</span> <span class=n>t</span> <span class=o>&lt;</span> <span class=n>t_end</span><span class=p>:</span>
</span><span id=__span-3-94><a id=__codelineno-3-94 name=__codelineno-3-94></a>        <span class=c1># Check if we should save output</span>
</span><span id=__span-3-95><a id=__codelineno-3-95 name=__codelineno-3-95></a>        <span class=k>if</span> <span class=n>t</span> <span class=o>&gt;=</span> <span class=n>next_output</span><span class=p>:</span>
</span><span id=__span-3-96><a id=__codelineno-3-96 name=__codelineno-3-96></a>            <span class=n>times</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-3-97><a id=__codelineno-3-97 name=__codelineno-3-97></a>            <span class=n>states</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>state</span><span class=o>.</span><span class=n>copy</span><span class=p>())</span>
</span><span id=__span-3-98><a id=__codelineno-3-98 name=__codelineno-3-98></a>
</span><span id=__span-3-99><a id=__codelineno-3-99 name=__codelineno-3-99></a>            <span class=c1># Compute error vs analytical solution</span>
</span><span id=__span-3-100><a id=__codelineno-3-100 name=__codelineno-3-100></a>            <span class=n>analytical</span> <span class=o>=</span> <span class=n>analytical_solution</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-3-101><a id=__codelineno-3-101 name=__codelineno-3-101></a>            <span class=n>pos_error</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=o>-</span> <span class=n>analytical</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>])</span>
</span><span id=__span-3-102><a id=__codelineno-3-102 name=__codelineno-3-102></a>            <span class=n>errors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>pos_error</span><span class=p>)</span>
</span><span id=__span-3-103><a id=__codelineno-3-103 name=__codelineno-3-103></a>
</span><span id=__span-3-104><a id=__codelineno-3-104 name=__codelineno-3-104></a>            <span class=n>next_output</span> <span class=o>+=</span> <span class=n>output_interval</span>
</span><span id=__span-3-105><a id=__codelineno-3-105 name=__codelineno-3-105></a>
</span><span id=__span-3-106><a id=__codelineno-3-106 name=__codelineno-3-106></a>        <span class=c1># Integrate one step</span>
</span><span id=__span-3-107><a id=__codelineno-3-107 name=__codelineno-3-107></a>        <span class=k>if</span> <span class=n>is_adaptive</span><span class=p>:</span>
</span><span id=__span-3-108><a id=__codelineno-3-108 name=__codelineno-3-108></a>            <span class=n>result</span> <span class=o>=</span> <span class=n>integrator</span><span class=o>.</span><span class=n>step</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>state</span><span class=p>,</span> <span class=nb>min</span><span class=p>(</span><span class=n>dt</span><span class=p>,</span> <span class=n>t_end</span> <span class=o>-</span> <span class=n>t</span><span class=p>))</span>
</span><span id=__span-3-109><a id=__codelineno-3-109 name=__codelineno-3-109></a>            <span class=n>t</span> <span class=o>+=</span> <span class=n>result</span><span class=o>.</span><span class=n>dt_used</span>
</span><span id=__span-3-110><a id=__codelineno-3-110 name=__codelineno-3-110></a>            <span class=n>state</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>state</span>
</span><span id=__span-3-111><a id=__codelineno-3-111 name=__codelineno-3-111></a>            <span class=n>dt</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>dt_next</span>
</span><span id=__span-3-112><a id=__codelineno-3-112 name=__codelineno-3-112></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-3-113><a id=__codelineno-3-113 name=__codelineno-3-113></a>            <span class=c1># Fixed step</span>
</span><span id=__span-3-114><a id=__codelineno-3-114 name=__codelineno-3-114></a>            <span class=n>dt_actual</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>dt</span><span class=p>,</span> <span class=n>t_end</span> <span class=o>-</span> <span class=n>t</span><span class=p>)</span>
</span><span id=__span-3-115><a id=__codelineno-3-115 name=__codelineno-3-115></a>            <span class=n>new_state</span> <span class=o>=</span> <span class=n>integrator</span><span class=o>.</span><span class=n>step</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>state</span><span class=p>,</span> <span class=n>dt_actual</span><span class=p>)</span>
</span><span id=__span-3-116><a id=__codelineno-3-116 name=__codelineno-3-116></a>            <span class=n>t</span> <span class=o>+=</span> <span class=n>dt_actual</span>
</span><span id=__span-3-117><a id=__codelineno-3-117 name=__codelineno-3-117></a>            <span class=n>state</span> <span class=o>=</span> <span class=n>new_state</span>
</span><span id=__span-3-118><a id=__codelineno-3-118 name=__codelineno-3-118></a>
</span><span id=__span-3-119><a id=__codelineno-3-119 name=__codelineno-3-119></a>    <span class=c1># Final output</span>
</span><span id=__span-3-120><a id=__codelineno-3-120 name=__codelineno-3-120></a>    <span class=k>if</span> <span class=n>t</span> <span class=o>&gt;=</span> <span class=n>t_end</span> <span class=o>-</span> <span class=mf>1e-6</span><span class=p>:</span>  <span class=c1># Handle floating point comparison</span>
</span><span id=__span-3-121><a id=__codelineno-3-121 name=__codelineno-3-121></a>        <span class=n>times</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>t_end</span><span class=p>)</span>
</span><span id=__span-3-122><a id=__codelineno-3-122 name=__codelineno-3-122></a>        <span class=n>analytical</span> <span class=o>=</span> <span class=n>analytical_solution</span><span class=p>(</span><span class=n>t_end</span><span class=p>)</span>
</span><span id=__span-3-123><a id=__codelineno-3-123 name=__codelineno-3-123></a>        <span class=n>pos_error</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=o>-</span> <span class=n>analytical</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>])</span>
</span><span id=__span-3-124><a id=__codelineno-3-124 name=__codelineno-3-124></a>        <span class=n>errors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>pos_error</span><span class=p>)</span>
</span><span id=__span-3-125><a id=__codelineno-3-125 name=__codelineno-3-125></a>
</span><span id=__span-3-126><a id=__codelineno-3-126 name=__codelineno-3-126></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>times</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>errors</span><span class=p>)</span>
</span><span id=__span-3-127><a id=__codelineno-3-127 name=__codelineno-3-127></a>
</span><span id=__span-3-128><a id=__codelineno-3-128 name=__codelineno-3-128></a>
</span><span id=__span-3-129><a id=__codelineno-3-129 name=__codelineno-3-129></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Propagating with RK4...&quot;</span><span class=p>)</span>
</span><span id=__span-3-130><a id=__codelineno-3-130 name=__codelineno-3-130></a><span class=n>times_rk4</span><span class=p>,</span> <span class=n>errors_rk4</span> <span class=o>=</span> <span class=n>propagate</span><span class=p>(</span><span class=n>integrator_rk4</span><span class=p>,</span> <span class=n>is_adaptive</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-3-131><a id=__codelineno-3-131 name=__codelineno-3-131></a>
</span><span id=__span-3-132><a id=__codelineno-3-132 name=__codelineno-3-132></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Propagating with RKF45...&quot;</span><span class=p>)</span>
</span><span id=__span-3-133><a id=__codelineno-3-133 name=__codelineno-3-133></a><span class=n>times_rkf45</span><span class=p>,</span> <span class=n>errors_rkf45</span> <span class=o>=</span> <span class=n>propagate</span><span class=p>(</span><span class=n>integrator_rkf45</span><span class=p>,</span> <span class=n>is_adaptive</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-3-134><a id=__codelineno-3-134 name=__codelineno-3-134></a>
</span><span id=__span-3-135><a id=__codelineno-3-135 name=__codelineno-3-135></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Propagating with DP54...&quot;</span><span class=p>)</span>
</span><span id=__span-3-136><a id=__codelineno-3-136 name=__codelineno-3-136></a><span class=n>times_dp54</span><span class=p>,</span> <span class=n>errors_dp54</span> <span class=o>=</span> <span class=n>propagate</span><span class=p>(</span><span class=n>integrator_dp54</span><span class=p>,</span> <span class=n>is_adaptive</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-3-137><a id=__codelineno-3-137 name=__codelineno-3-137></a>
</span><span id=__span-3-138><a id=__codelineno-3-138 name=__codelineno-3-138></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Propagating with RKN1210...&quot;</span><span class=p>)</span>
</span><span id=__span-3-139><a id=__codelineno-3-139 name=__codelineno-3-139></a><span class=n>times_rkn1210</span><span class=p>,</span> <span class=n>errors_rkn1210</span> <span class=o>=</span> <span class=n>propagate</span><span class=p>(</span><span class=n>integrator_rkn1210</span><span class=p>,</span> <span class=n>is_adaptive</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-3-140><a id=__codelineno-3-140 name=__codelineno-3-140></a>
</span><span id=__span-3-141><a id=__codelineno-3-141 name=__codelineno-3-141></a>
</span><span id=__span-3-142><a id=__codelineno-3-142 name=__codelineno-3-142></a><span class=c1># Create figure with theme support</span>
</span><span id=__span-3-143><a id=__codelineno-3-143 name=__codelineno-3-143></a><span class=k>def</span><span class=w> </span><span class=nf>create_figure</span><span class=p>(</span><span class=n>theme</span><span class=p>):</span>
</span><span id=__span-3-144><a id=__codelineno-3-144 name=__codelineno-3-144></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Create figure with theme-specific colors.&quot;&quot;&quot;</span>
</span><span id=__span-3-145><a id=__codelineno-3-145 name=__codelineno-3-145></a>    <span class=n>colors</span> <span class=o>=</span> <span class=n>get_color_sequence</span><span class=p>(</span><span class=n>theme</span><span class=p>,</span> <span class=n>num_colors</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span><span id=__span-3-146><a id=__codelineno-3-146 name=__codelineno-3-146></a>
</span><span id=__span-3-147><a id=__codelineno-3-147 name=__codelineno-3-147></a>    <span class=n>fig</span> <span class=o>=</span> <span class=n>go</span><span class=o>.</span><span class=n>Figure</span><span class=p>()</span>
</span><span id=__span-3-148><a id=__codelineno-3-148 name=__codelineno-3-148></a>
</span><span id=__span-3-149><a id=__codelineno-3-149 name=__codelineno-3-149></a>    <span class=c1># Add traces for each integrator with custom hover templates</span>
</span><span id=__span-3-150><a id=__codelineno-3-150 name=__codelineno-3-150></a>    <span class=c1># First trace includes time at top, others don&#39;t to avoid duplication</span>
</span><span id=__span-3-151><a id=__codelineno-3-151 name=__codelineno-3-151></a>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span>
</span><span id=__span-3-152><a id=__codelineno-3-152 name=__codelineno-3-152></a>        <span class=n>go</span><span class=o>.</span><span class=n>Scatter</span><span class=p>(</span>
</span><span id=__span-3-153><a id=__codelineno-3-153 name=__codelineno-3-153></a>            <span class=n>x</span><span class=o>=</span><span class=n>times_rk4</span> <span class=o>/</span> <span class=mi>3600</span><span class=p>,</span>  <span class=c1># Convert to hours</span>
</span><span id=__span-3-154><a id=__codelineno-3-154 name=__codelineno-3-154></a>            <span class=n>y</span><span class=o>=</span><span class=n>errors_rk4</span><span class=p>,</span>
</span><span id=__span-3-155><a id=__codelineno-3-155 name=__codelineno-3-155></a>            <span class=n>name</span><span class=o>=</span><span class=s2>&quot;RK4 (Fixed, dt=60s)&quot;</span><span class=p>,</span>
</span><span id=__span-3-156><a id=__codelineno-3-156 name=__codelineno-3-156></a>            <span class=n>mode</span><span class=o>=</span><span class=s2>&quot;lines&quot;</span><span class=p>,</span>
</span><span id=__span-3-157><a id=__codelineno-3-157 name=__codelineno-3-157></a>            <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=n>colors</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=mi>2</span><span class=p>),</span>
</span><span id=__span-3-158><a id=__codelineno-3-158 name=__codelineno-3-158></a>            <span class=n>hovertemplate</span><span class=o>=</span><span class=s2>&quot;t=%</span><span class=si>{x:.2f}</span><span class=s2> hours&lt;br&gt;&lt;b&gt;RK4&lt;/b&gt;&lt;br&gt;Error: %</span><span class=si>{y:.2e}</span><span class=s2> m&lt;extra&gt;&lt;/extra&gt;&quot;</span><span class=p>,</span>
</span><span id=__span-3-159><a id=__codelineno-3-159 name=__codelineno-3-159></a>        <span class=p>)</span>
</span><span id=__span-3-160><a id=__codelineno-3-160 name=__codelineno-3-160></a>    <span class=p>)</span>
</span><span id=__span-3-161><a id=__codelineno-3-161 name=__codelineno-3-161></a>
</span><span id=__span-3-162><a id=__codelineno-3-162 name=__codelineno-3-162></a>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span>
</span><span id=__span-3-163><a id=__codelineno-3-163 name=__codelineno-3-163></a>        <span class=n>go</span><span class=o>.</span><span class=n>Scatter</span><span class=p>(</span>
</span><span id=__span-3-164><a id=__codelineno-3-164 name=__codelineno-3-164></a>            <span class=n>x</span><span class=o>=</span><span class=n>times_rkf45</span> <span class=o>/</span> <span class=mi>3600</span><span class=p>,</span>
</span><span id=__span-3-165><a id=__codelineno-3-165 name=__codelineno-3-165></a>            <span class=n>y</span><span class=o>=</span><span class=n>errors_rkf45</span><span class=p>,</span>
</span><span id=__span-3-166><a id=__codelineno-3-166 name=__codelineno-3-166></a>            <span class=n>name</span><span class=o>=</span><span class=s2>&quot;RKF45 (Adaptive)&quot;</span><span class=p>,</span>
</span><span id=__span-3-167><a id=__codelineno-3-167 name=__codelineno-3-167></a>            <span class=n>mode</span><span class=o>=</span><span class=s2>&quot;lines&quot;</span><span class=p>,</span>
</span><span id=__span-3-168><a id=__codelineno-3-168 name=__codelineno-3-168></a>            <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=n>colors</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=mi>2</span><span class=p>),</span>
</span><span id=__span-3-169><a id=__codelineno-3-169 name=__codelineno-3-169></a>            <span class=n>hovertemplate</span><span class=o>=</span><span class=s2>&quot;&lt;b&gt;RKF45&lt;/b&gt;&lt;br&gt;Error: %</span><span class=si>{y:.2e}</span><span class=s2> m&lt;extra&gt;&lt;/extra&gt;&quot;</span><span class=p>,</span>
</span><span id=__span-3-170><a id=__codelineno-3-170 name=__codelineno-3-170></a>        <span class=p>)</span>
</span><span id=__span-3-171><a id=__codelineno-3-171 name=__codelineno-3-171></a>    <span class=p>)</span>
</span><span id=__span-3-172><a id=__codelineno-3-172 name=__codelineno-3-172></a>
</span><span id=__span-3-173><a id=__codelineno-3-173 name=__codelineno-3-173></a>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span>
</span><span id=__span-3-174><a id=__codelineno-3-174 name=__codelineno-3-174></a>        <span class=n>go</span><span class=o>.</span><span class=n>Scatter</span><span class=p>(</span>
</span><span id=__span-3-175><a id=__codelineno-3-175 name=__codelineno-3-175></a>            <span class=n>x</span><span class=o>=</span><span class=n>times_dp54</span> <span class=o>/</span> <span class=mi>3600</span><span class=p>,</span>
</span><span id=__span-3-176><a id=__codelineno-3-176 name=__codelineno-3-176></a>            <span class=n>y</span><span class=o>=</span><span class=n>errors_dp54</span><span class=p>,</span>
</span><span id=__span-3-177><a id=__codelineno-3-177 name=__codelineno-3-177></a>            <span class=n>name</span><span class=o>=</span><span class=s2>&quot;DP54 (Adaptive)&quot;</span><span class=p>,</span>
</span><span id=__span-3-178><a id=__codelineno-3-178 name=__codelineno-3-178></a>            <span class=n>mode</span><span class=o>=</span><span class=s2>&quot;lines&quot;</span><span class=p>,</span>
</span><span id=__span-3-179><a id=__codelineno-3-179 name=__codelineno-3-179></a>            <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=n>colors</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=mi>2</span><span class=p>),</span>
</span><span id=__span-3-180><a id=__codelineno-3-180 name=__codelineno-3-180></a>            <span class=n>hovertemplate</span><span class=o>=</span><span class=s2>&quot;&lt;b&gt;DP54&lt;/b&gt;&lt;br&gt;Error: %</span><span class=si>{y:.2e}</span><span class=s2> m&lt;extra&gt;&lt;/extra&gt;&quot;</span><span class=p>,</span>
</span><span id=__span-3-181><a id=__codelineno-3-181 name=__codelineno-3-181></a>        <span class=p>)</span>
</span><span id=__span-3-182><a id=__codelineno-3-182 name=__codelineno-3-182></a>    <span class=p>)</span>
</span><span id=__span-3-183><a id=__codelineno-3-183 name=__codelineno-3-183></a>
</span><span id=__span-3-184><a id=__codelineno-3-184 name=__codelineno-3-184></a>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span>
</span><span id=__span-3-185><a id=__codelineno-3-185 name=__codelineno-3-185></a>        <span class=n>go</span><span class=o>.</span><span class=n>Scatter</span><span class=p>(</span>
</span><span id=__span-3-186><a id=__codelineno-3-186 name=__codelineno-3-186></a>            <span class=n>x</span><span class=o>=</span><span class=n>times_rkn1210</span> <span class=o>/</span> <span class=mi>3600</span><span class=p>,</span>
</span><span id=__span-3-187><a id=__codelineno-3-187 name=__codelineno-3-187></a>            <span class=n>y</span><span class=o>=</span><span class=n>errors_rkn1210</span><span class=p>,</span>
</span><span id=__span-3-188><a id=__codelineno-3-188 name=__codelineno-3-188></a>            <span class=n>name</span><span class=o>=</span><span class=s2>&quot;RKN1210 (Adaptive)&quot;</span><span class=p>,</span>
</span><span id=__span-3-189><a id=__codelineno-3-189 name=__codelineno-3-189></a>            <span class=n>mode</span><span class=o>=</span><span class=s2>&quot;lines&quot;</span><span class=p>,</span>
</span><span id=__span-3-190><a id=__codelineno-3-190 name=__codelineno-3-190></a>            <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=n>colors</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=mi>2</span><span class=p>),</span>
</span><span id=__span-3-191><a id=__codelineno-3-191 name=__codelineno-3-191></a>            <span class=n>hovertemplate</span><span class=o>=</span><span class=s2>&quot;&lt;b&gt;RKN1210&lt;/b&gt;&lt;br&gt;Error: %</span><span class=si>{y:.2e}</span><span class=s2> m&lt;extra&gt;&lt;/extra&gt;&quot;</span><span class=p>,</span>
</span><span id=__span-3-192><a id=__codelineno-3-192 name=__codelineno-3-192></a>        <span class=p>)</span>
</span><span id=__span-3-193><a id=__codelineno-3-193 name=__codelineno-3-193></a>    <span class=p>)</span>
</span><span id=__span-3-194><a id=__codelineno-3-194 name=__codelineno-3-194></a>
</span><span id=__span-3-195><a id=__codelineno-3-195 name=__codelineno-3-195></a>    <span class=c1># Configure layout</span>
</span><span id=__span-3-196><a id=__codelineno-3-196 name=__codelineno-3-196></a>    <span class=n>fig</span><span class=o>.</span><span class=n>update_layout</span><span class=p>(</span>
</span><span id=__span-3-197><a id=__codelineno-3-197 name=__codelineno-3-197></a>        <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Integrator Accuracy Comparison: HEO Orbit&quot;</span><span class=p>,</span>
</span><span id=__span-3-198><a id=__codelineno-3-198 name=__codelineno-3-198></a>        <span class=n>xaxis_title</span><span class=o>=</span><span class=s2>&quot;Time (hours)&quot;</span><span class=p>,</span>
</span><span id=__span-3-199><a id=__codelineno-3-199 name=__codelineno-3-199></a>        <span class=n>yaxis_title</span><span class=o>=</span><span class=s2>&quot;Position Error (m)&quot;</span><span class=p>,</span>
</span><span id=__span-3-200><a id=__codelineno-3-200 name=__codelineno-3-200></a>        <span class=n>yaxis_type</span><span class=o>=</span><span class=s2>&quot;log&quot;</span><span class=p>,</span>
</span><span id=__span-3-201><a id=__codelineno-3-201 name=__codelineno-3-201></a>        <span class=n>hovermode</span><span class=o>=</span><span class=s2>&quot;x unified&quot;</span><span class=p>,</span>
</span><span id=__span-3-202><a id=__codelineno-3-202 name=__codelineno-3-202></a>        <span class=n>legend</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>yanchor</span><span class=o>=</span><span class=s2>&quot;top&quot;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=mf>0.99</span><span class=p>,</span> <span class=n>xanchor</span><span class=o>=</span><span class=s2>&quot;left&quot;</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=mf>0.01</span><span class=p>),</span>
</span><span id=__span-3-203><a id=__codelineno-3-203 name=__codelineno-3-203></a>    <span class=p>)</span>
</span><span id=__span-3-204><a id=__codelineno-3-204 name=__codelineno-3-204></a>
</span><span id=__span-3-205><a id=__codelineno-3-205 name=__codelineno-3-205></a>    <span class=c1># Configure axes - hide default x-value in hover since we show it in first trace</span>
</span><span id=__span-3-206><a id=__codelineno-3-206 name=__codelineno-3-206></a>    <span class=n>fig</span><span class=o>.</span><span class=n>update_xaxes</span><span class=p>(</span><span class=n>title_text</span><span class=o>=</span><span class=s2>&quot;Time (hours)&quot;</span><span class=p>,</span> <span class=n>unifiedhovertitle</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>text</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=p>))</span>
</span><span id=__span-3-207><a id=__codelineno-3-207 name=__codelineno-3-207></a>    <span class=n>fig</span><span class=o>.</span><span class=n>update_yaxes</span><span class=p>(</span><span class=n>title_text</span><span class=o>=</span><span class=s2>&quot;Position Error (m)&quot;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;log&quot;</span><span class=p>)</span>
</span><span id=__span-3-208><a id=__codelineno-3-208 name=__codelineno-3-208></a>
</span><span id=__span-3-209><a id=__codelineno-3-209 name=__codelineno-3-209></a>    <span class=k>return</span> <span class=n>fig</span>
</span><span id=__span-3-210><a id=__codelineno-3-210 name=__codelineno-3-210></a>
</span><span id=__span-3-211><a id=__codelineno-3-211 name=__codelineno-3-211></a>
</span><span id=__span-3-212><a id=__codelineno-3-212 name=__codelineno-3-212></a><span class=c1># Generate and save both themed versions</span>
</span><span id=__span-3-213><a id=__codelineno-3-213 name=__codelineno-3-213></a><span class=n>light_path</span><span class=p>,</span> <span class=n>dark_path</span> <span class=o>=</span> <span class=n>save_themed_html</span><span class=p>(</span><span class=n>create_figure</span><span class=p>,</span> <span class=n>OUTDIR</span> <span class=o>/</span> <span class=n>SCRIPT_NAME</span><span class=p>)</span>
</span><span id=__span-3-214><a id=__codelineno-3-214 name=__codelineno-3-214></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;✓ Generated </span><span class=si>{</span><span class=n>light_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-3-215><a id=__codelineno-3-215 name=__codelineno-3-215></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;✓ Generated </span><span class=si>{</span><span class=n>dark_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <h2 id=basic-usage-patterns>Basic Usage Patterns<a class=headerlink href=#basic-usage-patterns title="Permanent link">&para;</a></h2> <h3 id=fixed-step-integration>Fixed-Step Integration<a class=headerlink href=#fixed-step-integration title="Permanent link">&para;</a></h3> <p>To use a fixed-step integrator like RK4, you create an instance with the desired step size and call <code>step</code> in a loop:</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>Python</label><label for=__tabbed_2_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-4-1> 1</a></span>
<span class=normal><a href=#__codelineno-4-2> 2</a></span>
<span class=normal><a href=#__codelineno-4-3> 3</a></span>
<span class=normal><a href=#__codelineno-4-4> 4</a></span>
<span class=normal><a href=#__codelineno-4-5> 5</a></span>
<span class=normal><a href=#__codelineno-4-6> 6</a></span>
<span class=normal><a href=#__codelineno-4-7> 7</a></span>
<span class=normal><a href=#__codelineno-4-8> 8</a></span>
<span class=normal><a href=#__codelineno-4-9> 9</a></span>
<span class=normal><a href=#__codelineno-4-10>10</a></span>
<span class=normal><a href=#__codelineno-4-11>11</a></span>
<span class=normal><a href=#__codelineno-4-12>12</a></span>
<span class=normal><a href=#__codelineno-4-13>13</a></span>
<span class=normal><a href=#__codelineno-4-14>14</a></span>
<span class=normal><a href=#__codelineno-4-15>15</a></span>
<span class=normal><a href=#__codelineno-4-16>16</a></span>
<span class=normal><a href=#__codelineno-4-17>17</a></span>
<span class=normal><a href=#__codelineno-4-18>18</a></span>
<span class=normal><a href=#__codelineno-4-19>19</a></span>
<span class=normal><a href=#__codelineno-4-20>20</a></span>
<span class=normal><a href=#__codelineno-4-21>21</a></span>
<span class=normal><a href=#__codelineno-4-22>22</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3></a>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4></a>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5></a><span class=k>def</span><span class=w> </span><span class=nf>dynamics</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>state</span><span class=p>):</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Exponential decay dynamics: dx/dt = -k*x&quot;&quot;&quot;</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7></a>    <span class=n>k</span> <span class=o>=</span> <span class=mf>0.1</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=o>-</span><span class=n>k</span> <span class=o>*</span> <span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9></a>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10></a>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11></a><span class=c1># Create fixed-step integrator</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12></a><span class=n>config</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>IntegratorConfig</span><span class=o>.</span><span class=n>fixed_step</span><span class=p>(</span><span class=n>step_size</span><span class=o>=</span><span class=mf>10.0</span><span class=p>)</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13></a><span class=n>integrator</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>RK4Integrator</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>dynamics</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14></a>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15></a><span class=c1># Integrate one step</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16></a><span class=n>t</span> <span class=o>=</span> <span class=mf>0.0</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17></a><span class=n>initial_state</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>1.0</span><span class=p>])</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18></a><span class=n>new_state</span> <span class=o>=</span> <span class=n>integrator</span><span class=o>.</span><span class=n>step</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>initial_state</span><span class=p>,</span> <span class=n>dt</span><span class=o>=</span><span class=mf>10.0</span><span class=p>)</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19></a>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Initial state: </span><span class=si>{</span><span class=n>initial_state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;State after 10s: </span><span class=si>{</span><span class=n>new_state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Analytical: </span><span class=si>{</span><span class=n>initial_state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>10.0</span><span class=p>)</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-5-1> 1</a></span>
<span class=normal><a href=#__codelineno-5-2> 2</a></span>
<span class=normal><a href=#__codelineno-5-3> 3</a></span>
<span class=normal><a href=#__codelineno-5-4> 4</a></span>
<span class=normal><a href=#__codelineno-5-5> 5</a></span>
<span class=normal><a href=#__codelineno-5-6> 6</a></span>
<span class=normal><a href=#__codelineno-5-7> 7</a></span>
<span class=normal><a href=#__codelineno-5-8> 8</a></span>
<span class=normal><a href=#__codelineno-5-9> 9</a></span>
<span class=normal><a href=#__codelineno-5-10>10</a></span>
<span class=normal><a href=#__codelineno-5-11>11</a></span>
<span class=normal><a href=#__codelineno-5-12>12</a></span>
<span class=normal><a href=#__codelineno-5-13>13</a></span>
<span class=normal><a href=#__codelineno-5-14>14</a></span>
<span class=normal><a href=#__codelineno-5-15>15</a></span>
<span class=normal><a href=#__codelineno-5-16>16</a></span>
<span class=normal><a href=#__codelineno-5-17>17</a></span>
<span class=normal><a href=#__codelineno-5-18>18</a></span>
<span class=normal><a href=#__codelineno-5-19>19</a></span>
<span class=normal><a href=#__codelineno-5-20>20</a></span>
<span class=normal><a href=#__codelineno-5-21>21</a></span>
<span class=normal><a href=#__codelineno-5-22>22</a></span>
<span class=normal><a href=#__codelineno-5-23>23</a></span>
<span class=normal><a href=#__codelineno-5-24>24</a></span>
<span class=normal><a href=#__codelineno-5-25>25</a></span>
<span class=normal><a href=#__codelineno-5-26>26</a></span>
<span class=normal><a href=#__codelineno-5-27>27</a></span>
<span class=normal><a href=#__codelineno-5-28>28</a></span>
<span class=normal><a href=#__codelineno-5-29>29</a></span>
<span class=normal><a href=#__codelineno-5-30>30</a></span>
<span class=normal><a href=#__codelineno-5-31>31</a></span>
<span class=normal><a href=#__codelineno-5-32>32</a></span>
<span class=normal><a href=#__codelineno-5-33>33</a></span>
<span class=normal><a href=#__codelineno-5-34>34</a></span>
<span class=normal><a href=#__codelineno-5-35>35</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1></a><span class=sd>//! Simple fixed-step integration pattern example.</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2></a><span class=sd>//!</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3></a><span class=sd>//! Demonstrates the basic pattern for using a fixed-step integrator</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4></a><span class=sd>//! with exponential decay dynamics.</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5></a>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6></a><span class=k>use</span><span class=w> </span><span class=n>brahe</span><span class=p>::</span><span class=n>integrators</span><span class=p>::</span><span class=o>*</span><span class=p>;</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7></a><span class=k>use</span><span class=w> </span><span class=n>nalgebra</span><span class=p>::</span><span class=n>DVector</span><span class=p>;</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8></a>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10></a><span class=w>    </span><span class=c1>// Dynamics function: Exponential decay dx/dt = -k*x</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.1</span><span class=p>;</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>dynamics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>move</span><span class=w> </span><span class=o>|</span><span class=n>_t</span><span class=p>:</span><span class=w> </span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>:</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=p>,</span><span class=w> </span><span class=n>_params</span><span class=p>:</span><span class=w> </span><span class=nb>Option</span><span class=o>&lt;&amp;</span><span class=n>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;&gt;|</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13></a><span class=w>        </span><span class=n>DVector</span><span class=p>::</span><span class=n>from_vec</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span><span class=o>-</span><span class=n>k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15></a>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16></a><span class=w>    </span><span class=c1>// Create fixed-step integrator</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IntegratorConfig</span><span class=p>::</span><span class=n>fixed_step</span><span class=p>(</span><span class=mf>10.0</span><span class=p>);</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>integrator</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RK4DIntegrator</span><span class=p>::</span><span class=n>with_config</span><span class=p>(</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19></a><span class=w>        </span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20></a><span class=w>        </span><span class=nb>Box</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>dynamics</span><span class=p>),</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24></a><span class=w>        </span><span class=n>config</span>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26></a>
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27></a><span class=w>    </span><span class=c1>// Integrate one step</span>
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.0</span><span class=p>;</span>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>initial_state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DVector</span><span class=p>::</span><span class=n>from_vec</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span><span class=mf>1.0</span><span class=p>]);</span>
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>new_state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>integrator</span><span class=p>.</span><span class=n>step</span><span class=p>(</span><span class=n>t</span><span class=p>,</span><span class=w> </span><span class=n>initial_state</span><span class=p>.</span><span class=n>clone</span><span class=p>(),</span><span class=w> </span><span class=nb>None</span><span class=p>);</span>
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31></a>
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Initial state: {:.6}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>initial_state</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;State after 10s: {:.6}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>new_state</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Analytical: {:.6}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>initial_state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>10.0_</span><span class=k>f64</span><span class=p>).</span><span class=n>exp</span><span class=p>());</span>
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <h3 id=adaptive-integration>Adaptive Integration<a class=headerlink href=#adaptive-integration title="Permanent link">&para;</a></h3> <p>To use an adaptive-step integrator like RKF45, you create it with an <code>IntegratorConfig</code> specifying tolerances, then call <code>step</code>. The adaptive integrator returns an <a href=../../library_api/integrators/config.html><code>AdaptiveStepResult</code></a> containing the new state and recommended next step size.</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>Python</label><label for=__tabbed_3_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-6-1> 1</a></span>
<span class=normal><a href=#__codelineno-6-2> 2</a></span>
<span class=normal><a href=#__codelineno-6-3> 3</a></span>
<span class=normal><a href=#__codelineno-6-4> 4</a></span>
<span class=normal><a href=#__codelineno-6-5> 5</a></span>
<span class=normal><a href=#__codelineno-6-6> 6</a></span>
<span class=normal><a href=#__codelineno-6-7> 7</a></span>
<span class=normal><a href=#__codelineno-6-8> 8</a></span>
<span class=normal><a href=#__codelineno-6-9> 9</a></span>
<span class=normal><a href=#__codelineno-6-10>10</a></span>
<span class=normal><a href=#__codelineno-6-11>11</a></span>
<span class=normal><a href=#__codelineno-6-12>12</a></span>
<span class=normal><a href=#__codelineno-6-13>13</a></span>
<span class=normal><a href=#__codelineno-6-14>14</a></span>
<span class=normal><a href=#__codelineno-6-15>15</a></span>
<span class=normal><a href=#__codelineno-6-16>16</a></span>
<span class=normal><a href=#__codelineno-6-17>17</a></span>
<span class=normal><a href=#__codelineno-6-18>18</a></span>
<span class=normal><a href=#__codelineno-6-19>19</a></span>
<span class=normal><a href=#__codelineno-6-20>20</a></span>
<span class=normal><a href=#__codelineno-6-21>21</a></span>
<span class=normal><a href=#__codelineno-6-22>22</a></span>
<span class=normal><a href=#__codelineno-6-23>23</a></span>
<span class=normal><a href=#__codelineno-6-24>24</a></span>
<span class=normal><a href=#__codelineno-6-25>25</a></span>
<span class=normal><a href=#__codelineno-6-26>26</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3></a>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4></a>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5></a><span class=k>def</span><span class=w> </span><span class=nf>dynamics</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>state</span><span class=p>):</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Exponential decay dynamics: dx/dt = -k*x&quot;&quot;&quot;</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7></a>    <span class=n>k</span> <span class=o>=</span> <span class=mf>0.1</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=o>-</span><span class=n>k</span> <span class=o>*</span> <span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9></a>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10></a>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11></a><span class=c1># Create adaptive integrator</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12></a><span class=n>config</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>IntegratorConfig</span><span class=o>.</span><span class=n>adaptive</span><span class=p>(</span><span class=n>abs_tol</span><span class=o>=</span><span class=mf>1e-10</span><span class=p>,</span> <span class=n>rel_tol</span><span class=o>=</span><span class=mf>1e-9</span><span class=p>)</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13></a><span class=n>integrator</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>DP54Integrator</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>dynamics</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14></a>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15></a><span class=c1># Integrate with automatic step control</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16></a><span class=n>t</span> <span class=o>=</span> <span class=mf>0.0</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17></a><span class=n>initial_state</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>1.0</span><span class=p>])</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18></a><span class=n>dt</span> <span class=o>=</span> <span class=mf>60.0</span>  <span class=c1># Initial guess</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19></a>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20></a><span class=n>result</span> <span class=o>=</span> <span class=n>integrator</span><span class=o>.</span><span class=n>step</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>initial_state</span><span class=p>,</span> <span class=n>dt</span><span class=p>)</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21></a>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Initial state: </span><span class=si>{</span><span class=n>initial_state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;State after step: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Step used: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>dt_used</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Recommended next step: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>dt_next</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error estimate: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>error_estimate</span><span class=si>:</span><span class=s2>.2e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-7-1> 1</a></span>
<span class=normal><a href=#__codelineno-7-2> 2</a></span>
<span class=normal><a href=#__codelineno-7-3> 3</a></span>
<span class=normal><a href=#__codelineno-7-4> 4</a></span>
<span class=normal><a href=#__codelineno-7-5> 5</a></span>
<span class=normal><a href=#__codelineno-7-6> 6</a></span>
<span class=normal><a href=#__codelineno-7-7> 7</a></span>
<span class=normal><a href=#__codelineno-7-8> 8</a></span>
<span class=normal><a href=#__codelineno-7-9> 9</a></span>
<span class=normal><a href=#__codelineno-7-10>10</a></span>
<span class=normal><a href=#__codelineno-7-11>11</a></span>
<span class=normal><a href=#__codelineno-7-12>12</a></span>
<span class=normal><a href=#__codelineno-7-13>13</a></span>
<span class=normal><a href=#__codelineno-7-14>14</a></span>
<span class=normal><a href=#__codelineno-7-15>15</a></span>
<span class=normal><a href=#__codelineno-7-16>16</a></span>
<span class=normal><a href=#__codelineno-7-17>17</a></span>
<span class=normal><a href=#__codelineno-7-18>18</a></span>
<span class=normal><a href=#__codelineno-7-19>19</a></span>
<span class=normal><a href=#__codelineno-7-20>20</a></span>
<span class=normal><a href=#__codelineno-7-21>21</a></span>
<span class=normal><a href=#__codelineno-7-22>22</a></span>
<span class=normal><a href=#__codelineno-7-23>23</a></span>
<span class=normal><a href=#__codelineno-7-24>24</a></span>
<span class=normal><a href=#__codelineno-7-25>25</a></span>
<span class=normal><a href=#__codelineno-7-26>26</a></span>
<span class=normal><a href=#__codelineno-7-27>27</a></span>
<span class=normal><a href=#__codelineno-7-28>28</a></span>
<span class=normal><a href=#__codelineno-7-29>29</a></span>
<span class=normal><a href=#__codelineno-7-30>30</a></span>
<span class=normal><a href=#__codelineno-7-31>31</a></span>
<span class=normal><a href=#__codelineno-7-32>32</a></span>
<span class=normal><a href=#__codelineno-7-33>33</a></span>
<span class=normal><a href=#__codelineno-7-34>34</a></span>
<span class=normal><a href=#__codelineno-7-35>35</a></span>
<span class=normal><a href=#__codelineno-7-36>36</a></span>
<span class=normal><a href=#__codelineno-7-37>37</a></span>
<span class=normal><a href=#__codelineno-7-38>38</a></span>
<span class=normal><a href=#__codelineno-7-39>39</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1></a><span class=sd>//! Simple adaptive-step integration pattern example.</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2></a><span class=sd>//!</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3></a><span class=sd>//! Demonstrates the basic pattern for using an adaptive-step integrator</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4></a><span class=sd>//! with exponential decay dynamics.</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5></a>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6></a><span class=k>use</span><span class=w> </span><span class=n>brahe</span><span class=p>::</span><span class=n>integrators</span><span class=p>::</span><span class=o>*</span><span class=p>;</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7></a><span class=k>use</span><span class=w> </span><span class=n>nalgebra</span><span class=p>::</span><span class=n>DVector</span><span class=p>;</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8></a>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10></a><span class=w>    </span><span class=c1>// Dynamics function: Exponential decay dx/dt = -k*x</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.1</span><span class=p>;</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>dynamics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>move</span><span class=w> </span><span class=o>|</span><span class=n>_t</span><span class=p>:</span><span class=w> </span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>:</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=p>,</span><span class=w> </span><span class=n>_params</span><span class=p>:</span><span class=w> </span><span class=nb>Option</span><span class=o>&lt;&amp;</span><span class=n>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;&gt;|</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13></a><span class=w>        </span><span class=n>DVector</span><span class=p>::</span><span class=n>from_vec</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span><span class=o>-</span><span class=n>k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15></a>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16></a><span class=w>    </span><span class=c1>// Create adaptive integrator</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IntegratorConfig</span><span class=p>::</span><span class=n>adaptive</span><span class=p>(</span><span class=mf>1e-10</span><span class=p>,</span><span class=w> </span><span class=mf>1e-9</span><span class=p>);</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>integrator</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DormandPrince54DIntegrator</span><span class=p>::</span><span class=n>with_config</span><span class=p>(</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19></a><span class=w>        </span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20></a><span class=w>        </span><span class=nb>Box</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>dynamics</span><span class=p>),</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24></a><span class=w>        </span><span class=n>config</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26></a>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27></a><span class=w>    </span><span class=c1>// Integrate with automatic step control</span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.0</span><span class=p>;</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>initial_state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DVector</span><span class=p>::</span><span class=n>from_vec</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span><span class=mf>1.0</span><span class=p>]);</span>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>dt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>60.0</span><span class=p>;</span><span class=w> </span><span class=c1>// Initial guess</span>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31></a>
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>integrator</span><span class=p>.</span><span class=n>step</span><span class=p>(</span><span class=n>t</span><span class=p>,</span><span class=w> </span><span class=n>initial_state</span><span class=p>.</span><span class=n>clone</span><span class=p>(),</span><span class=w> </span><span class=n>dt</span><span class=p>);</span>
</span><span id=__span-7-33><a id=__codelineno-7-33 name=__codelineno-7-33></a>
</span><span id=__span-7-34><a id=__codelineno-7-34 name=__codelineno-7-34></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Initial state: {:.6}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>initial_state</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span><span id=__span-7-35><a id=__codelineno-7-35 name=__codelineno-7-35></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;State after step: {:.6}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>result</span><span class=p>.</span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span><span id=__span-7-36><a id=__codelineno-7-36 name=__codelineno-7-36></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Step used: {:.2}s&quot;</span><span class=p>,</span><span class=w> </span><span class=n>result</span><span class=p>.</span><span class=n>dt_used</span><span class=p>);</span>
</span><span id=__span-7-37><a id=__codelineno-7-37 name=__codelineno-7-37></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Recommended next step: {:.2}s&quot;</span><span class=p>,</span><span class=w> </span><span class=n>result</span><span class=p>.</span><span class=n>dt_next</span><span class=p>);</span>
</span><span id=__span-7-38><a id=__codelineno-7-38 name=__codelineno-7-38></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Error estimate: {:.2e}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>result</span><span class=p>.</span><span class=n>error_estimate</span><span class=p>);</span>
</span><span id=__span-7-39><a id=__codelineno-7-39 name=__codelineno-7-39></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <p>To take multiple steps until a final time, you can use a loop that updates the time and state based on the <code>dt_used</code> and <code>dt_next</code> values from the result.</p> <div class="tabbed-set tabbed-alternate" data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><input id=__tabbed_4_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=__tabbed_4_1>Python</label><label for=__tabbed_4_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-8-1> 1</a></span>
<span class=normal><a href=#__codelineno-8-2> 2</a></span>
<span class=normal><a href=#__codelineno-8-3> 3</a></span>
<span class=normal><a href=#__codelineno-8-4> 4</a></span>
<span class=normal><a href=#__codelineno-8-5> 5</a></span>
<span class=normal><a href=#__codelineno-8-6> 6</a></span>
<span class=normal><a href=#__codelineno-8-7> 7</a></span>
<span class=normal><a href=#__codelineno-8-8> 8</a></span>
<span class=normal><a href=#__codelineno-8-9> 9</a></span>
<span class=normal><a href=#__codelineno-8-10>10</a></span>
<span class=normal><a href=#__codelineno-8-11>11</a></span>
<span class=normal><a href=#__codelineno-8-12>12</a></span>
<span class=normal><a href=#__codelineno-8-13>13</a></span>
<span class=normal><a href=#__codelineno-8-14>14</a></span>
<span class=normal><a href=#__codelineno-8-15>15</a></span>
<span class=normal><a href=#__codelineno-8-16>16</a></span>
<span class=normal><a href=#__codelineno-8-17>17</a></span>
<span class=normal><a href=#__codelineno-8-18>18</a></span>
<span class=normal><a href=#__codelineno-8-19>19</a></span>
<span class=normal><a href=#__codelineno-8-20>20</a></span>
<span class=normal><a href=#__codelineno-8-21>21</a></span>
<span class=normal><a href=#__codelineno-8-22>22</a></span>
<span class=normal><a href=#__codelineno-8-23>23</a></span>
<span class=normal><a href=#__codelineno-8-24>24</a></span>
<span class=normal><a href=#__codelineno-8-25>25</a></span>
<span class=normal><a href=#__codelineno-8-26>26</a></span>
<span class=normal><a href=#__codelineno-8-27>27</a></span>
<span class=normal><a href=#__codelineno-8-28>28</a></span>
<span class=normal><a href=#__codelineno-8-29>29</a></span>
<span class=normal><a href=#__codelineno-8-30>30</a></span>
<span class=normal><a href=#__codelineno-8-31>31</a></span>
<span class=normal><a href=#__codelineno-8-32>32</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4></a>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5></a><span class=k>def</span><span class=w> </span><span class=nf>dynamics</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>state</span><span class=p>):</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Exponential decay dynamics: dx/dt = -k*x&quot;&quot;&quot;</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7></a>    <span class=n>k</span> <span class=o>=</span> <span class=mf>0.1</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=o>-</span><span class=n>k</span> <span class=o>*</span> <span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9></a>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10></a>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11></a><span class=c1># Create adaptive integrator</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12></a><span class=n>config</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>IntegratorConfig</span><span class=o>.</span><span class=n>adaptive</span><span class=p>(</span><span class=n>abs_tol</span><span class=o>=</span><span class=mf>1e-10</span><span class=p>,</span> <span class=n>rel_tol</span><span class=o>=</span><span class=mf>1e-9</span><span class=p>)</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13></a><span class=n>integrator</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>DP54Integrator</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>dynamics</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14></a>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15></a><span class=c1># Propagate from t=0 to t_end</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16></a><span class=n>t</span> <span class=o>=</span> <span class=mf>0.0</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17></a><span class=n>t_end</span> <span class=o>=</span> <span class=mf>86400.0</span>  <span class=c1># One day</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18></a><span class=n>state</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>1.0</span><span class=p>])</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19></a><span class=n>dt</span> <span class=o>=</span> <span class=mf>60.0</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20></a>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21></a><span class=n>step_count</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22></a><span class=k>while</span> <span class=n>t</span> <span class=o>&lt;</span> <span class=n>t_end</span><span class=p>:</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>integrator</span><span class=o>.</span><span class=n>step</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>state</span><span class=p>,</span> <span class=nb>min</span><span class=p>(</span><span class=n>dt</span><span class=p>,</span> <span class=n>t_end</span> <span class=o>-</span> <span class=n>t</span><span class=p>))</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24></a>    <span class=n>t</span> <span class=o>+=</span> <span class=n>result</span><span class=o>.</span><span class=n>dt_used</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25></a>    <span class=n>state</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>state</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26></a>    <span class=n>dt</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>dt_next</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27></a>    <span class=n>step_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28></a>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Propagated from 0 to </span><span class=si>{</span><span class=n>t_end</span><span class=si>}</span><span class=s2>s in </span><span class=si>{</span><span class=n>step_count</span><span class=si>}</span><span class=s2> steps&quot;</span><span class=p>)</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Final state: </span><span class=si>{</span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.6e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Analytical: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>t_end</span><span class=p>)</span><span class=si>:</span><span class=s2>.6e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error: </span><span class=si>{</span><span class=nb>abs</span><span class=p>(</span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>t_end</span><span class=p>))</span><span class=si>:</span><span class=s2>.2e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-9-1> 1</a></span>
<span class=normal><a href=#__codelineno-9-2> 2</a></span>
<span class=normal><a href=#__codelineno-9-3> 3</a></span>
<span class=normal><a href=#__codelineno-9-4> 4</a></span>
<span class=normal><a href=#__codelineno-9-5> 5</a></span>
<span class=normal><a href=#__codelineno-9-6> 6</a></span>
<span class=normal><a href=#__codelineno-9-7> 7</a></span>
<span class=normal><a href=#__codelineno-9-8> 8</a></span>
<span class=normal><a href=#__codelineno-9-9> 9</a></span>
<span class=normal><a href=#__codelineno-9-10>10</a></span>
<span class=normal><a href=#__codelineno-9-11>11</a></span>
<span class=normal><a href=#__codelineno-9-12>12</a></span>
<span class=normal><a href=#__codelineno-9-13>13</a></span>
<span class=normal><a href=#__codelineno-9-14>14</a></span>
<span class=normal><a href=#__codelineno-9-15>15</a></span>
<span class=normal><a href=#__codelineno-9-16>16</a></span>
<span class=normal><a href=#__codelineno-9-17>17</a></span>
<span class=normal><a href=#__codelineno-9-18>18</a></span>
<span class=normal><a href=#__codelineno-9-19>19</a></span>
<span class=normal><a href=#__codelineno-9-20>20</a></span>
<span class=normal><a href=#__codelineno-9-21>21</a></span>
<span class=normal><a href=#__codelineno-9-22>22</a></span>
<span class=normal><a href=#__codelineno-9-23>23</a></span>
<span class=normal><a href=#__codelineno-9-24>24</a></span>
<span class=normal><a href=#__codelineno-9-25>25</a></span>
<span class=normal><a href=#__codelineno-9-26>26</a></span>
<span class=normal><a href=#__codelineno-9-27>27</a></span>
<span class=normal><a href=#__codelineno-9-28>28</a></span>
<span class=normal><a href=#__codelineno-9-29>29</a></span>
<span class=normal><a href=#__codelineno-9-30>30</a></span>
<span class=normal><a href=#__codelineno-9-31>31</a></span>
<span class=normal><a href=#__codelineno-9-32>32</a></span>
<span class=normal><a href=#__codelineno-9-33>33</a></span>
<span class=normal><a href=#__codelineno-9-34>34</a></span>
<span class=normal><a href=#__codelineno-9-35>35</a></span>
<span class=normal><a href=#__codelineno-9-36>36</a></span>
<span class=normal><a href=#__codelineno-9-37>37</a></span>
<span class=normal><a href=#__codelineno-9-38>38</a></span>
<span class=normal><a href=#__codelineno-9-39>39</a></span>
<span class=normal><a href=#__codelineno-9-40>40</a></span>
<span class=normal><a href=#__codelineno-9-41>41</a></span>
<span class=normal><a href=#__codelineno-9-42>42</a></span>
<span class=normal><a href=#__codelineno-9-43>43</a></span>
<span class=normal><a href=#__codelineno-9-44>44</a></span>
<span class=normal><a href=#__codelineno-9-45>45</a></span>
<span class=normal><a href=#__codelineno-9-46>46</a></span>
<span class=normal><a href=#__codelineno-9-47>47</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1></a><span class=sd>//!</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2></a><span class=sd>//! Demonstrates the pattern for propagating over an extended time period</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3></a><span class=sd>//! using an adaptive integrator, using the recommended step size from</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4></a><span class=sd>//! each step for the next step.</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5></a>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6></a><span class=k>use</span><span class=w> </span><span class=n>brahe</span><span class=p>::</span><span class=n>integrators</span><span class=p>::</span><span class=o>*</span><span class=p>;</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7></a><span class=k>use</span><span class=w> </span><span class=n>nalgebra</span><span class=p>::</span><span class=n>DVector</span><span class=p>;</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8></a>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10></a><span class=w>    </span><span class=c1>// Dynamics function: Exponential decay dx/dt = -k*x</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.1</span><span class=p>;</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>dynamics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>move</span><span class=w> </span><span class=o>|</span><span class=n>_t</span><span class=p>:</span><span class=w> </span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>:</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=p>,</span><span class=w> </span><span class=n>_params</span><span class=p>:</span><span class=w> </span><span class=nb>Option</span><span class=o>&lt;&amp;</span><span class=n>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;&gt;|</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13></a><span class=w>        </span><span class=n>DVector</span><span class=p>::</span><span class=n>from_vec</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span><span class=o>-</span><span class=n>k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15></a>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16></a><span class=w>    </span><span class=c1>// Create adaptive integrator</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IntegratorConfig</span><span class=p>::</span><span class=n>adaptive</span><span class=p>(</span><span class=mf>1e-10</span><span class=p>,</span><span class=w> </span><span class=mf>1e-9</span><span class=p>);</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>integrator</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DormandPrince54DIntegrator</span><span class=p>::</span><span class=n>with_config</span><span class=p>(</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19></a><span class=w>        </span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20></a><span class=w>        </span><span class=nb>Box</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>dynamics</span><span class=p>),</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24></a><span class=w>        </span><span class=n>config</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26></a>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27></a><span class=w>    </span><span class=c1>// Propagate from t=0 to t_end</span>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.0</span><span class=p>;</span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>t_end</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>86400.0</span><span class=p>;</span><span class=w> </span><span class=c1>// One day</span>
</span><span id=__span-9-30><a id=__codelineno-9-30 name=__codelineno-9-30></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DVector</span><span class=p>::</span><span class=n>from_vec</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span><span class=mf>1.0</span><span class=p>]);</span>
</span><span id=__span-9-31><a id=__codelineno-9-31 name=__codelineno-9-31></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>dt</span><span class=p>:</span><span class=w> </span><span class=kt>f64</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>60.0</span><span class=p>;</span>
</span><span id=__span-9-32><a id=__codelineno-9-32 name=__codelineno-9-32></a>
</span><span id=__span-9-33><a id=__codelineno-9-33 name=__codelineno-9-33></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>step_count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-9-34><a id=__codelineno-9-34 name=__codelineno-9-34></a><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>t_end</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-9-35><a id=__codelineno-9-35 name=__codelineno-9-35></a><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>integrator</span><span class=p>.</span><span class=n>step</span><span class=p>(</span><span class=n>t</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>,</span><span class=w> </span><span class=n>dt</span><span class=p>.</span><span class=n>min</span><span class=p>(</span><span class=n>t_end</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>t</span><span class=p>));</span>
</span><span id=__span-9-36><a id=__codelineno-9-36 name=__codelineno-9-36></a><span class=w>        </span><span class=n>t</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>result</span><span class=p>.</span><span class=n>dt_used</span><span class=p>;</span>
</span><span id=__span-9-37><a id=__codelineno-9-37 name=__codelineno-9-37></a><span class=w>        </span><span class=n>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>result</span><span class=p>.</span><span class=n>state</span><span class=p>;</span>
</span><span id=__span-9-38><a id=__codelineno-9-38 name=__codelineno-9-38></a><span class=w>        </span><span class=n>dt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>result</span><span class=p>.</span><span class=n>dt_next</span><span class=p>;</span>
</span><span id=__span-9-39><a id=__codelineno-9-39 name=__codelineno-9-39></a><span class=w>        </span><span class=n>step_count</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</span><span id=__span-9-40><a id=__codelineno-9-40 name=__codelineno-9-40></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-9-41><a id=__codelineno-9-41 name=__codelineno-9-41></a>
</span><span id=__span-9-42><a id=__codelineno-9-42 name=__codelineno-9-42></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>analytical</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>t_end</span><span class=p>).</span><span class=n>exp</span><span class=p>();</span>
</span><span id=__span-9-43><a id=__codelineno-9-43 name=__codelineno-9-43></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Propagated from 0 to {}s in {} steps&quot;</span><span class=p>,</span><span class=w> </span><span class=n>t_end</span><span class=p>,</span><span class=w> </span><span class=n>step_count</span><span class=p>);</span>
</span><span id=__span-9-44><a id=__codelineno-9-44 name=__codelineno-9-44></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Final state: {:.6e}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span><span id=__span-9-45><a id=__codelineno-9-45 name=__codelineno-9-45></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Analytical: {:.6e}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>analytical</span><span class=p>);</span>
</span><span id=__span-9-46><a id=__codelineno-9-46 name=__codelineno-9-46></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Error: {:.2e}&quot;</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>analytical</span><span class=p>).</span><span class=n>abs</span><span class=p>());</span>
</span><span id=__span-9-47><a id=__codelineno-9-47 name=__codelineno-9-47></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <h2 id=state-transition-matrix-propagation>State Transition Matrix Propagation<a class=headerlink href=#state-transition-matrix-propagation title="Permanent link">&para;</a></h2> <p>For orbit determination and covariance propagation, you often need to propagate the state transition matrix (STM) alongside the state. The STM <span class=arithmatex>\(\Phi(t, t_0)\)</span> maps perturbations in initial state to perturbations in final state:</p> <div class=arithmatex>\[\delta\mathbf{x}(t) = \Phi(t, t_0) \cdot \delta\mathbf{x}(t_0)\]</div> <p>State transition matrices are needed for a few key aspects of astrodynamics including:</p> <ul> <li><strong>Covariance propagation</strong>: <span class=arithmatex>\(P(t) = \Phi(t, t_0) P(t_0) \Phi(t, t_0)^T\)</span></li> <li><strong>Sensitivity analysis</strong>: How errors in initial conditions affect trajectory</li> <li><strong>Orbit determination</strong>: Computing measurement sensitivities</li> </ul> <p>They can be propagated by integrating the variational equations alongside the state, which requires computing the Jacobian of the dynamics. Brahe's integrators support this via the <code>step_with_varmat</code> method. You can learn more about defining Jacobians in the <a href=../mathematics/jacobian.html>Jacobian Computation</a> guide.</p> <div class="tabbed-set tabbed-alternate" data-tabs=5:2><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><input id=__tabbed_5_2 name=__tabbed_5 type=radio><div class=tabbed-labels><label for=__tabbed_5_1>Python</label><label for=__tabbed_5_2>Rust</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-10-1> 1</a></span>
<span class=normal><a href=#__codelineno-10-2> 2</a></span>
<span class=normal><a href=#__codelineno-10-3> 3</a></span>
<span class=normal><a href=#__codelineno-10-4> 4</a></span>
<span class=normal><a href=#__codelineno-10-5> 5</a></span>
<span class=normal><a href=#__codelineno-10-6> 6</a></span>
<span class=normal><a href=#__codelineno-10-7> 7</a></span>
<span class=normal><a href=#__codelineno-10-8> 8</a></span>
<span class=normal><a href=#__codelineno-10-9> 9</a></span>
<span class=normal><a href=#__codelineno-10-10>10</a></span>
<span class=normal><a href=#__codelineno-10-11>11</a></span>
<span class=normal><a href=#__codelineno-10-12>12</a></span>
<span class=normal><a href=#__codelineno-10-13>13</a></span>
<span class=normal><a href=#__codelineno-10-14>14</a></span>
<span class=normal><a href=#__codelineno-10-15>15</a></span>
<span class=normal><a href=#__codelineno-10-16>16</a></span>
<span class=normal><a href=#__codelineno-10-17>17</a></span>
<span class=normal><a href=#__codelineno-10-18>18</a></span>
<span class=normal><a href=#__codelineno-10-19>19</a></span>
<span class=normal><a href=#__codelineno-10-20>20</a></span>
<span class=normal><a href=#__codelineno-10-21>21</a></span>
<span class=normal><a href=#__codelineno-10-22>22</a></span>
<span class=normal><a href=#__codelineno-10-23>23</a></span>
<span class=normal><a href=#__codelineno-10-24>24</a></span>
<span class=normal><a href=#__codelineno-10-25>25</a></span>
<span class=normal><a href=#__codelineno-10-26>26</a></span>
<span class=normal><a href=#__codelineno-10-27>27</a></span>
<span class=normal><a href=#__codelineno-10-28>28</a></span>
<span class=normal><a href=#__codelineno-10-29>29</a></span>
<span class=normal><a href=#__codelineno-10-30>30</a></span>
<span class=normal><a href=#__codelineno-10-31>31</a></span>
<span class=normal><a href=#__codelineno-10-32>32</a></span>
<span class=normal><a href=#__codelineno-10-33>33</a></span>
<span class=normal><a href=#__codelineno-10-34>34</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1></a><span class=kn>import</span><span class=w> </span><span class=nn>brahe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>bh</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3></a>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4></a>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5></a><span class=k>def</span><span class=w> </span><span class=nf>dynamics</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>state</span><span class=p>):</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Exponential decay dynamics: dx/dt = -k*x&quot;&quot;&quot;</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7></a>    <span class=n>k</span> <span class=o>=</span> <span class=mf>0.1</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=o>-</span><span class=n>k</span> <span class=o>*</span> <span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9></a>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10></a>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11></a><span class=c1># Create Jacobian for variational equations</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12></a><span class=n>jacobian</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>NumericalJacobian</span><span class=o>.</span><span class=n>central</span><span class=p>(</span><span class=n>dynamics</span><span class=p>)</span><span class=o>.</span><span class=n>with_adaptive</span><span class=p>(</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13></a>    <span class=n>scale_factor</span><span class=o>=</span><span class=mf>1e-8</span><span class=p>,</span> <span class=n>min_threshold</span><span class=o>=</span><span class=mf>1e-6</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14></a><span class=p>)</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15></a>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16></a><span class=c1># Create integrator with Jacobian</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17></a><span class=n>config</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>IntegratorConfig</span><span class=o>.</span><span class=n>adaptive</span><span class=p>(</span><span class=n>abs_tol</span><span class=o>=</span><span class=mf>1e-12</span><span class=p>,</span> <span class=n>rel_tol</span><span class=o>=</span><span class=mf>1e-11</span><span class=p>)</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18></a><span class=n>integrator</span> <span class=o>=</span> <span class=n>bh</span><span class=o>.</span><span class=n>DP54Integrator</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>dynamics</span><span class=p>,</span> <span class=n>jacobian</span><span class=o>=</span><span class=n>jacobian</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-10-19><a id=__codelineno-10-19 name=__codelineno-10-19></a>
</span><span id=__span-10-20><a id=__codelineno-10-20 name=__codelineno-10-20></a><span class=c1># Propagate state and STM</span>
</span><span id=__span-10-21><a id=__codelineno-10-21 name=__codelineno-10-21></a><span class=n>t</span> <span class=o>=</span> <span class=mf>0.0</span>
</span><span id=__span-10-22><a id=__codelineno-10-22 name=__codelineno-10-22></a><span class=n>state</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>1.0</span><span class=p>])</span>
</span><span id=__span-10-23><a id=__codelineno-10-23 name=__codelineno-10-23></a><span class=n>phi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># Identity matrix</span>
</span><span id=__span-10-24><a id=__codelineno-10-24 name=__codelineno-10-24></a><span class=n>dt</span> <span class=o>=</span> <span class=mf>60.0</span>
</span><span id=__span-10-25><a id=__codelineno-10-25 name=__codelineno-10-25></a>
</span><span id=__span-10-26><a id=__codelineno-10-26 name=__codelineno-10-26></a><span class=n>new_state</span><span class=p>,</span> <span class=n>new_phi</span><span class=p>,</span> <span class=n>dt_used</span><span class=p>,</span> <span class=n>error_est</span><span class=p>,</span> <span class=n>dt_next</span> <span class=o>=</span> <span class=n>integrator</span><span class=o>.</span><span class=n>step_with_varmat</span><span class=p>(</span>
</span><span id=__span-10-27><a id=__codelineno-10-27 name=__codelineno-10-27></a>    <span class=n>t</span><span class=p>,</span> <span class=n>state</span><span class=p>,</span> <span class=n>phi</span><span class=p>,</span> <span class=n>dt</span>
</span><span id=__span-10-28><a id=__codelineno-10-28 name=__codelineno-10-28></a><span class=p>)</span>
</span><span id=__span-10-29><a id=__codelineno-10-29 name=__codelineno-10-29></a>
</span><span id=__span-10-30><a id=__codelineno-10-30 name=__codelineno-10-30></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Initial state: </span><span class=si>{</span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-10-31><a id=__codelineno-10-31 name=__codelineno-10-31></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;State after </span><span class=si>{</span><span class=n>dt_used</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s: </span><span class=si>{</span><span class=n>new_state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-10-32><a id=__codelineno-10-32 name=__codelineno-10-32></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;State transition matrix:&quot;</span><span class=p>)</span>
</span><span id=__span-10-33><a id=__codelineno-10-33 name=__codelineno-10-33></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Φ = </span><span class=si>{</span><span class=n>new_phi</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-10-34><a id=__codelineno-10-34 name=__codelineno-10-34></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  (Analytical Φ = </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>dt_used</span><span class=p>)</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>)&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-rust highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-11-1> 1</a></span>
<span class=normal><a href=#__codelineno-11-2> 2</a></span>
<span class=normal><a href=#__codelineno-11-3> 3</a></span>
<span class=normal><a href=#__codelineno-11-4> 4</a></span>
<span class=normal><a href=#__codelineno-11-5> 5</a></span>
<span class=normal><a href=#__codelineno-11-6> 6</a></span>
<span class=normal><a href=#__codelineno-11-7> 7</a></span>
<span class=normal><a href=#__codelineno-11-8> 8</a></span>
<span class=normal><a href=#__codelineno-11-9> 9</a></span>
<span class=normal><a href=#__codelineno-11-10>10</a></span>
<span class=normal><a href=#__codelineno-11-11>11</a></span>
<span class=normal><a href=#__codelineno-11-12>12</a></span>
<span class=normal><a href=#__codelineno-11-13>13</a></span>
<span class=normal><a href=#__codelineno-11-14>14</a></span>
<span class=normal><a href=#__codelineno-11-15>15</a></span>
<span class=normal><a href=#__codelineno-11-16>16</a></span>
<span class=normal><a href=#__codelineno-11-17>17</a></span>
<span class=normal><a href=#__codelineno-11-18>18</a></span>
<span class=normal><a href=#__codelineno-11-19>19</a></span>
<span class=normal><a href=#__codelineno-11-20>20</a></span>
<span class=normal><a href=#__codelineno-11-21>21</a></span>
<span class=normal><a href=#__codelineno-11-22>22</a></span>
<span class=normal><a href=#__codelineno-11-23>23</a></span>
<span class=normal><a href=#__codelineno-11-24>24</a></span>
<span class=normal><a href=#__codelineno-11-25>25</a></span>
<span class=normal><a href=#__codelineno-11-26>26</a></span>
<span class=normal><a href=#__codelineno-11-27>27</a></span>
<span class=normal><a href=#__codelineno-11-28>28</a></span>
<span class=normal><a href=#__codelineno-11-29>29</a></span>
<span class=normal><a href=#__codelineno-11-30>30</a></span>
<span class=normal><a href=#__codelineno-11-31>31</a></span>
<span class=normal><a href=#__codelineno-11-32>32</a></span>
<span class=normal><a href=#__codelineno-11-33>33</a></span>
<span class=normal><a href=#__codelineno-11-34>34</a></span>
<span class=normal><a href=#__codelineno-11-35>35</a></span>
<span class=normal><a href=#__codelineno-11-36>36</a></span>
<span class=normal><a href=#__codelineno-11-37>37</a></span>
<span class=normal><a href=#__codelineno-11-38>38</a></span>
<span class=normal><a href=#__codelineno-11-39>39</a></span>
<span class=normal><a href=#__codelineno-11-40>40</a></span>
<span class=normal><a href=#__codelineno-11-41>41</a></span>
<span class=normal><a href=#__codelineno-11-42>42</a></span>
<span class=normal><a href=#__codelineno-11-43>43</a></span>
<span class=normal><a href=#__codelineno-11-44>44</a></span>
<span class=normal><a href=#__codelineno-11-45>45</a></span>
<span class=normal><a href=#__codelineno-11-46>46</a></span>
<span class=normal><a href=#__codelineno-11-47>47</a></span>
<span class=normal><a href=#__codelineno-11-48>48</a></span>
<span class=normal><a href=#__codelineno-11-49>49</a></span>
<span class=normal><a href=#__codelineno-11-50>50</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1></a><span class=sd>//! State Transition Matrix propagation pattern example.</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2></a><span class=sd>//!</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3></a><span class=sd>//! Demonstrates the basic pattern for propagating a state transition matrix</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4></a><span class=sd>//! alongside the state using variational equations.</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5></a>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6></a><span class=k>use</span><span class=w> </span><span class=n>brahe</span><span class=p>::</span><span class=n>integrators</span><span class=p>::</span><span class=o>*</span><span class=p>;</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7></a><span class=k>use</span><span class=w> </span><span class=n>brahe</span><span class=p>::</span><span class=n>math</span><span class=p>::</span><span class=n>jacobian</span><span class=p>::</span><span class=o>*</span><span class=p>;</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8></a><span class=k>use</span><span class=w> </span><span class=n>nalgebra</span><span class=p>::{</span><span class=n>DMatrix</span><span class=p>,</span><span class=w> </span><span class=n>DVector</span><span class=p>};</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9></a>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10></a><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11></a><span class=w>    </span><span class=c1>// Dynamics function: Exponential decay dx/dt = -k*x</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.1</span><span class=p>;</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>dynamics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>move</span><span class=w> </span><span class=o>|</span><span class=n>_t</span><span class=p>:</span><span class=w> </span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>:</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=p>,</span><span class=w> </span><span class=n>_params</span><span class=p>:</span><span class=w> </span><span class=nb>Option</span><span class=o>&lt;&amp;</span><span class=n>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;&gt;|</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14></a><span class=w>        </span><span class=n>DVector</span><span class=p>::</span><span class=n>from_vec</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span><span class=o>-</span><span class=n>k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16></a><span class=w>    </span><span class=c1>// Clone for Jacobian computation</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>dynamics_for_jac</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>move</span><span class=w> </span><span class=o>|</span><span class=n>_t</span><span class=p>:</span><span class=w> </span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>:</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;|</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>DVector</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18></a><span class=w>        </span><span class=n>DVector</span><span class=p>::</span><span class=n>from_vec</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span><span class=o>-</span><span class=n>k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20></a>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21></a><span class=w>    </span><span class=c1>// Create Jacobian for variational equations</span>
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>jacobian</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DNumericalJacobian</span><span class=p>::</span><span class=n>central</span><span class=p>(</span><span class=nb>Box</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>dynamics_for_jac</span><span class=p>))</span>
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23></a><span class=w>        </span><span class=p>.</span><span class=n>with_adaptive</span><span class=p>(</span><span class=mf>1e-8</span><span class=p>,</span><span class=w> </span><span class=mf>1e-6</span><span class=p>);</span>
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24></a>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25></a><span class=w>    </span><span class=c1>// Create integrator with Jacobian</span>
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IntegratorConfig</span><span class=p>::</span><span class=n>adaptive</span><span class=p>(</span><span class=mf>1e-12</span><span class=p>,</span><span class=w> </span><span class=mf>1e-11</span><span class=p>);</span>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>integrator</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DormandPrince54DIntegrator</span><span class=p>::</span><span class=n>with_config</span><span class=p>(</span>
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28></a><span class=w>        </span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-11-29><a id=__codelineno-11-29 name=__codelineno-11-29></a><span class=w>        </span><span class=nb>Box</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>dynamics</span><span class=p>),</span>
</span><span id=__span-11-30><a id=__codelineno-11-30 name=__codelineno-11-30></a><span class=w>        </span><span class=nb>Some</span><span class=p>(</span><span class=nb>Box</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=n>jacobian</span><span class=p>)),</span>
</span><span id=__span-11-31><a id=__codelineno-11-31 name=__codelineno-11-31></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-11-32><a id=__codelineno-11-32 name=__codelineno-11-32></a><span class=w>        </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-11-33><a id=__codelineno-11-33 name=__codelineno-11-33></a><span class=w>        </span><span class=n>config</span>
</span><span id=__span-11-34><a id=__codelineno-11-34 name=__codelineno-11-34></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-11-35><a id=__codelineno-11-35 name=__codelineno-11-35></a>
</span><span id=__span-11-36><a id=__codelineno-11-36 name=__codelineno-11-36></a><span class=w>    </span><span class=c1>// Propagate state and STM</span>
</span><span id=__span-11-37><a id=__codelineno-11-37 name=__codelineno-11-37></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.0</span><span class=p>;</span>
</span><span id=__span-11-38><a id=__codelineno-11-38 name=__codelineno-11-38></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DVector</span><span class=p>::</span><span class=n>from_vec</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span><span class=mf>1.0</span><span class=p>]);</span>
</span><span id=__span-11-39><a id=__codelineno-11-39 name=__codelineno-11-39></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>phi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DMatrix</span><span class=p>::</span><span class=n>identity</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w> </span><span class=c1>// 1x1 identity matrix</span>
</span><span id=__span-11-40><a id=__codelineno-11-40 name=__codelineno-11-40></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>dt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>60.0</span><span class=p>;</span>
</span><span id=__span-11-41><a id=__codelineno-11-41 name=__codelineno-11-41></a>
</span><span id=__span-11-42><a id=__codelineno-11-42 name=__codelineno-11-42></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>new_state</span><span class=p>,</span><span class=w> </span><span class=n>new_phi</span><span class=p>,</span><span class=w> </span><span class=n>dt_used</span><span class=p>,</span><span class=w> </span><span class=n>_error_est</span><span class=p>,</span><span class=w> </span><span class=n>_dt_next</span><span class=p>)</span><span class=w> </span><span class=o>=</span>
</span><span id=__span-11-43><a id=__codelineno-11-43 name=__codelineno-11-43></a><span class=w>        </span><span class=n>integrator</span><span class=p>.</span><span class=n>step_with_varmat</span><span class=p>(</span><span class=n>t</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>,</span><span class=w> </span><span class=n>phi</span><span class=p>,</span><span class=w> </span><span class=n>dt</span><span class=p>);</span>
</span><span id=__span-11-44><a id=__codelineno-11-44 name=__codelineno-11-44></a>
</span><span id=__span-11-45><a id=__codelineno-11-45 name=__codelineno-11-45></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Initial state: {:.6}&quot;</span><span class=p>,</span><span class=w> </span><span class=mf>1.0</span><span class=p>);</span>
</span><span id=__span-11-46><a id=__codelineno-11-46 name=__codelineno-11-46></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;State after {:.2}s: {:.6}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>dt_used</span><span class=p>,</span><span class=w> </span><span class=n>new_state</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span><span id=__span-11-47><a id=__codelineno-11-47 name=__codelineno-11-47></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;State transition matrix:&quot;</span><span class=p>);</span>
</span><span id=__span-11-48><a id=__codelineno-11-48 name=__codelineno-11-48></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  Φ = {:.6}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>new_phi</span><span class=p>[(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)]);</span>
</span><span id=__span-11-49><a id=__codelineno-11-49 name=__codelineno-11-49></a><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;  (Analytical Φ = {:.6})&quot;</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>dt_used</span><span class=p>).</span><span class=n>exp</span><span class=p>());</span>
</span><span id=__span-11-50><a id=__codelineno-11-50 name=__codelineno-11-50></a><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <h2 id=module-contents>Module Contents<a class=headerlink href=#module-contents title="Permanent link">&para;</a></h2> <ul> <li><strong><a href=fixed_step.html>Fixed-Step Integrators</a></strong> - RK4 and fixed-step integration</li> <li><strong><a href=adaptive_step.html>Adaptive-Step Integrators</a></strong> - RKF45, DP54, and RKN1210</li> <li><strong><a href=variational_equations.html>Variational Equations</a></strong> - State Transition Matrix propagation and theory</li> <li><strong><a href=configuration.html>Configuration Guide</a></strong> - Choosing tolerances and tuning parameters</li> </ul> <h2 id=see-also>See Also<a class=headerlink href=#see-also title="Permanent link">&para;</a></h2> <ul> <li><strong><a href=../../examples/using_different_integrators.html>Comparing Integrator Performance</a></strong> - Complete example comparing all integrators on a 7-day orbit propagation</li> <li><strong><a href=../../library_api/integrators/index.html>Integrators API Reference</a></strong> - Complete API documentation</li> <li><strong><a href=../mathematics/jacobian.html>Jacobian Computation</a></strong> - Required for variational equations</li> <li><strong><a href=../orbit_propagation/keplerian_propagation.html>Keplerian Propagation</a></strong> - Analytical propagation alternative</li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="November 19, 2025 06:16:06 UTC">2025-11-19</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="November 17, 2025 10:26:57 UTC">2025-11-17</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "navigation.indexes", "navigation.tracking", "navigation.top3", "toc.follow", "content.tabs.link", "content.code.copy", "search.highlight", "search.suggest"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../javascripts/katex.d81d3f.min.js></script> <script src=https://unpkg.com/katex@0/dist/katex.min.js></script> <script src=https://unpkg.com/katex@0/dist/contrib/auto-render.min.js></script> <script src=https://cdn.plot.ly/plotly-latest.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../javascripts/tablesort.ae6fa2.min.js></script> </body> </html>